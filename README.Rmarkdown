---
output: github_document
---

# Bayesian spatio-temporal methods for small-area estimation of HIV indicators

```{r echo=FALSE}
page_count <- pdftools::pdf_info("docs/main.pdf")$pages
knitr::include_graphics(paste0("https://geps.dev/progress/", round(100 * page_count / page_count)))
```

> [!WARNING]  
> Thesis under construction! Currently `r page_count` pages. There are various [enhancements](#enhancements) I would ideally like to make, but as they say "a good thesis is a done thesis".

PhD in [Modern Statistics and Statistical Machine Learning](https://statml.io/) at [Imperial College London](https://www.imperial.ac.uk/).

Supervised by: [Seth Flaxman](https://sethrf.com/) and [Jeff Eaton](https://www.imperial.ac.uk/people/jeffrey.eaton).

```{r echo=FALSE}
abstract <- paste(readLines("front-and-back-matter/_abstract.Rmd"), collapse = '\n  ')

words <- function(text){
  words <- strsplit(text, " ")[[1]]
  length(words)
}

stopifnot(words(abstract) < 300)

knitr::asis_output(abstract)
```

![](figures/hiv-aids/naomi-continent.png)

## Chapters

|            | Title      | GitHub repository | Journal |
| ---------- | ---------- | -------------------- | --- |
| 1 | [Introduction](https://athowes.github.io/thesis/introduction.html) | | |
| 2 | [The HIV/AIDS epidemic](https://athowes.github.io/thesis/hiv-aids.html) | | |
| 3 | [Bayesian spatio-temporal statistics](https://athowes.github.io/thesis/bayes-st.html) | | |
| 4 | [Models for areal spatial structure](https://athowes.github.io/thesis/beyond-borders.html)  | [`beyond-borders`](https://github.com/athowes/beyond-borders) | In preparation! | 
| 5 | [A model for risk group proportions](https://athowes.github.io/thesis/multi-agyw.html)  | [`multi-agyw`](https://github.com/athowes/multi-agyw) | [PLOS Global Public Health](https://journals.plos.org/globalpublichealth/article?id=10.1371/journal.pgph.0001731) |
| 6 | [Fast approximate Bayesian inference](https://athowes.github.io/thesis/naomi-aghq.html) | [`naomi-aghq`](https://github.com/athowes/naomi-aghq) | In preparation! |
| 7 | [Conclusions](https://athowes.github.io/thesis/conclusions.html) | |
| A | [Appendix to models for areal spatial structure](https://athowes.github.io/thesis/models-for-areal-spatial-structure.html) | |
| B | [Appendix to a model for risk group proportions](https://athowes.github.io/thesis/a-model-for-risk-group-proportions.html) | |
| C | [Appendix to fast approximate Bayesian inference](https://athowes.github.io/thesis/fast-approximate-bayesian-inference.html) | |

## Slides

Slides for my thesis defense are available [here](https://athowes.github.io/thesis/slides.pdf).
They may be useful to provide a brief overview of the research.

<p align="center">
  <a href="https://athowes.github.io/thesis/slides.pdf">
    <img src="slide-1.png" alt="The title slide!" height="300"/>
  </a>
</p>

## Citation

If you would like to cite this work, please use:

```
@phdthesis{howes23,
  author = {Howes, Adam},
  school = {Imperial College London},
  title = {Bayesian spatio-temporal methods for small-area estimation of HIV indicators},
  year = {2023}
}
```

## Frequently asked questions

> How can I read the thesis?

Thanks for being interested!
You can read either the [HTML](https://athowes.github.io/thesis/) or [PDF](https://athowes.github.io/thesis/main.pdf) version.
I know, an overwhelming choice.
It's still a work in progress at the moment though, so I'd recommend checking back in January 2024 (post-submission) or March 2024 (post-defense) unless you love non-sequiturs.

> How did you format this thesis?

I used the R package [`thesisdown`](https://github.com/ismayc/thesisdown), inspired by [`bookdown`](https://github.com/rstudio/bookdown).
So far it has been working relatively seamlessly, so I'd recommend it!
I've found `gt` together with `knitr::is_html_output` and `knitr::is_latex_output` works well to present tables nicely in multiple formats.

> Are there any resources you'd recommend for an introduction to this area of research?

I'd recommend something like [Spatial and Spatio-temporal Bayesian models with `R-INLA`](https://sites.google.com/a/r-inla.org/stbook/) by Marta Blangiardo and Michela Cameletti.
I have a repository with further miscellaneous recommended [resources](https://github.com/athowes/resources), if you are interested.

> I'm a statistician: which parts of the thesis might interest me?

If you use spatial random effects to model areal spatial structure, [Chapter 4](https://athowes.github.io/thesis/beyond-borders.html).
This chapter uses a variety of model comparison techniques (scoring rules, coverage assessments, information criteria) that may also be of interest.
If you're interested in modelling multinomial data using the multinomial-Poisson transformation and structured random effects, [Chapter 5](https://athowes.github.io/thesis/multi-agyw.html).
If you have a complicated model which is not compatible with `R-INLA`, but would still like to use INLA-like methods, [Chapter 6](https://athowes.github.io/thesis/naomi-aghq.html).
If you have such a model, get in touch!
All of the methods are compatible with any model written in the (very general) [Template Model Builder](https://kaskr.github.io/adcomp/Introduction.html) R package (`TMB`).

> I'm a HIV epidemiologist: which parts of the thesis might interest me?

Primarily [Chapter 5](https://athowes.github.io/thesis/multi-agyw.html) will be of interest to you.
The [Global AIDS Strategy](https://www.unaids.org/en/Global-AIDS-Strategy-2021-2026) sets out goals for prioritisation of prevention programming for adolescent girls and young women according to risk behaviour and epidemic setting.
To enable implementation of the strategy, I estimated risk group specific population sizes, prevalence and incidences at a district-level.
I also used these estimates to evaluate the extent to which risk varies by age, behaviour, and geographic area.
You might also be interested in the analysis in [Chapter 6](https://athowes.github.io/thesis/naomi-aghq.html) applying the Naomi small-area estimation model to data from Malawi.

## Enhancements

* In Chapter 2, the sections about challenges and statistical approaches used to overcome those challenges could be 1) better connected to the work done in the thesis, and 2) better integrated with existing literature. Doing so is relatively challenging 1) because this chapter precedes proper introduction of the methods used in this thesis, and is instead meant to provide a high-level overview, and 2) because the statistical approaches described e.g. "borrowing information" are relatively general and would be difficult, though not impossible, to credit to any particular works.
* A more thorough description of the approximations to the Laplace approximation used by [Rue, Martino, and Chopin (2009)](https://rss.onlinelibrary.wiley.com/doi/10.1111/j.1467-9868.2008.00700.x) and [Wood (2020)](https://academic.oup.com/biomet/article-abstract/107/1/223/5572662). It would be instructive to implement these approximations for a simple example.
* For all figures showing the use of a quadrature rule, it could be informative to compute and display the resulting integral estimate. When compared to a known truth, this would make demonstrate the value of e.g. adaption.
* Inclusion of some broader discussion of the value of automatic differentiation for INLA-like inference strategies. See the conversation I began [here](https://groups.google.com/g/r-inla-discussion-group/c/avPWD5ED0NM/m/b94kaaUVAgAJ) on the `R-INLA` Google group.
