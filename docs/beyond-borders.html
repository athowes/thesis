<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Models for spatial structure | Bayesian spatio-temporal methods for small-area estimation of HIV indicators</title>
  <meta name="description" content="4 Models for spatial structure | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Models for spatial structure | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Models for spatial structure | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  
  
  

<meta name="author" content="Adam Howes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayes-st.html"/>
<link rel="next" href="multi-agyw.html"/>
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="templates/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#chapter-overview"><i class="fa fa-check"></i><b>1.1</b> Chapter overview</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hiv-aids.html"><a href="hiv-aids.html"><i class="fa fa-check"></i><b>2</b> The HIV/AIDS epidemic</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hiv-aids.html"><a href="hiv-aids.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="hiv-aids.html"><a href="hiv-aids.html#surveillance"><i class="fa fa-check"></i><b>2.2</b> HIV surveillance</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="hiv-aids.html"><a href="hiv-aids.html#data"><i class="fa fa-check"></i><b>2.2.1</b> Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="hiv-aids.html"><a href="hiv-aids.html#challenges"><i class="fa fa-check"></i><b>2.2.2</b> Challenges</a></li>
<li class="chapter" data-level="2.2.3" data-path="hiv-aids.html"><a href="hiv-aids.html#statistical-approaches"><i class="fa fa-check"></i><b>2.2.3</b> Statistical approaches</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayes-st.html"><a href="bayes-st.html"><i class="fa fa-check"></i><b>3</b> Bayesian spatio-temporal statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-statistics"><i class="fa fa-check"></i><b>3.1</b> Bayesian statistics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-modelling"><i class="fa fa-check"></i><b>3.1.1</b> Bayesian modelling</a></li>
<li class="chapter" data-level="3.1.2" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-computation"><i class="fa fa-check"></i><b>3.1.2</b> Bayesian computation</a></li>
<li class="chapter" data-level="3.1.3" data-path="bayes-st.html"><a href="bayes-st.html#interplay-between-modelling-and-computation"><i class="fa fa-check"></i><b>3.1.3</b> Interplay between modelling and computation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bayes-st.html"><a href="bayes-st.html#spatio-temporal-statistics"><i class="fa fa-check"></i><b>3.2</b> Spatio-temporal statistics</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="bayes-st.html"><a href="bayes-st.html#properties-of-spatio-temporal-data"><i class="fa fa-check"></i><b>3.2.1</b> Properties of spatio-temporal data</a></li>
<li class="chapter" data-level="3.2.2" data-path="bayes-st.html"><a href="bayes-st.html#small-area-estimation"><i class="fa fa-check"></i><b>3.2.2</b> Small-area estimation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="bayes-st.html"><a href="bayes-st.html#hierarchical-lgm-elgm"><i class="fa fa-check"></i><b>3.3</b> Model structure</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="bayes-st.html"><a href="bayes-st.html#linear-model"><i class="fa fa-check"></i><b>3.3.1</b> Linear model</a></li>
<li class="chapter" data-level="3.3.2" data-path="bayes-st.html"><a href="bayes-st.html#generalised-linear-model"><i class="fa fa-check"></i><b>3.3.2</b> Generalised linear model</a></li>
<li class="chapter" data-level="3.3.3" data-path="bayes-st.html"><a href="bayes-st.html#hierarchical"><i class="fa fa-check"></i><b>3.3.3</b> Hierarchical models</a></li>
<li class="chapter" data-level="3.3.4" data-path="bayes-st.html"><a href="bayes-st.html#generalised-linear-mixed-effects-model"><i class="fa fa-check"></i><b>3.3.4</b> Generalised linear mixed effects model</a></li>
<li class="chapter" data-level="3.3.5" data-path="bayes-st.html"><a href="bayes-st.html#lgm"><i class="fa fa-check"></i><b>3.3.5</b> Latent Gaussian model</a></li>
<li class="chapter" data-level="3.3.6" data-path="bayes-st.html"><a href="bayes-st.html#elgm"><i class="fa fa-check"></i><b>3.3.6</b> Extended latent Gaussian model</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bayes-st.html"><a href="bayes-st.html#model-comparison"><i class="fa fa-check"></i><b>3.4</b> Model comparison</a></li>
<li class="chapter" data-level="3.5" data-path="bayes-st.html"><a href="bayes-st.html#survey"><i class="fa fa-check"></i><b>3.5</b> Survey methods</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="bayes-st.html"><a href="bayes-st.html#survey-notation-and-key-terms"><i class="fa fa-check"></i><b>3.5.1</b> Survey notation and key terms</a></li>
<li class="chapter" data-level="3.5.2" data-path="bayes-st.html"><a href="bayes-st.html#survey-design"><i class="fa fa-check"></i><b>3.5.2</b> Survey design</a></li>
<li class="chapter" data-level="3.5.3" data-path="bayes-st.html"><a href="bayes-st.html#survey-analysis"><i class="fa fa-check"></i><b>3.5.3</b> Survey analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="beyond-borders.html"><a href="beyond-borders.html"><i class="fa fa-check"></i><b>4</b> Models for spatial structure</a>
<ul>
<li class="chapter" data-level="4.1" data-path="beyond-borders.html"><a href="beyond-borders.html#background-1"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="beyond-borders.html"><a href="beyond-borders.html#adjacency"><i class="fa fa-check"></i><b>4.2</b> Models based on adjacency</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="beyond-borders.html"><a href="beyond-borders.html#the-besag-model"><i class="fa fa-check"></i><b>4.2.1</b> The Besag model</a></li>
<li class="chapter" data-level="4.2.2" data-path="beyond-borders.html"><a href="beyond-borders.html#best-practises-for-the-besag-model"><i class="fa fa-check"></i><b>4.2.2</b> Best practises for the Besag model</a></li>
<li class="chapter" data-level="4.2.3" data-path="beyond-borders.html"><a href="beyond-borders.html#the-reparameterised-besag-york-mollié-model"><i class="fa fa-check"></i><b>4.2.3</b> The reparameterised Besag-York-Mollié model</a></li>
<li class="chapter" data-level="4.2.4" data-path="beyond-borders.html"><a href="beyond-borders.html#concerns-about-the-besag-models-spatial-representation"><i class="fa fa-check"></i><b>4.2.4</b> Concerns about the Besag model’s spatial representation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="beyond-borders.html"><a href="beyond-borders.html#models-using-kernels"><i class="fa fa-check"></i><b>4.3</b> Models using kernels</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="beyond-borders.html"><a href="beyond-borders.html#centroid-kernel"><i class="fa fa-check"></i><b>4.3.1</b> Centroid kernel</a></li>
<li class="chapter" data-level="4.3.2" data-path="beyond-borders.html"><a href="beyond-borders.html#integrated-kernel"><i class="fa fa-check"></i><b>4.3.2</b> Integrated kernel</a></li>
<li class="chapter" data-level="4.3.3" data-path="beyond-borders.html"><a href="beyond-borders.html#the-stochastic-partial-differential-equation-approximation"><i class="fa fa-check"></i><b>4.3.3</b> The stochastic partial differential equation approximation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="beyond-borders.html"><a href="beyond-borders.html#simulation-study"><i class="fa fa-check"></i><b>4.4</b> Simulation study</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="beyond-borders.html"><a href="beyond-borders.html#synthetic-data-sets"><i class="fa fa-check"></i><b>4.4.1</b> Synthetic data-sets</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="beyond-borders.html"><a href="beyond-borders.html#hiv-prevalence-study"><i class="fa fa-check"></i><b>4.5</b> HIV prevalence study</a></li>
<li class="chapter" data-level="4.6" data-path="beyond-borders.html"><a href="beyond-borders.html#discussion"><i class="fa fa-check"></i><b>4.6</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multi-agyw.html"><a href="multi-agyw.html"><i class="fa fa-check"></i><b>5</b> A model for risk group proportions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multi-agyw.html"><a href="multi-agyw.html#background-2"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="multi-agyw.html"><a href="multi-agyw.html#data-1"><i class="fa fa-check"></i><b>5.2</b> Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multi-agyw.html"><a href="multi-agyw.html#behavioural-data-from-household-surveys"><i class="fa fa-check"></i><b>5.2.1</b> Behavioural data from household surveys</a></li>
<li class="chapter" data-level="5.2.2" data-path="multi-agyw.html"><a href="multi-agyw.html#other-data"><i class="fa fa-check"></i><b>5.2.2</b> Other data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multi-agyw.html"><a href="multi-agyw.html#model-for-risk-group-proportions"><i class="fa fa-check"></i><b>5.3</b> Model for risk group proportions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="multi-agyw.html"><a href="multi-agyw.html#st-multinomial"><i class="fa fa-check"></i><b>5.3.1</b> Spatio-temporal multinomial logistic regression</a></li>
<li class="chapter" data-level="5.3.2" data-path="multi-agyw.html"><a href="multi-agyw.html#s-logistic"><i class="fa fa-check"></i><b>5.3.2</b> Spatial logistic regression</a></li>
<li class="chapter" data-level="5.3.3" data-path="multi-agyw.html"><a href="multi-agyw.html#model-combination"><i class="fa fa-check"></i><b>5.3.3</b> Model combination</a></li>
<li class="chapter" data-level="5.3.4" data-path="multi-agyw.html"><a href="multi-agyw.html#female-sex-worker-population-size-adjustment"><i class="fa fa-check"></i><b>5.3.4</b> Female sex worker population size adjustment</a></li>
<li class="chapter" data-level="5.3.5" data-path="multi-agyw.html"><a href="multi-agyw.html#results"><i class="fa fa-check"></i><b>5.3.5</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multi-agyw.html"><a href="multi-agyw.html#prevalence-and-incidence-by-risk-group"><i class="fa fa-check"></i><b>5.4</b> Prevalence and incidence by risk group</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multi-agyw.html"><a href="multi-agyw.html#disaggregation-of-naomi-prevalence-estimates"><i class="fa fa-check"></i><b>5.4.1</b> Disaggregation of Naomi prevalence estimates</a></li>
<li class="chapter" data-level="5.4.2" data-path="multi-agyw.html"><a href="multi-agyw.html#disaggregation-of-naomi-incidence-estimates"><i class="fa fa-check"></i><b>5.4.2</b> Disaggregation of Naomi incidence estimates</a></li>
<li class="chapter" data-level="5.4.3" data-path="multi-agyw.html"><a href="multi-agyw.html#expected-new-infections-reached"><i class="fa fa-check"></i><b>5.4.3</b> Expected new infections reached</a></li>
<li class="chapter" data-level="5.4.4" data-path="multi-agyw.html"><a href="multi-agyw.html#results-1"><i class="fa fa-check"></i><b>5.4.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multi-agyw.html"><a href="multi-agyw.html#discussion-1"><i class="fa fa-check"></i><b>5.5</b> Discussion</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="multi-agyw.html"><a href="multi-agyw.html#limitations"><i class="fa fa-check"></i><b>5.5.1</b> Limitations</a></li>
<li class="chapter" data-level="5.5.2" data-path="multi-agyw.html"><a href="multi-agyw.html#conclusion"><i class="fa fa-check"></i><b>5.5.2</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="naomi-aghq.html"><a href="naomi-aghq.html"><i class="fa fa-check"></i><b>6</b> Fast approximate Bayesian inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi-inference"><i class="fa fa-check"></i><b>6.1</b> Inference methods and software</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#la"><i class="fa fa-check"></i><b>6.1.1</b> The Laplace approximation</a></li>
<li class="chapter" data-level="6.1.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#quadrature"><i class="fa fa-check"></i><b>6.1.2</b> Quadrature</a></li>
<li class="chapter" data-level="6.1.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#inla"><i class="fa fa-check"></i><b>6.1.3</b> Integrated nested Laplace approximation</a></li>
<li class="chapter" data-level="6.1.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#software"><i class="fa fa-check"></i><b>6.1.4</b> Software</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#universal"><i class="fa fa-check"></i><b>6.2</b> A universal INLA implementation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#epil"><i class="fa fa-check"></i><b>6.2.1</b> Epilepsy GLMM</a></li>
<li class="chapter" data-level="6.2.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#unknown"><i class="fa fa-check"></i><b>6.2.2</b> An example that <code>R-INLA</code> doesn’t work for</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi"><i class="fa fa-check"></i><b>6.3</b> The Naomi model</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi-model"><i class="fa fa-check"></i><b>6.3.1</b> Model structure</a></li>
<li class="chapter" data-level="6.3.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi-elgm"><i class="fa fa-check"></i><b>6.3.2</b> Naomi as an ELGM</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#pca-aghq"><i class="fa fa-check"></i><b>6.4</b> AGHQ in moderate dimensions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#aghq-with-variable-levels"><i class="fa fa-check"></i><b>6.4.1</b> AGHQ with variable levels</a></li>
<li class="chapter" data-level="6.4.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#principal-components-analysis"><i class="fa fa-check"></i><b>6.4.2</b> Principal components analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="naomi-aghq.html"><a href="naomi-aghq.html#malawi"><i class="fa fa-check"></i><b>6.5</b> Malawi case-study</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#nuts-convergence"><i class="fa fa-check"></i><b>6.5.1</b> NUTS convergence</a></li>
<li class="chapter" data-level="6.5.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#use-of-pca-aghq"><i class="fa fa-check"></i><b>6.5.2</b> Use of PCA-AGHQ</a></li>
<li class="chapter" data-level="6.5.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#model-assessment"><i class="fa fa-check"></i><b>6.5.3</b> Model assessment</a></li>
<li class="chapter" data-level="6.5.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#inference-comparison"><i class="fa fa-check"></i><b>6.5.4</b> Inference comparison</a></li>
<li class="chapter" data-level="6.5.5" data-path="naomi-aghq.html"><a href="naomi-aghq.html#exceedance-probabilities"><i class="fa fa-check"></i><b>6.5.5</b> Exceedance probabilities</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="naomi-aghq.html"><a href="naomi-aghq.html#discussion-2"><i class="fa fa-check"></i><b>6.6</b> Discussion</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#a-universal-inla-implementation"><i class="fa fa-check"></i><b>6.6.1</b> A universal INLA implementation</a></li>
<li class="chapter" data-level="6.6.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#pca-aghq-with-application-to-inla-for-naomi"><i class="fa fa-check"></i><b>6.6.2</b> PCA-AGHQ with application to INLA for Naomi</a></li>
<li class="chapter" data-level="6.6.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#suggestions-for-future-work"><i class="fa fa-check"></i><b>6.6.3</b> Suggestions for future work</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>7</b> Conclusions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="conclusions.html"><a href="conclusions.html#strengths"><i class="fa fa-check"></i><b>7.1</b> Strengths</a></li>
<li class="chapter" data-level="7.2" data-path="conclusions.html"><a href="conclusions.html#weaknesses"><i class="fa fa-check"></i><b>7.2</b> Weaknesses</a></li>
<li class="chapter" data-level="7.3" data-path="conclusions.html"><a href="conclusions.html#future-work"><i class="fa fa-check"></i><b>7.3</b> Future work</a></li>
<li class="chapter" data-level="7.4" data-path="conclusions.html"><a href="conclusions.html#conclusions-1"><i class="fa fa-check"></i><b>7.4</b> Conclusions</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="models-for-spatial-structure.html"><a href="models-for-spatial-structure.html"><i class="fa fa-check"></i><b>A</b> Models for spatial structure</a>
<ul>
<li class="chapter" data-level="A.1" data-path="models-for-spatial-structure.html"><a href="models-for-spatial-structure.html#comparison-of-aghq-to-nuts"><i class="fa fa-check"></i><b>A.1</b> Comparison of AGHQ to NUTS</a></li>
<li class="chapter" data-level="A.2" data-path="models-for-spatial-structure.html"><a href="models-for-spatial-structure.html#simulation-study-1"><i class="fa fa-check"></i><b>A.2</b> Simulation study</a></li>
<li class="chapter" data-level="A.3" data-path="models-for-spatial-structure.html"><a href="models-for-spatial-structure.html#hiv-study"><i class="fa fa-check"></i><b>A.3</b> HIV study</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html"><i class="fa fa-check"></i><b>B</b> A model for risk group proportions</a>
<ul>
<li class="chapter" data-level="B.1" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#the-global-aids-strategy"><i class="fa fa-check"></i><b>B.1</b> The Global AIDS Strategy</a></li>
<li class="chapter" data-level="B.2" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#household-survey-data"><i class="fa fa-check"></i><b>B.2</b> Household survey data</a></li>
<li class="chapter" data-level="B.3" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#spatial-analysis-levels"><i class="fa fa-check"></i><b>B.3</b> Spatial analysis levels</a></li>
<li class="chapter" data-level="B.4" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#survey-questions"><i class="fa fa-check"></i><b>B.4</b> Survey questions and risk group allocation</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html"><i class="fa fa-check"></i><b>C</b> Fast approximate Bayesian inference</a>
<ul>
<li class="chapter" data-level="C.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#epilepsy-example"><i class="fa fa-check"></i><b>C.1</b> Epilepsy example</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#tmb-epil"><i class="fa fa-check"></i><b>C.1.1</b> <code>TMB</code> C++ template</a></li>
<li class="chapter" data-level="C.1.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#tmb-modified-epil"><i class="fa fa-check"></i><b>C.1.2</b> Modified <code>TMB</code> C++ template</a></li>
<li class="chapter" data-level="C.1.3" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#stan-epil"><i class="fa fa-check"></i><b>C.1.3</b> <code>Stan</code> C++ template</a></li>
<li class="chapter" data-level="C.1.4" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#nuts-convergence-diagnostics"><i class="fa fa-check"></i><b>C.1.4</b> NUTS convergence diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-math"><i class="fa fa-check"></i><b>C.2</b> Simplified Naomi model description</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-process"><i class="fa fa-check"></i><b>C.2.1</b> Process specification</a></li>
<li class="chapter" data-level="C.2.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-likelihood"><i class="fa fa-check"></i><b>C.2.2</b> Additional likelihood specification</a></li>
<li class="chapter" data-level="C.2.3" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-identifiability"><i class="fa fa-check"></i><b>C.2.3</b> Identifiability constraints</a></li>
<li class="chapter" data-level="C.2.4" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-implementation"><i class="fa fa-check"></i><b>C.2.4</b> Implementation</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#model-assessment-1"><i class="fa fa-check"></i><b>C.3</b> Model assessment</a></li>
<li class="chapter" data-level="C.4" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#aghq-and-pca-aghq-details"><i class="fa fa-check"></i><b>C.4</b> AGHQ and PCA-AGHQ details</a></li>
<li class="chapter" data-level="C.5" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#normalising-constant-estimation"><i class="fa fa-check"></i><b>C.5</b> Normalising constant estimation</a></li>
<li class="chapter" data-level="C.6" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#inference-comparison-1"><i class="fa fa-check"></i><b>C.6</b> Inference comparison</a></li>
<li class="chapter" data-level="C.7" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#mcmc-convergence-and-suitability"><i class="fa fa-check"></i><b>C.7</b> MCMC convergence and suitability</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p>Bayesian spatio-temporal methods for small-area estimation of HIV indicators</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="beyond-borders" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Models for spatial structure<a href="beyond-borders.html#beyond-borders" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- For PDF output, include these two LaTeX commands after unnumbered chapter headings, otherwise the mini table of contents and the running header will show the previous chapter -->
<p>This chapter presents an investigation of spatial random effects specifications for areal data.
It was motivated by a question that often occurs during model construction.
Should a model be expanded to capture a sensible, albeit hypothetical, feature of the data?
The hypothesised data feature in this case pertains to the correlation structure between areas.
A widely used base model uses a binary relationship between areas.
One way to extend this model is to consider varying strengths of relationship between areas.
This investigation has practical significance because modelling spatial structure is of particular importance to small-area estimation of HIV.
It was prompted by confusion in seeing the base model be used in situations that appear to violate its assumptions.
The results are presented in <span class="citation">Howes, Eaton, and Flaxman (<a href="#ref-howes2023beyond">2023+</a>)</span>.
Code for the analysis in this chapter is available from <a href="https://github.com/athowes/beyond-borders"><code>https://github.com/athowes/beyond-borders</code></a>.</p>
<div id="background-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Background<a href="beyond-borders.html#background-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Modelling of spatial variation is especially important for the small-area estimation of HIV.
This is because it is difficult to measure the covariates which are most strongly associated with HIV.
Examples include sexual risk behaviour.
As a result, in previous small-area models of HIV including covariates only resulted in a modest improvement in predictions <span class="citation">(Supplementary Figure 20, <a href="#ref-dwyer2019mapping">Dwyer-Lindgren et al. 2019</a>)</span>.
This lack of predictive covariates foregrounds the role of modelling spatial variation.
For mapping of other infectious diseases, such as Malaria where transmission is driven by more predictive and easily-measurable environmental factors, explanatory covariates are more easily available and modelling spatial variation is less important <span class="citation">(<a href="#ref-weiss2015re">Weiss et al. 2015</a>)</span>.</p>
<p>Spatial variation in areal data are often modelled using spatial random effects <span class="citation">(<a href="#ref-haining2003spatial">Haining 2003</a>; <a href="#ref-cramb2018investigation">Cramb et al. 2018</a>)</span>.
The most common class of models used to specify spatial random effects are Gaussian Markov random fields [GMRFs; <span class="citation">Havard Rue and Held (<a href="#ref-rue2005gaussian">2005</a>)</span>].
These models combine a Gaussian distribution with Markov conditional independence assumptions between areas.
Observations made in areas close together are assumed to be correlated, and more distant relationships are ignored.
Perhaps the simplest GMRF model is that of <span class="citation">Besag, York, and Mollié (<a href="#ref-besag1991bayesian">1991</a>)</span> in which information is borrowed equally from each adjacent area.
The Besag model is attractive as it requires minimal additional modelling choices and is widely implemented.
As such, it has seen widespread use, including in agriculture <span class="citation">(<a href="#ref-oliver2015soil">Oliver and Gregory 2015</a>)</span>, ecology <span class="citation">(<a href="#ref-saracco2010modeling">Saracco et al. 2010</a>)</span>, epidemiology <span class="citation">(<a href="#ref-lawson2013statistical">Lawson 2013</a>)</span>, image analysis <span class="citation">(<a href="#ref-schmid2006bayesian">Schmid et al. 2006</a>)</span>, neuroscience <span class="citation">(<a href="#ref-gossl2001bayesian">Gössl, Auer, and Fahrmeir 2001</a>)</span> and public health <span class="citation">(<a href="#ref-dwyer2015drinking">Dwyer-Lindgren et al. 2015</a>)</span>.
However, for irregular geometries like the administrative divisions of a country, the assumptions made by the Besag model about space are unrealistic.
This chapter tests the hypothesis that using more realistic assumptions about spatial structure would improve the performance of small-area estimation models.
In doing so, it offers practical recommendations for modelling areal spatial structure.</p>
</div>
<div id="adjacency" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Models based on adjacency<a href="beyond-borders.html#adjacency" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-besag-model" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> The Besag model<a href="beyond-borders.html#the-besag-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Spatial structure can be encoded using a symmetric relation between areas.
Let <span class="math inline">\(i \sim j\)</span> if the areas <span class="math inline">\(A_i\)</span> and <span class="math inline">\(A_j\)</span> are adjacent or neighbouring.
Adjacency is often defined by a shared border, though other choices are possible <span class="citation">(<a href="#ref-paciorek2013spatial">Paciorek et al. 2013</a>)</span>.</p>
<p>The Besag model <span class="citation">(<a href="#ref-besag1991bayesian">Besag, York, and Mollié 1991</a>)</span> is an improper conditional auto-regressive (ICAR) model where the full conditional distribution of the <span class="math inline">\(i\)</span>th spatial random effect is given by
<span class="math display" id="eq:besag">\[\begin{equation}
    u_i \, | \, \mathbf{u}_{-i} \sim \mathcal{N} \left(\frac{1}{n_{\delta i}} \sum_{j: j \sim i} u_j, \frac{1}{n_{\delta i}\tau_u}\right), \tag{4.1}
\end{equation}\]</span>
where <span class="math inline">\(\delta i\)</span> is the set of neighbours of <span class="math inline">\(A_i\)</span> with cardinality <span class="math inline">\(n_{\delta i} = |\delta i|\)</span> and <span class="math inline">\(\mathbf{u}_{-i}\)</span> is the vector of spatial random effects with the <span class="math inline">\(i\)</span>th entry removed.
The conditional mean of the random effect <span class="math inline">\(u_i\)</span> is the average of its neighbours <span class="math inline">\(\{u_j\}_{j \sim i}\)</span> and the precision <span class="math inline">\(n_{\delta i}\tau_u\)</span> is proportional to the number of neighbours <span class="math inline">\(n_{\delta i}\)</span>.
By Brook’s lemma <span class="citation">(<a href="#ref-rue2005gaussian">Havard Rue and Held 2005</a>)</span> the set of full conditionals of the Besag model are equivalent to the Gaussian Markov random field (GMRF) given by
<span class="math display" id="eq:gmrf">\[\begin{equation}
    \mathbf{u} \sim \mathcal{N}(\mathbf{0}, \tau_u^{-1} \mathbf{R}^{-}). \tag{4.2}
\end{equation}\]</span>
The matrix <span class="math inline">\(\mathbf{R}^{-}\)</span> is the generalised inverse of the rank-deficient structure matrix <span class="math inline">\(\mathbf{R}\)</span>, so-called because it defines the structure of the precision matrix, with entries
<span class="math display">\[\begin{equation}
    R_{ij} =
    \begin{cases}
        n_{\delta i}, &amp; i = j \\
        -1, &amp; i \sim j \\
        0, &amp; \text{otherwise.}
    \end{cases}
\end{equation}\]</span>
The Markov property arises due to the conditional independence structure <span class="math inline">\(p(u_i \, | \, \mathbf{u}_{-i}) = p(u_i \, | \, \mathbf{u}_{\delta i})\)</span> whereby each area only depends on its neighbours.
This is reflected in the sparsity of <span class="math inline">\(\mathbf{R}\)</span> such that <span class="math inline">\(u_i \perp u_j \, | \, \mathbf{u}_{-ij}\)</span> if and only if <span class="math inline">\(R_{ij} = 0\)</span>.
The structure matrix <span class="math inline">\(\mathbf{R}\)</span> may also be expressed as the Laplacian of the adjacency graph <span class="math inline">\(\mathcal{G} = (\mathcal{V}, \mathcal{E})\)</span> with vertices <span class="math inline">\(v \in \mathcal{V}\)</span> corresponding to each area and edges <span class="math inline">\(e \in \mathcal{E}\)</span> between vertices <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> when <span class="math inline">\(i \sim j\)</span>.</p>
<p>Rewriting Equation <a href="beyond-borders.html#eq:gmrf">(4.2)</a>, the probability density function of <span class="math inline">\(\mathbf{u}\)</span> is
<span class="math display" id="eq:pdfu">\[\begin{equation}
    p(\mathbf{u})
    \propto \exp \left( -\frac{\tau_u}{2} \mathbf{u}^\top \mathbf{R} \mathbf{u} \right)
    \propto \exp \left( -\frac{\tau_u}{2} \sum_{i \sim j} (u_i - u_j)^2 \right). \tag{4.3}
\end{equation}\]</span>
This density is a function of the pairwise differences <span class="math inline">\(u_i - u_j\)</span> and so is invariant to the addition of a constant <span class="math inline">\(c\)</span> to each entry <span class="math inline">\(p(\mathbf{u}) = p(\mathbf{u} + c\mathbf{1})\)</span>, resulting in an improper uniform distribution on the average of the <span class="math inline">\(u_i\)</span>.
If <span class="math inline">\(\mathcal{G}\)</span> is connected, in that by traversing the edges, any vertex can be reached from any other vertex, then there is only one impropriety in the model and <span class="math inline">\(\text{rank}(\mathbf{R}) = n - 1\)</span>, while if <span class="math inline">\(\mathcal{G}\)</span> is disconnected, and composed of <span class="math inline">\(n_c \geq 2\)</span> connected components with index sets <span class="math inline">\(I_1, \ldots, I_{n_c}\)</span>, then the corresponding structure matrix <span class="math inline">\(\mathbf{R}\)</span> has rank <span class="math inline">\(n - n_c\)</span> and the density is invariant to the addition of a constant to each of the connected components <span class="math inline">\(p(\mathbf{u}_{I}) = p(\mathbf{u}_{I} + c\mathbf{1})\)</span> where <span class="math inline">\(I = I_1, \ldots, I_{n_c}\)</span>.</p>
</div>
<div id="best-practises-for-the-besag-model" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Best practises for the Besag model<a href="beyond-borders.html#best-practises-for-the-besag-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="citation">Freni-Sterrantino, Ventrucci, and Rue (<a href="#ref-freni2018note">2018</a>)</span> recommended three best practices for use of the Besag model:</p>
<ol style="list-style-type: decimal">
<li>The structure matrix <span class="math inline">\(\mathbf{R}\)</span> should be rescaled to have generalised variance, defined by the geometric mean of the diagonal elements of its generalised inverse
<span class="math display">\[\begin{equation}
\sigma^2_{\text{GV}}(\mathbf{R}) = \prod_{i = 1}^n (\mathbf{R}^-_{ii})^{1/n} = \exp \left( \frac{1}{n} \sum_{i = 1}^n \log (\mathbf{R}^-_{ii}) \right),
\end{equation}\]</span>
equal to one, by replacing <span class="math inline">\(\mathbf{R}\)</span> with <span class="math inline">\(\mathbf{R}^\star = \mathbf{R} / \sigma^2_{\text{GV}}(\mathbf{R})\)</span>.
As the diagonal elements <span class="math inline">\(R^-_{ii}\)</span> correspond to marginal variances, the generalised variance gives a measure of the average marginal variance.
However, this measure, introduced by <span class="citation">Sørbye and Rue (<a href="#ref-sorbye2014scaling">2014</a>)</span>, ignores off-diagonal entries and more broadly any measure of typical variance could be used.
Scaling mitigates the influence of the adjacency graph on the variance of <span class="math inline">\(\mathbf{u}\)</span>.
Allowing the variance to be controlled by <span class="math inline">\(\tau_u\)</span> alone is important as it allows for consistent, interpretable prior selection.</li>
</ol>
<p>When the adjacency graph is disconnected it is not appropriate to scale the structure matrix <span class="math inline">\(\mathbf{R}\)</span> uniformly since for a given precision <span class="math inline">\(\tau_u\)</span>, local smoothing operates on each connected component independently.
As such, each connected component should be scaled independently to have generalised variance one giving <span class="math inline">\(\mathbf{R}^\star_I = \mathbf{R}_I / \sigma^2_{\text{GV}}(\mathbf{R}_I)\)</span> where <span class="math inline">\(\mathbf{R}_I\)</span> is the sub-matrix of the structure matrix corresponding to index set <span class="math inline">\(I\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>When one of the connected components is a single area, known either as a singleton or an island, the probability density <span class="math inline">\(\exp \left( -\frac{\tau_u}{2} \sum_{i \sim j} (u_i - u_j)^2 \right)\)</span> has no dependence on <span class="math inline">\(u_i\)</span>.
This is equivalent to using an improper prior <span class="math inline">\(p(u_i) \propto 1\)</span> and can be avoided by setting each singleton to have independent Gaussian noise <span class="math inline">\(p(u_i) \sim \mathcal{N}(0, 1)\)</span>.</li>
<li>To avoid confounding of the spatial random effects with the intercept, it is recommended to place a sum-to-zero constraint on each non-singleton connected component.
In other words, for each <span class="math inline">\(|I| &gt; 1\)</span> that <span class="math inline">\(\sum_{i \in I} u_i = 0\)</span>.</li>
</ol>
</div>
<div id="the-reparameterised-besag-york-mollié-model" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> The reparameterised Besag-York-Mollié model<a href="beyond-borders.html#the-reparameterised-besag-york-mollié-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often, as well as spatial structure, there exists IID over-dispersion in the residuals and it is inappropriate to use purely spatially structured random effects in the model.
The Besag-York-Mollié (BYM) model of <span class="citation">Besag, York, and Mollié (<a href="#ref-besag1991bayesian">1991</a>)</span> accounts for this in a natural way by decomposing the spatial random effect <span class="math inline">\(\mathbf{u} = \mathbf{v} + \mathbf{w}\)</span> into a sum of an unstructured IID component <span class="math inline">\(\mathbf{v}\)</span> and a spatially structured Besag component <span class="math inline">\(\mathbf{w}\)</span>, each of which with their own respective precision parameters <span class="math inline">\(\tau_v\)</span> and <span class="math inline">\(\tau_w\)</span>.
The resulting distribution is
<span class="math display" id="eq:bym">\[\begin{equation}
    \mathbf{u} \sim \mathcal{N}(0, \tau_v^{-1} \mathbf{I} + \tau_w^{-1} \mathbf{R}^{-}) \tag{4.4}.
\end{equation}\]</span>
Including both <span class="math inline">\(\mathbf{v}\)</span> and <span class="math inline">\(\mathbf{w}\)</span> is intended to enable the model to learn the relative extent of the unstructured and structured components via <span class="math inline">\(\tau_v\)</span> and <span class="math inline">\(\tau_w\)</span>.
However, in this specification scaling of the Besag precision matrix <span class="math inline">\(\mathbf{Q}\)</span> is not taken into account despite this issue being particularly pertinent when dealing with multiple sources of noise.
In particular, placing a joint prior <span class="math inline">\((\tau_v, \tau_w) \sim p(\tau_v, \tau_w)\)</span> which doesn’t privilege either component is more easily accomplished if <span class="math inline">\(\mathbf{Q}\)</span> and <span class="math inline">\(\mathbf{I}\)</span> have the same scale.
Additionally, supposing we have a prior belief that the over-dispersion is primarily IID and <span class="math inline">\(\mathbf{v}\)</span> accounts for the majority of the dispersion, then it is not immediately obvious how to represent this belief using <span class="math inline">\(p(\tau_v, \tau_w)\)</span>, without inadvertently altering the prior about the overall variation.
This highlights identifiability issues of the parameters <span class="math inline">\((\tau_v, \tau_w)\)</span> resulting from them not being orthogonal.
Building on the models of <span class="citation">Leroux, Lei, and Breslow (<a href="#ref-leroux2000estimation">2000</a>)</span> and <span class="citation">Dean, Ugarte, and Militino (<a href="#ref-dean2001detecting">2001</a>)</span> which tackle this identifiability problem, but do not scale the spatially structured noise, <span class="citation">Simpson et al. (<a href="#ref-simpson2017penalising">2017</a>)</span> propose a reparameterisation <span class="math inline">\((\tau_v, \tau_w) \mapsto (\tau_u, \phi)\)</span> of the BYM model known as the BYM2 model and given by
<span class="math display" id="eq:bym2">\[\begin{align}
\mathbf{u} = \frac{1}{\tau_u} \left( \sqrt{1- \phi} \, \mathbf{v} + \sqrt{\phi} \, \mathbf{w}^\star \right), \tag{4.5}
\end{align}\]</span>
where <span class="math inline">\(\tau_u\)</span> is the marginal precision of <span class="math inline">\(\mathbf{u}\)</span>, <span class="math inline">\(\phi \in [0, 1]\)</span> gives the proportion of the marginal variance explained by each component, and <span class="math inline">\(\mathbf{w}^\star\)</span> is a scaled version of <span class="math inline">\(\mathbf{w}\)</span> with precision matrix given by the scaled structure matrix <span class="math inline">\(\mathbf{R}^\star\)</span>.
When <span class="math inline">\(\phi = 0\)</span> the random effects are IID, and when <span class="math inline">\(\phi = 1\)</span> the random effects follow the Besag model.
To borrow an analogy <span class="citation">(<a href="#ref-rue2020comment">Håvard Rue 2020</a>)</span> the parameterisation <span class="math inline">\((\tau_v, \tau_w)\)</span> is like having one hot water and one cold water tap, whereas the parameterisation <span class="math inline">\((\tau_u, \phi)\)</span> is like a mixer tap where the amount of water and its temperature can be adjusted separately.</p>
</div>
<div id="concerns-about-the-besag-models-spatial-representation" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Concerns about the Besag model’s spatial representation<a href="beyond-borders.html#concerns-about-the-besag-models-spatial-representation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Besag model was originally proposed for use in image analysis, where areas correspond to pixels arranged in a regular lattice structure.
Since then, it has seen wider use, including in situations, like small-area estimation of HIV, where the spatial structure is less regular.
As such, I have a number of concerns about the model’s applicability to this broader setting.
This discussion is closely linked to the modifiable areal unit problem <span class="citation">(<a href="#ref-openshow1979million">Openshaw and Taylor 1979</a>)</span>, whereby statistical conclusions change as a result of seemingly arbitrary changes in data aggregation, as well as the challenge of ecological inference and the ecological fallacy <span class="citation">(<a href="#ref-wakefield2010aggregation">Jonathan Wakefield and Lyons 2010</a>)</span>.</p>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:maup1"></span>
<img src="figures/beyond-borders/maup1.png" alt="Though they are quite different, the geometries shown in panels A, B, C, and D each have the same adjacency graph." width="95%" />
<p class="caption">
Figure 4.1: Though they are quite different, the geometries shown in panels A, B, C, and D each have the same adjacency graph.
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:maup2"></span>
<img src="figures/beyond-borders/maup2.png" alt="A sequence of geometries where the number of neighbours of area one grows by one at each iteration." width="95%" />
<p class="caption">
Figure 4.2: A sequence of geometries where the number of neighbours of area one grows by one at each iteration.
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:maup3"></span>
<img src="figures/beyond-borders/maup3.png" alt="Each of the shaded areas are split into two moving from Panel A to Panel B." width="95%" />
<p class="caption">
Figure 4.3: Each of the shaded areas are split into two moving from Panel A to Panel B.
</p>
</div>
<div id="adjacency-compression" class="section level4 hasAnchor" number="4.2.4.1">
<h4><span class="header-section-number">4.2.4.1</span> Adjacency compression<a href="beyond-borders.html#adjacency-compression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Summarising a geometry by an adjacency graph represents a loss of information.
Many geometries share the same adjacency graph, and are as such isomorphic identical under the Besag model (Figure).
This is not in itself a problem, but does prompt consideration as to whether the class of geometries with the same adjacency graph is sufficiently similar to merit identical models.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
Intuitively, the more regular the spatial structure, the less information is lost in compression to an adjacency graph.
In image analysis, very little spatial information is lost in compression of a lattice structure to an adjacency graph.
On the other hand, the regions of a country, determined by political and geographic forces, tend to display greater irregularity.
The appropriateness of adjacency compression therefore varies by the type of geometry common to the application setting.</p>
</div>
<div id="mean-structure" class="section level4 hasAnchor" number="4.2.4.2">
<h4><span class="header-section-number">4.2.4.2</span> Mean structure<a href="beyond-borders.html#mean-structure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the Besag model is all adjacent areas count equally.
This assumption is unsatisfying: for most geometries, we expect different amounts of correlation between neighbours.
Figure illustrates a number of heuristic features for neighbour importance, including length of shared border, and the proximity of centers of mass.</p>
</div>
<div id="variance-structure" class="section level4 hasAnchor" number="4.2.4.3">
<h4><span class="header-section-number">4.2.4.3</span> Variance structure<a href="beyond-borders.html#variance-structure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In Equation <a href="beyond-borders.html#eq:besag">(4.1)</a> the precision of <span class="math inline">\(u_i\)</span> is proportional to its number of neighbours <span class="math inline">\(n_{\delta i}\)</span>.
It follow that as <span class="math inline">\(n_{\delta i} \to \infty\)</span> then <span class="math inline">\(\text{Var}(u_i) \to 0\)</span>.
This is illustrated by Figure where the area on the right is repeatedly divided such that its number of neighbours increases.
This property is a consequence of averaging the conditional mean over a greater number of areas, which, in certain situations, can correspond to a greater amount of information.
However, if the amount of information in the shaded area remains fixed, it is inappropriate that <span class="math inline">\(\text{Var}(u_1)\)</span> should tend to zero as a result of drawing additional, arbitrary, boundaries.
In the image analysis setting this modelling assumption is reasonable: each pixel represents a fixed amount of information and a higher pixel density represents a greater amount of information.
On the other hand, in public health and epidemiology, drawing boundaries to create additional areas is not expected to correspond to a greater amount of information.</p>
<p>Suppose we fit a Besag model upon identical data using each of the two geometries in Figure.
If the spatial variation is relatively smooth, dividing the shaded areas into two will result in a lower estimated variance <span class="math inline">\(\sigma^2_u\)</span> in geometry (ii) as compared with geometry (i) because there will appear to be less variation between neighbouring areas.
This problem does not only apply locally: since the effect of <span class="math inline">\(\sigma^2_u\)</span> applies everywhere, the smoothing will change even in unaltered parts of the study region.</p>
</div>
</div>
</div>
<div id="models-using-kernels" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Models using kernels<a href="beyond-borders.html#models-using-kernels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Section <a href="beyond-borders.html#adjacency">4.2</a> reviewed ways to construct spatial random effect precision matrices using an adjacency relation.
An alternate approach is to define the covariance matrix using an areal kernel function which gives a measure of similarity between two areas <span class="math inline">\(K: \mathcal{P}(\Sc) \times \mathcal{P}(\Sc) \to \mathbb{R}\)</span>, where <span class="math inline">\(\mathcal{P}\)</span> denotes the power set such that <span class="math inline">\(\mathcal{P}(\Sc)\)</span> is the space of subsets of the study region.
If <span class="math inline">\(K\)</span> is positive semi-definite, then define areal kernel spatial random effects by
<span class="math display">\[\begin{equation}
    \phi \sim \mathcal{N} \left( 0, \frac{1}{\tau_\phi} \mathbf{K} \right), \label{eq:arealkernel}
\end{equation}\]</span>
where the <span class="math inline">\(n \times n\)</span> Gram matrix <span class="math inline">\(\mathbf{K}\)</span> with entries <span class="math inline">\(K_{ij} = K(A_i, A_j)\)</span> is a valid covariance matrix.
Here, the precision parameter <span class="math inline">\(\tau_\phi\)</span> is placed outside of the Gram matrix, analogous to the relation of the precision and structure matrices.
Most well-known spatial process models define the correlation structure between a pair of points using a kernel <span class="math inline">\(k: \mathcal{S} \times \mathcal{S} \to \mathbb{R}\)</span>.
A simple method to construct <span class="math inline">\(K\)</span> from <span class="math inline">\(k\)</span> is to average the kernel <span class="math inline">\(k\)</span> computed on some collection of points from within each area.</p>
<div id="centroid-kernel" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Centroid kernel<a href="beyond-borders.html#centroid-kernel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The simplest approach is to use a single point such that <span class="math inline">\(K(A_i, A_j) = k(p_i, p_j)\)</span>.
A natural choice is the centroid <span class="math inline">\(p_i = c_i\)</span>, given by the arithmetic mean of the latitude and longitude, which may be representative of the area.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
This results in the centroid kernel
<span class="math display">\[\begin{equation}
    K(A_i, A_j) = k(c_i, c_j).
\end{equation}\]</span>
The centroid kernel has been used in environmental epidemiology <span class="citation">(<a href="#ref-wakefield1999spatial">J. Wakefield and Morris 1999</a>)</span> and to model the reproduction number of COVID-19 <span class="citation">(<a href="#ref-teh2021efficient">Teh et al. 2021</a>)</span>.
A model comparison study [Section 3; <span class="citation">Best, Richardson, and Thomson (<a href="#ref-best2005comparison">2005</a>)</span>] simulated data representing heterogeneous exposure to air pollution, including elevated rates of exposure near two hypothetical point source locations, and found that the centroid kernel tended to over-smooth the high-risk areas.
That said, it is unsuprising that a stationary covariance would struggle to recover non-stationary structure.</p>
</div>
<div id="integrated-kernel" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Integrated kernel<a href="beyond-borders.html#integrated-kernel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rather than choosing a single representative point, an alternative is to represent the whole area by integrating the kernel over the areas of interest.
This results in the integrated kernel
<span class="math display">\[\begin{equation}
K(A_i, A_j) = \frac{1}{|A_i||A_j|} \int_{A_i} \int_{A_j} k(s, s&#39;) \text{d} s \text{d} s&#39;. \label{eq:ik1}
\end{equation}\]</span>
This covariance structure is equivalent to that obtained by aggregating a spatially continuous Gaussian process with kernel <span class="math inline">\(k\)</span> over the areal partition, and has been studied in the machine learning literature under the name aggregated Gaussian processes <span class="citation">(<a href="#ref-law2018variational">Law et al. 2018</a>; <a href="#ref-tanaka2019spatially">Tanaka et al. 2019</a>; <a href="#ref-yousefi2019multi">Yousefi, Smith, and Alvarez 2019</a>; <a href="#ref-hamelijnck2019multi">Hamelijnck et al. 2019</a>)</span>.
Unlike for the centroid kernel where <span class="math inline">\(K_{ii} = 1\)</span> for all <span class="math inline">\(i\)</span>, the marginal variance of the <span class="math inline">\(i\)</span>th spatial random effect <span class="math inline">\(K_{ii} = K(A_i, A_i)\)</span> varies depending on the area: becoming smaller for more compact areas and larger for areas which are of greater extent or more spread out.</p>
<div id="accounting-for-heterogeneity" class="section level4 hasAnchor" number="4.3.2.1">
<h4><span class="header-section-number">4.3.2.1</span> Accounting for heterogeneity<a href="beyond-borders.html#accounting-for-heterogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Additional information accounting for heterogeneity over <span class="math inline">\(A_i\)</span> may be incorporated into the integrated kernel<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
This can be accomplished using weighting distributions <span class="math inline">\(\{W_i\}\)</span> which represent an unequal contribution of each point to the similarity measure, to give a weighted integrated kernel
<span class="math display">\[\begin{equation}
K(A_i, A_j) = \frac{1}{|A_i||A_j|}\int_{A_i} \int_{A_j} w_i(s) w_j(s&#39;) k(s, s&#39;) \text{d} s \text{d} s&#39;, \label{eq:ik2}
\end{equation}\]</span>
This may be useful in disease mapping, where we expect regions with populations who live close to their shared border to be more strongly correlated than regions whose populations live far apart, which could be accounted for by weighting according to a high resolution measure of population density.</p>
</div>
<div id="computation" class="section level4 hasAnchor" number="4.3.2.2">
<h4><span class="header-section-number">4.3.2.2</span> Computation<a href="beyond-borders.html#computation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Most of the time we do not expect to be able to calculate Equation <span class="math inline">\(\ref{eq:ik2}\)</span> analytically.
Instead, given <span class="math inline">\(n\)</span> collections of <span class="math inline">\(L_i\)</span> samples <span class="math inline">\(\{s^{(i)}_l \}_{l = 1}^{L_i} \sim \mathcal{U}(A_i)\)</span> drawn uniformly from each area then the integral may be approximated using Monte Carlo by the double sum
<span class="math display">\[\begin{equation}
K(A_i, A_j) \approx \frac{1}{L_i L_j} \sum_{l = 1}^{L_i} \sum_{m = 1}^{L_j}
w_i \left( s^{(i)}_l \right) w_j \left( s^{(j)}_m \right)
k \left( s^{(i)}_l, s^{(j)}_m \right). \label{eq:mcintegratedkernel}
\end{equation}\]</span>
Equivalently, samples drawn from <span class="math inline">\(W_i\)</span> may be used without weighting by <span class="math inline">\(w_i(s)\)</span>.
Nodes may also be selected deterministically to give a numerical quadrature estimate of the kernel.
These approaches require <span class="math inline">\(\mathcal{O}(\sum_{i = 1}^n \sum_{j = 1}^n L_i L_j)\)</span> evaluations of the kernel <span class="math inline">\(k\)</span> to compute the <span class="math inline">\(n \times n\)</span> Gram matrix <span class="math inline">\(K\)</span>.
This imposes a significant computational cost if the Gram matrix is often recomputed during inference, as is the case in MCMC when any of the kernel hyperparameters are learnt, placing a limit on the number of samples or nodes it is feasible to use.
<span class="citation">Kelsall and Wakefield (<a href="#ref-kelsall2002modeling">2002</a>)</span> make inference more feasible by using a discrete hyperparameter prior to reduce the number of Gram matrix constructions and inversions required.</p>
</div>
<div id="mismatch-to-data-generating-process" class="section level4 hasAnchor" number="4.3.2.3">
<h4><span class="header-section-number">4.3.2.3</span> Mismatch to data generating process<a href="beyond-borders.html#mismatch-to-data-generating-process" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Aggregation via the integrated kernel occurs at the level of the latent field rather than at the level of the data.
<!-- This corresponds to a generative model of the form $y_i \sim p(y_i \, | \,  g^{-1}(x_i))$, with $x_i = |A_i|^{-1}\int_{A_i} x(s) \text{d} s$. -->
If the link function <span class="math inline">\(g\)</span> is the identity or linear then aggregation at the level of the latent field is equivalent to aggregation at the level of the data.
On the other hand, for non-linear link functions <span class="math inline">\(g\)</span> such as the commonly used exponential or logistic, the generative model does not match the proposed data generating process.
<!-- Add equations for mean $\mathbb{E}(y_i)$ and variance $\mathbb{V}(y_i)$ of under this model, as a function of $g$. -->
<!-- Explain under what circumstances we believe this approximation to be acceptable. --></p>
</div>
<div id="log-gaussian-cox-processes" class="section level4 hasAnchor" number="4.3.2.4">
<h4><span class="header-section-number">4.3.2.4</span> Log-Gaussian Cox processes<a href="beyond-borders.html#log-gaussian-cox-processes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The log-Gaussian Cox Process framework <span class="citation">(<a href="#ref-diggle2013spatial">Diggle et al. 2013</a>)</span> arrives naturally at the integrated kernel formulation.
A Cox process is an inhomogeneous Poisson process with a continuous stochastic intensity function <span class="math inline">\(\{ x(s), s \in \Sc \}\)</span> such that conditional on the realisation of <span class="math inline">\(x(s)\)</span> the number of points in any area <span class="math inline">\(A_i\)</span> follows a Poisson distribution.
The rate parameter of this Poisson distribution is explicitly aggregated as follows
<span class="math display">\[\begin{equation}
y_i \, | \, x(s) \sim \text{Poisson} \left(\int_{s \in A_i} x(s) \text{d}s \right).
\end{equation}\]</span>
In a LGCP the log intensity <span class="math inline">\(\log x(s) = \eta(s)\)</span> is modelled using a Gaussian process prior <span class="math inline">\(\eta(s) \sim \mathcal{GP}(\mu(s), k(s, s&#39;))\)</span>.
<span class="citation">O. Johnson, Diggle, and Giorgi (<a href="#ref-johnson2019spatially">2019</a>)</span> obtain Equation <span class="math inline">\(\ref{eq:ik2}\)</span> by considering a discrete Poisson log-linear mixed model approximation to a continuous LGCP, whereby <span class="math inline">\(\eta(s)\)</span> is approximated by a piecewise constant <span class="math inline">\(\eta_i = \mu_i + \phi_i\)</span> in each area <span class="math inline">\(A_i\)</span>.
The <span class="math inline">\(i\)</span>th discrete spatial random effect is then <span class="math inline">\(\phi_i = \int_{A_i} w_i(s) \phi(s) \text{d}s\)</span>,
with covariance structure
<span class="math display">\[\begin{equation}
\text{Cov} \left( \int_{A_i} w_i(s) \phi(s) \text{d}s, \int_{A_j} w_j(s&#39;) \phi(s&#39;) \text{d}s&#39; \right)
= \int_{A_i} \int_{A_j} w_i(s) w_j(s&#39;) k(s, s&#39;) \text{d}s\text{d}s&#39;,
\end{equation}\]</span>
corresponding to an areal integrated kernel with a logarithmic link function and Poisson likelihood.</p>
<!-- Discuss Gary's paper here? [@konstantinoudis2020discrete] -->
</div>
<div id="disaggregation-regression" class="section level4 hasAnchor" number="4.3.2.5">
<h4><span class="header-section-number">4.3.2.5</span> Disaggregation regression<a href="beyond-borders.html#disaggregation-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Disaggregation regression, also known as downscaling or interpolation, is another closely related approach.
Rather than focusing on the aggregate nature of areal observations as primarily a route towards better area-level estimates, disaggregation regression aims to produce high-resolution or point-level estimates from areal observations <span class="citation">(<a href="#ref-utazi2019spatial">Utazi et al. 2019</a>; <a href="#ref-nandi2023disaggregation">Nandi et al. 2023</a>)</span>.
<!-- Accurate point-level estimates are close to being a necessary intermediate goal towards obtaining accurate area-level estimates. -->
<!-- Disaggregation is challenging without auxiliary information. -->
<!-- A unified view on Bayesian varying coefficient models by Franco-Villoria et al. --></p>
</div>
</div>
<div id="the-stochastic-partial-differential-equation-approximation" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> The stochastic partial differential equation approximation<a href="beyond-borders.html#the-stochastic-partial-differential-equation-approximation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a more computationally efficient way to implement integrated kernels.</p>
</div>
</div>
<div id="simulation-study" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Simulation study<a href="beyond-borders.html#simulation-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We tested the ability of inferential models with varying spatial random effect specifications to accurately recover small-area quantities.
The data and modelling choices were designed with a spatial epidemiology setting in mind.</p>
<div id="synthetic-data-sets" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Synthetic data-sets<a href="beyond-borders.html#synthetic-data-sets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="hiv-prevalence-study" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> HIV prevalence study<a href="beyond-borders.html#hiv-prevalence-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="discussion" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Discussion<a href="beyond-borders.html#discussion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Follestad and Rue (<a href="#ref-follestad2003modelling">2003</a>)</span></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-besag1991bayesian" class="csl-entry">
Besag, Julian, Jeremy York, and Annie Mollié. 1991. <span>“<span class="nocase">Bayesian image restoration, with two applications in spatial statistics</span>.”</span> <em>Annals of the Institute of Statistical Mathematics</em> 43 (1): 1–20.
</div>
<div id="ref-best2005comparison" class="csl-entry">
Best, Nicky, Sylvia Richardson, and Andrew Thomson. 2005. <span>“<span class="nocase">A comparison of Bayesian spatial models for disease mapping</span>.”</span> <em>Statistical Methods in Medical Research</em> 14 (1): 35–59.
</div>
<div id="ref-cramb2018investigation" class="csl-entry">
Cramb, SM, EW Duncan, PD Baade, and KL Mengersen. 2018. <span>“Investigation of Bayesian Spatial Models.”</span>
</div>
<div id="ref-dean2001detecting" class="csl-entry">
Dean, CB, MD Ugarte, and AF Militino. 2001. <span>“Detecting Interaction Between Random Region and Fixed Age Effects in Disease Mapping.”</span> <em>Biometrics</em> 57 (1): 197–202.
</div>
<div id="ref-diggle2013spatial" class="csl-entry">
Diggle, Peter J, Paula Moraga, Barry Rowlingson, Benjamin M Taylor, et al. 2013. <span>“Spatial and Spatio-Temporal Log-Gaussian Cox Processes: Extending the Geostatistical Paradigm.”</span> <em>Statistical Science</em> 28 (4): 542–63.
</div>
<div id="ref-dwyer2019mapping" class="csl-entry">
Dwyer-Lindgren, Laura, Michael A Cork, Amber Sligar, Krista M Steuben, Kate F Wilson, Naomi R Provost, Benjamin K Mayala, et al. 2019. <span>“<span class="nocase">Mapping HIV prevalence in sub-Saharan Africa between 2000 and 2017</span>.”</span> <em>Nature</em> 570 (7760): 189–93.
</div>
<div id="ref-dwyer2015drinking" class="csl-entry">
Dwyer-Lindgren, Laura, Abraham D Flaxman, Marie Ng, Gillian M Hansen, Christopher JL Murray, and Ali H Mokdad. 2015. <span>“<span class="nocase">Drinking patterns in US counties from 2002 to 2012</span>.”</span> <em>American Journal of Public Health</em> 105 (6): 1120–27.
</div>
<div id="ref-follestad2003modelling" class="csl-entry">
Follestad, Turid, and Håvard Rue. 2003. <span>“Modelling Spatial Variation in Disease Risk Using Gaussian Markov Random Field Proxies for Gaussian Random Fields.”</span> SIS-2003-305.
</div>
<div id="ref-freni2018note" class="csl-entry">
Freni-Sterrantino, Anna, Massimo Ventrucci, and Håvard Rue. 2018. <span>“A Note on Intrinsic Conditional Autoregressive Models for Disconnected Graphs.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 26: 25–34.
</div>
<div id="ref-gossl2001bayesian" class="csl-entry">
Gössl, Christoff, Dorothee P Auer, and Ludwig Fahrmeir. 2001. <span>“Bayesian Spatiotemporal Inference in Functional Magnetic Resonance Imaging.”</span> <em>Biometrics</em> 57 (2): 554–62.
</div>
<div id="ref-haining2003spatial" class="csl-entry">
Haining, Robert P. 2003. <em>Spatial Data Analysis: Theory and Practice</em>. Cambridge university press.
</div>
<div id="ref-hamelijnck2019multi" class="csl-entry">
Hamelijnck, O, T Damoulas, K Wang, and MA Girolami. 2019. <span>“Multi-Resolution Multi-Task Gaussian Processes.”</span> <em>Advances in Neural Information Processing Systems</em> 32.
</div>
<div id="ref-howes2023beyond" class="csl-entry">
Howes, Adam, Jeffrey W. Eaton, and Seth R. Flaxman. 2023+. <span>“<span class="nocase">Beyond borders: evaluating the suitability of spatial adjacency for small-area estimation</span>,”</span> 2023+.
</div>
<div id="ref-johnson2019spatially" class="csl-entry">
Johnson, Olatunji, Peter Diggle, and Emanuele Giorgi. 2019. <span>“<span class="nocase">A spatially discrete approximation to log-Gaussian Cox processes for modelling aggregated disease count data</span>.”</span> <em>Statistics in Medicine</em> 38 (24): 4871–87.
</div>
<div id="ref-kelsall2002modeling" class="csl-entry">
Kelsall, Julia, and Jonathan Wakefield. 2002. <span>“Modeling Spatial Variation in Disease Risk: A Geostatistical Approach.”</span> <em>Journal of the American Statistical Association</em> 97 (459): 692–701.
</div>
<div id="ref-law2018variational" class="csl-entry">
Law, Ho Chung, Dino Sejdinovic, Ewan Cameron, Tim Lucas, Seth Flaxman, Katherine Battle, and Kenji Fukumizu. 2018. <span>“Variational Learning on Aggregate Outputs with Gaussian Processes.”</span> <em>Advances in Neural Information Processing Systems</em> 31.
</div>
<div id="ref-lawson2013statistical" class="csl-entry">
Lawson, Andrew B. 2013. <em>Statistical Methods in Spatial Epidemiology</em>. John Wiley &amp; Sons.
</div>
<div id="ref-leroux2000estimation" class="csl-entry">
Leroux, Brian G, Xingye Lei, and Norman Breslow. 2000. <span>“Estimation of Disease Rates in Small Areas: A New Mixed Model for Spatial Dependence.”</span> In <em>Statistical Models in Epidemiology, the Environment, and Clinical Trials</em>, 179–91. Springer.
</div>
<div id="ref-nandi2023disaggregation" class="csl-entry">
Nandi, Anita K, Tim CD Lucas, Rohan Arambepola, Peter Gething, and Daniel J Weiss. 2023. <span>“<span class="nocase">disaggregation: An R Package for Bayesian Spatial Disaggregation Modeling</span>.”</span> <em>Journal of Statistical Software</em> 106: 1–19.
</div>
<div id="ref-oliver2015soil" class="csl-entry">
Oliver, Margaret A, and PJ Gregory. 2015. <span>“Soil, Food Security and Human Health: A Review.”</span> <em>European Journal of Soil Science</em> 66 (2): 257–76.
</div>
<div id="ref-openshow1979million" class="csl-entry">
Openshaw, S, and P. J. Taylor. 1979. <span>“A Million or so Correlation Coefficients, Three Experiments on the Modifiable Areal Unit Problem.”</span> <em>Statistical Applications in the Spatial Science</em>, 127–44.
</div>
<div id="ref-paciorek2013spatial" class="csl-entry">
Paciorek, Christopher J et al. 2013. <span>“Spatial Models for Point and Areal Data Using Markov Random Fields on a Fine Grid.”</span> <em>Electronic Journal of Statistics</em> 7: 946–72.
</div>
<div id="ref-rue2020comment" class="csl-entry">
———. 2020. <span>“Comment on r-INLA Discussion Group Thread.”</span>
</div>
<div id="ref-rue2005gaussian" class="csl-entry">
Rue, Havard, and Leonhard Held. 2005. <em><span class="nocase">Gaussian Markov random fields: theory and applications</span></em>. CRC press.
</div>
<div id="ref-saracco2010modeling" class="csl-entry">
Saracco, James F, J Andrew Royle, David F DeSante, and Beth Gardner. 2010. <span>“Modeling Spatial Variation in Avian Survival and Residency Probabilities.”</span> <em>Ecology</em> 91 (7): 1885–91.
</div>
<div id="ref-schmid2006bayesian" class="csl-entry">
Schmid, Volker J, Brandon Whitcher, Anwar R Padhani, N Jane Taylor, and Guang-Zhong Yang. 2006. <span>“Bayesian Methods for Pharmacokinetic Models in Dynamic Contrast-Enhanced Magnetic Resonance Imaging.”</span> <em>IEEE Transactions on Medical Imaging</em> 25 (12): 1627–36.
</div>
<div id="ref-simpson2017penalising" class="csl-entry">
Simpson, Daniel, Håvard Rue, Andrea Riebler, Thiago G Martins, Sigrunn H Sørbye, et al. 2017. <span>“<span class="nocase">Penalising model component complexity: A principled, practical approach to constructing priors</span>.”</span> <em>Statistical Science</em> 32 (1): 1–28.
</div>
<div id="ref-sorbye2014scaling" class="csl-entry">
Sørbye, Sigrunn Holbek, and Håvard Rue. 2014. <span>“<span class="nocase">Scaling intrinsic Gaussian Markov random field priors in spatial modelling</span>.”</span> <em>Spatial Statistics</em> 8: 39–51.
</div>
<div id="ref-tanaka2019spatially" class="csl-entry">
Tanaka, Yusuke, Toshiyuki Tanaka, Tomoharu Iwata, Takeshi Kurashima, Maya Okawa, Yasunori Akagi, and Hiroyuki Toda. 2019. <span>“<span class="nocase">Spatially aggregated Gaussian processes with multivariate areal outputs</span>.”</span> In <em>Advances in Neural Information Processing Systems</em>, 3005–15.
</div>
<div id="ref-teh2021efficient" class="csl-entry">
Teh, Yee Whye, Avishkar Bhoopchand, Peter Diggle, Bryn Elesedy, Bobby He, Michael Hutchinson, Ulrich Paquet, Jonathan Read, Nenad Tomasev, and Sheheryar Zaidi. 2021. <span>“Efficient Bayesian Inference of Instantaneous Re-Production Numbers at Fine Spatial Scales, with an Application to Mapping and Nowcasting the Covid-19 Epidemic in British Local Authorities.”</span> <em>URL Https://Rss. Org. Uk/RSS/Media/File-Library/News/2021/WhyeBhoopchand. Pdfhttps://Localcovid. Info/2</em>.
</div>
<div id="ref-utazi2019spatial" class="csl-entry">
Utazi, C Edson, Julia Thorley, VA Alegana, MJ Ferrari, Kristine Nilsen, Saki Takahashi, CJE Metcalf, Justin Lessler, and AJ Tatem. 2019. <span>“A Spatial Regression Model for the Disaggregation of Areal Unit Based Data to High-Resolution Grids with Application to Vaccination Coverage Mapping.”</span> <em>Statistical Methods in Medical Research</em> 28 (10-11): 3226–41.
</div>
<div id="ref-wakefield1999spatial" class="csl-entry">
Wakefield, J, and S Morris. 1999. <span>“Spatial Dependence and Errors-in-Variables in Environmental Epidemiology.”</span> <em>Bayesian Statistics</em> 6: 657–84.
</div>
<div id="ref-wakefield2010aggregation" class="csl-entry">
Wakefield, Jonathan, and Hilary Lyons. 2010. <span>“Spatial Aggregation and the Ecological Fallacy.”</span> In <em>Chapman &amp; Hall/CRC Handbooks of Modern Statistical Methods</em>, 2010:541–58. <a href="https://doi.org/10.1201/9781420072884-c30">https://doi.org/10.1201/9781420072884-c30</a>.
</div>
<div id="ref-weiss2015re" class="csl-entry">
Weiss, Daniel J, Bonnie Mappin, Ursula Dalrymple, Samir Bhatt, Ewan Cameron, Simon I Hay, and Peter W Gething. 2015. <span>“Re-Examining Environmental Correlates of Plasmodium Falciparum Malaria Endemicity: A Data-Intensive Variable Selection Approach.”</span> <em>Malaria Journal</em> 14 (1): 1–18.
</div>
<div id="ref-yousefi2019multi" class="csl-entry">
Yousefi, Fariba, Michael T Smith, and Mauricio Alvarez. 2019. <span>“Multi-Task Learning for Aggregated Data Using Gaussian Processes.”</span> <em>Advances in Neural Information Processing Systems</em> 32.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>The regularity of realistic geometries may help to constrain each class to be more similar than it strictly has to be. In other words, although pathological geometries can be constructed, they are implausible in statistical practise and so not of great concern to us here.<a href="beyond-borders.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Note it is not guaranteed for the centroid to (even) lie within the area i.e. we may have <span class="math inline">\(c_i \notin A_i\)</span>.<a href="beyond-borders.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Analogously, weighted centroids could also be used in the centroid kernel.<a href="beyond-borders.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayes-st.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multi-agyw.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ulyngs/oxforddown/tree/master/04-beyond-borders.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
