<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Fast approximate Bayesian inference | Methods and applications of Bayesian spatio-temporal statistics for small-area estimation of HIV indicators</title>
  <meta name="description" content="5 Fast approximate Bayesian inference | Methods and applications of Bayesian spatio-temporal statistics for small-area estimation of HIV indicators" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Fast approximate Bayesian inference | Methods and applications of Bayesian spatio-temporal statistics for small-area estimation of HIV indicators" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Fast approximate Bayesian inference | Methods and applications of Bayesian spatio-temporal statistics for small-area estimation of HIV indicators" />
  
  
  

<meta name="author" content="Adam Howes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multi-agyw.html"/>
<link rel="next" href="conclusions.html"/>
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="templates/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#chapter-overview"><i class="fa fa-check"></i><b>1.1</b> Chapter overview</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>2</b> Background</a>
<ul>
<li class="chapter" data-level="2.1" data-path="background.html"><a href="background.html#the-hivaids-epidemic"><i class="fa fa-check"></i><b>2.1</b> The HIV/AIDS epidemic</a></li>
<li class="chapter" data-level="2.2" data-path="background.html"><a href="background.html#bayesian-spatio-temporal-statistics"><i class="fa fa-check"></i><b>2.2</b> Bayesian spatio-temporal statistics</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="background.html"><a href="background.html#bayesian-statistics"><i class="fa fa-check"></i><b>2.2.1</b> Bayesian statistics</a></li>
<li class="chapter" data-level="2.2.2" data-path="background.html"><a href="background.html#spatio-temporal-statistics"><i class="fa fa-check"></i><b>2.2.2</b> Spatio-temporal statistics</a></li>
<li class="chapter" data-level="2.2.3" data-path="background.html"><a href="background.html#latent-gaussian-and-extended-latent-gaussian-models"><i class="fa fa-check"></i><b>2.2.3</b> Latent Gaussian and extended latent Gaussian models</a></li>
<li class="chapter" data-level="2.2.4" data-path="background.html"><a href="background.html#survey-methods"><i class="fa fa-check"></i><b>2.2.4</b> Survey methods</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="beyond-borders.html"><a href="beyond-borders.html"><i class="fa fa-check"></i><b>3</b> Spatial structure</a>
<ul>
<li class="chapter" data-level="3.1" data-path="beyond-borders.html"><a href="beyond-borders.html#background-1"><i class="fa fa-check"></i><b>3.1</b> Background</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="beyond-borders.html"><a href="beyond-borders.html#areal-and-point-data"><i class="fa fa-check"></i><b>3.1.1</b> Areal and point data</a></li>
<li class="chapter" data-level="3.1.2" data-path="beyond-borders.html"><a href="beyond-borders.html#spatial-random-effects"><i class="fa fa-check"></i><b>3.1.2</b> Spatial random effects</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="beyond-borders.html"><a href="beyond-borders.html#models-based-on-adjacency"><i class="fa fa-check"></i><b>3.2</b> Models based on adjacency</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="beyond-borders.html"><a href="beyond-borders.html#the-besag-model"><i class="fa fa-check"></i><b>3.2.1</b> The Besag model</a></li>
<li class="chapter" data-level="3.2.2" data-path="beyond-borders.html"><a href="beyond-borders.html#the-bym2-model"><i class="fa fa-check"></i><b>3.2.2</b> The BYM2 model</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="beyond-borders.html"><a href="beyond-borders.html#models-using-kernels"><i class="fa fa-check"></i><b>3.3</b> Models using kernels</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="beyond-borders.html"><a href="beyond-borders.html#the-centroid-kernel-model"><i class="fa fa-check"></i><b>3.3.1</b> The centroid kernel model</a></li>
<li class="chapter" data-level="3.3.2" data-path="beyond-borders.html"><a href="beyond-borders.html#the-integrated-kernel-model"><i class="fa fa-check"></i><b>3.3.2</b> The integrated kernel model</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="beyond-borders.html"><a href="beyond-borders.html#simulation-study"><i class="fa fa-check"></i><b>3.4</b> Simulation study</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="beyond-borders.html"><a href="beyond-borders.html#synthetic-data-sets"><i class="fa fa-check"></i><b>3.4.1</b> Synthetic data-sets</a></li>
<li class="chapter" data-level="3.4.2" data-path="beyond-borders.html"><a href="beyond-borders.html#inferential-models"><i class="fa fa-check"></i><b>3.4.2</b> Inferential models</a></li>
<li class="chapter" data-level="3.4.3" data-path="beyond-borders.html"><a href="beyond-borders.html#inference-algorithms"><i class="fa fa-check"></i><b>3.4.3</b> Inference algorithms</a></li>
<li class="chapter" data-level="3.4.4" data-path="beyond-borders.html"><a href="beyond-borders.html#model-assessment"><i class="fa fa-check"></i><b>3.4.4</b> Model assessment</a></li>
<li class="chapter" data-level="3.4.5" data-path="beyond-borders.html"><a href="beyond-borders.html#results"><i class="fa fa-check"></i><b>3.4.5</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="beyond-borders.html"><a href="beyond-borders.html#hiv-prevalence-study"><i class="fa fa-check"></i><b>3.5</b> HIV prevalence study</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="beyond-borders.html"><a href="beyond-borders.html#results-1"><i class="fa fa-check"></i><b>3.5.1</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="beyond-borders.html"><a href="beyond-borders.html#discussion"><i class="fa fa-check"></i><b>3.6</b> Discussion</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="beyond-borders.html"><a href="beyond-borders.html#limitations"><i class="fa fa-check"></i><b>3.6.1</b> Limitations</a></li>
<li class="chapter" data-level="3.6.2" data-path="beyond-borders.html"><a href="beyond-borders.html#conclusion"><i class="fa fa-check"></i><b>3.6.2</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multi-agyw.html"><a href="multi-agyw.html"><i class="fa fa-check"></i><b>4</b> A model for risk group proportions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multi-agyw.html"><a href="multi-agyw.html#background-2"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="multi-agyw.html"><a href="multi-agyw.html#data"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="multi-agyw.html"><a href="multi-agyw.html#model-for-risk-group-proportions"><i class="fa fa-check"></i><b>4.3</b> Model for risk group proportions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multi-agyw.html"><a href="multi-agyw.html#st-multinomial"><i class="fa fa-check"></i><b>4.3.1</b> Spatio-temporal multinomial logistic regression</a></li>
<li class="chapter" data-level="4.3.2" data-path="multi-agyw.html"><a href="multi-agyw.html#s-logistic"><i class="fa fa-check"></i><b>4.3.2</b> Spatial logistic regression</a></li>
<li class="chapter" data-level="4.3.3" data-path="multi-agyw.html"><a href="multi-agyw.html#coverage-assessment"><i class="fa fa-check"></i><b>4.3.3</b> Coverage assessment</a></li>
<li class="chapter" data-level="4.3.4" data-path="multi-agyw.html"><a href="multi-agyw.html#female-sex-worker-population-size-adjustment"><i class="fa fa-check"></i><b>4.3.4</b> Female sex worker population size adjustment</a></li>
<li class="chapter" data-level="4.3.5" data-path="multi-agyw.html"><a href="multi-agyw.html#results-2"><i class="fa fa-check"></i><b>4.3.5</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multi-agyw.html"><a href="multi-agyw.html#prevalence-and-incidence-by-risk-group"><i class="fa fa-check"></i><b>4.4</b> Prevalence and incidence by risk group</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="multi-agyw.html"><a href="multi-agyw.html#disaggregation-of-naomi-estimates"><i class="fa fa-check"></i><b>4.4.1</b> Disaggregation of Naomi estimates</a></li>
<li class="chapter" data-level="4.4.2" data-path="multi-agyw.html"><a href="multi-agyw.html#expected-new-infections-reached"><i class="fa fa-check"></i><b>4.4.2</b> Expected new infections reached</a></li>
<li class="chapter" data-level="4.4.3" data-path="multi-agyw.html"><a href="multi-agyw.html#results-3"><i class="fa fa-check"></i><b>4.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="multi-agyw.html"><a href="multi-agyw.html#discussion-1"><i class="fa fa-check"></i><b>4.5</b> Discussion</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="multi-agyw.html"><a href="multi-agyw.html#limitations-1"><i class="fa fa-check"></i><b>4.5.1</b> Limitations</a></li>
<li class="chapter" data-level="4.5.2" data-path="multi-agyw.html"><a href="multi-agyw.html#conclusion-1"><i class="fa fa-check"></i><b>4.5.2</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="naomi-aghq.html"><a href="naomi-aghq.html"><i class="fa fa-check"></i><b>5</b> Fast approximate Bayesian inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#background-3"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#the-naomi-model"><i class="fa fa-check"></i><b>5.2</b> The Naomi model</a></li>
<li class="chapter" data-level="5.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#adaptive-gauss-hermite-quadrature"><i class="fa fa-check"></i><b>5.3</b> Adaptive Gauss-Hermite quadrature</a></li>
<li class="chapter" data-level="5.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#malawi-case-study"><i class="fa fa-check"></i><b>5.4</b> Malawi case-study</a></li>
<li class="chapter" data-level="5.5" data-path="naomi-aghq.html"><a href="naomi-aghq.html#discussion-2"><i class="fa fa-check"></i><b>5.5</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>6</b> Future work and conclusions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="conclusions.html"><a href="conclusions.html#future-work"><i class="fa fa-check"></i><b>6.1</b> Future work</a></li>
<li class="chapter" data-level="6.2" data-path="conclusions.html"><a href="conclusions.html#conclusions-1"><i class="fa fa-check"></i><b>6.2</b> Conclusions</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="the-first-appendix.html"><a href="the-first-appendix.html"><i class="fa fa-check"></i><b>A</b> The First Appendix</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p>Methods and applications of Bayesian spatio-temporal statistics for small-area estimation of HIV indicators</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="naomi-aghq" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Fast approximate Bayesian inference<a href="naomi-aghq.html#naomi-aghq" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- For PDF output, include these two LaTeX commands after unnumbered chapter headings, otherwise the mini table of contents and the running header will show the previous chapter -->
<p>In this chapter I describe a novel Bayesian inference method I developed with the aim of facilitating fast and accurate inference for the Naomi small-area estimation model.
This work builds on that of others, including <span class="citation">Håvard Rue, Martino, and Chopin (<a href="#ref-rue2009approximate">2009</a>)</span>, <span class="citation">Kristensen et al. (<a href="#ref-kristensen2016tmb">2016</a>)</span> and <span class="citation">Stringer, Brown, and Stafford (<a href="#ref-stringer2021fast">2021</a>)</span>.
I began working on this project in 2020, but did not make significant progress until I read Alex Stringer’s work.
We later began collaborating, including Alex supervising my visit to the University of Waterloo in 2022.</p>
<p>Code for the analysis in this chapter is available from <a href="https://github.com/athowes/elgm-inf"><code>athowes/naomi-aghq</code></a> and supported by the R package <a href="https://athowes.github.io/inf.utils"><code>inf.utils</code></a>.
Include an edited version of the corresponding paper here.</p>
<div id="background-3" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Background<a href="naomi-aghq.html#background-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="the-naomi-model" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> The Naomi model<a href="naomi-aghq.html#the-naomi-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="adaptive-gauss-hermite-quadrature" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Adaptive Gauss-Hermite quadrature<a href="naomi-aghq.html#adaptive-gauss-hermite-quadrature" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="malawi-case-study" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Malawi case-study<a href="naomi-aghq.html#malawi-case-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="discussion-2" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Discussion<a href="naomi-aghq.html#discussion-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-kristensen2016tmb" class="csl-entry">
Kristensen, Kasper, Anders Nielsen, Casper W Berg, Hans Skaug, Bradley M Bell, et al. 2016. <span>“TMB: Automatic Differentiation and Laplace Approximation.”</span> <em>Journal of Statistical Software</em> 70 (i05).
</div>
<div id="ref-rue2009approximate" class="csl-entry">
Rue, Håvard, Sara Martino, and Nicolas Chopin. 2009. <span>“<span class="nocase">Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 71 (2): 319–92.
</div>
<div id="ref-stringer2021fast" class="csl-entry">
Stringer, Alex, Patrick Brown, and Jamie Stafford. 2021. <span>“Fast, Scalable Approximations to Posterior Distributions in Extended Latent Gaussian Models.”</span> <em>arXiv Preprint arXiv:2103.07425</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multi-agyw.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ulyngs/oxforddown/tree/master/05-naomi-aghq.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
