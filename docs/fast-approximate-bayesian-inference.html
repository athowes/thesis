<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>C Fast approximate Bayesian inference | Bayesian spatio-temporal methods for small-area estimation of HIV indicators</title>
  <meta name="description" content="C Fast approximate Bayesian inference | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="C Fast approximate Bayesian inference | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="C Fast approximate Bayesian inference | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  
  
  

<meta name="author" content="Adam Howes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-model-for-risk-group-proportions.html"/>

<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="templates/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#abbreviations"><i class="fa fa-check"></i>Abbreviations</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#notations"><i class="fa fa-check"></i>Notations</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#chapter-overview"><i class="fa fa-check"></i><b>1.1</b> Chapter overview</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hiv-aids.html"><a href="hiv-aids.html"><i class="fa fa-check"></i><b>2</b> The HIV/AIDS epidemic</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hiv-aids.html"><a href="hiv-aids.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="hiv-aids.html"><a href="hiv-aids.html#surveillance"><i class="fa fa-check"></i><b>2.2</b> HIV surveillance</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="hiv-aids.html"><a href="hiv-aids.html#hiv-data"><i class="fa fa-check"></i><b>2.2.1</b> Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="hiv-aids.html"><a href="hiv-aids.html#challenges"><i class="fa fa-check"></i><b>2.2.2</b> Challenges</a></li>
<li class="chapter" data-level="2.2.3" data-path="hiv-aids.html"><a href="hiv-aids.html#statistical-approaches"><i class="fa fa-check"></i><b>2.2.3</b> Statistical approaches</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayes-st.html"><a href="bayes-st.html"><i class="fa fa-check"></i><b>3</b> Bayesian spatio-temporal statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-statistics"><i class="fa fa-check"></i><b>3.1</b> Bayesian statistics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-modelling"><i class="fa fa-check"></i><b>3.1.1</b> Bayesian modelling</a></li>
<li class="chapter" data-level="3.1.2" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-computation"><i class="fa fa-check"></i><b>3.1.2</b> Bayesian computation</a></li>
<li class="chapter" data-level="3.1.3" data-path="bayes-st.html"><a href="bayes-st.html#interplay-between-modelling-and-computation"><i class="fa fa-check"></i><b>3.1.3</b> Interplay between modelling and computation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bayes-st.html"><a href="bayes-st.html#st-statistics"><i class="fa fa-check"></i><b>3.2</b> Spatio-temporal statistics</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="bayes-st.html"><a href="bayes-st.html#properties"><i class="fa fa-check"></i><b>3.2.1</b> Properties of spatio-temporal data</a></li>
<li class="chapter" data-level="3.2.2" data-path="bayes-st.html"><a href="bayes-st.html#small-area-estimation"><i class="fa fa-check"></i><b>3.2.2</b> Small-area estimation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="bayes-st.html"><a href="bayes-st.html#model-structure"><i class="fa fa-check"></i><b>3.3</b> Model structure</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="bayes-st.html"><a href="bayes-st.html#linear-model"><i class="fa fa-check"></i><b>3.3.1</b> Linear model</a></li>
<li class="chapter" data-level="3.3.2" data-path="bayes-st.html"><a href="bayes-st.html#generalised-linear-model"><i class="fa fa-check"></i><b>3.3.2</b> Generalised linear model</a></li>
<li class="chapter" data-level="3.3.3" data-path="bayes-st.html"><a href="bayes-st.html#generalised-linear-mixed-effects-model"><i class="fa fa-check"></i><b>3.3.3</b> Generalised linear mixed effects model</a></li>
<li class="chapter" data-level="3.3.4" data-path="bayes-st.html"><a href="bayes-st.html#lgm"><i class="fa fa-check"></i><b>3.3.4</b> Latent Gaussian model</a></li>
<li class="chapter" data-level="3.3.5" data-path="bayes-st.html"><a href="bayes-st.html#elgm"><i class="fa fa-check"></i><b>3.3.5</b> Extended latent Gaussian model</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bayes-st.html"><a href="bayes-st.html#model-comparison"><i class="fa fa-check"></i><b>3.4</b> Model comparison</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="bayes-st.html"><a href="bayes-st.html#information-criteria"><i class="fa fa-check"></i><b>3.4.1</b> Information criteria</a></li>
<li class="chapter" data-level="3.4.2" data-path="bayes-st.html"><a href="bayes-st.html#cross-validation"><i class="fa fa-check"></i><b>3.4.2</b> Cross-validation</a></li>
<li class="chapter" data-level="3.4.3" data-path="bayes-st.html"><a href="bayes-st.html#scoring-rules"><i class="fa fa-check"></i><b>3.4.3</b> Scoring rules</a></li>
<li class="chapter" data-level="3.4.4" data-path="bayes-st.html"><a href="bayes-st.html#bayes-factors"><i class="fa fa-check"></i><b>3.4.4</b> Bayes factors</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="bayes-st.html"><a href="bayes-st.html#survey"><i class="fa fa-check"></i><b>3.5</b> Survey methods</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="bayes-st.html"><a href="bayes-st.html#survey-notation-and-key-terms"><i class="fa fa-check"></i><b>3.5.1</b> Survey notation and key terms</a></li>
<li class="chapter" data-level="3.5.2" data-path="bayes-st.html"><a href="bayes-st.html#survey-design"><i class="fa fa-check"></i><b>3.5.2</b> Survey design</a></li>
<li class="chapter" data-level="3.5.3" data-path="bayes-st.html"><a href="bayes-st.html#survey-analysis"><i class="fa fa-check"></i><b>3.5.3</b> Survey analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="beyond-borders.html"><a href="beyond-borders.html"><i class="fa fa-check"></i><b>4</b> Models for areal spatial structure</a>
<ul>
<li class="chapter" data-level="4.1" data-path="beyond-borders.html"><a href="beyond-borders.html#adjacency-models"><i class="fa fa-check"></i><b>4.1</b> Models based on adjacency</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="beyond-borders.html"><a href="beyond-borders.html#besag"><i class="fa fa-check"></i><b>4.1.1</b> The Besag model</a></li>
<li class="chapter" data-level="4.1.2" data-path="beyond-borders.html"><a href="beyond-borders.html#best-practises-for-the-besag-model"><i class="fa fa-check"></i><b>4.1.2</b> Best practises for the Besag model</a></li>
<li class="chapter" data-level="4.1.3" data-path="beyond-borders.html"><a href="beyond-borders.html#concerns"><i class="fa fa-check"></i><b>4.1.3</b> Concerns about the Besag model</a></li>
<li class="chapter" data-level="4.1.4" data-path="beyond-borders.html"><a href="beyond-borders.html#weighted-icar-models"><i class="fa fa-check"></i><b>4.1.4</b> Weighted ICAR models</a></li>
<li class="chapter" data-level="4.1.5" data-path="beyond-borders.html"><a href="beyond-borders.html#bym2"><i class="fa fa-check"></i><b>4.1.5</b> The reparameterised Besag-York-Mollié model</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="beyond-borders.html"><a href="beyond-borders.html#kernel-models"><i class="fa fa-check"></i><b>4.2</b> Models using kernels</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="beyond-borders.html"><a href="beyond-borders.html#centroid-kernel"><i class="fa fa-check"></i><b>4.2.1</b> Centroid kernel</a></li>
<li class="chapter" data-level="4.2.2" data-path="beyond-borders.html"><a href="beyond-borders.html#integrated-kernel"><i class="fa fa-check"></i><b>4.2.2</b> Integrated kernel</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="beyond-borders.html"><a href="beyond-borders.html#simulation-study"><i class="fa fa-check"></i><b>4.3</b> Simulation study</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="beyond-borders.html"><a href="beyond-borders.html#synthetic-data"><i class="fa fa-check"></i><b>4.3.1</b> Synthetic data</a></li>
<li class="chapter" data-level="4.3.2" data-path="beyond-borders.html"><a href="beyond-borders.html#inferential-models"><i class="fa fa-check"></i><b>4.3.2</b> Inferential models</a></li>
<li class="chapter" data-level="4.3.3" data-path="beyond-borders.html"><a href="beyond-borders.html#model-assessment"><i class="fa fa-check"></i><b>4.3.3</b> Model assessment</a></li>
<li class="chapter" data-level="4.3.4" data-path="beyond-borders.html"><a href="beyond-borders.html#results"><i class="fa fa-check"></i><b>4.3.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="beyond-borders.html"><a href="beyond-borders.html#hiv-study"><i class="fa fa-check"></i><b>4.4</b> HIV prevalence study</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="beyond-borders.html"><a href="beyond-borders.html#household-survey-data"><i class="fa fa-check"></i><b>4.4.1</b> Household survey data</a></li>
<li class="chapter" data-level="4.4.2" data-path="beyond-borders.html"><a href="beyond-borders.html#inferential-models-1"><i class="fa fa-check"></i><b>4.4.2</b> Inferential models</a></li>
<li class="chapter" data-level="4.4.3" data-path="beyond-borders.html"><a href="beyond-borders.html#model-comparison-1"><i class="fa fa-check"></i><b>4.4.3</b> Model comparison</a></li>
<li class="chapter" data-level="4.4.4" data-path="beyond-borders.html"><a href="beyond-borders.html#results-1"><i class="fa fa-check"></i><b>4.4.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="beyond-borders.html"><a href="beyond-borders.html#discussion"><i class="fa fa-check"></i><b>4.5</b> Discussion</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="beyond-borders.html"><a href="beyond-borders.html#modelling"><i class="fa fa-check"></i><b>4.5.1</b> Modelling</a></li>
<li class="chapter" data-level="4.5.2" data-path="beyond-borders.html"><a href="beyond-borders.html#model-selection"><i class="fa fa-check"></i><b>4.5.2</b> Model selection</a></li>
<li class="chapter" data-level="4.5.3" data-path="beyond-borders.html"><a href="beyond-borders.html#inference-1"><i class="fa fa-check"></i><b>4.5.3</b> Inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multi-agyw.html"><a href="multi-agyw.html"><i class="fa fa-check"></i><b>5</b> A model for risk group proportions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multi-agyw.html"><a href="multi-agyw.html#background-1"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="multi-agyw.html"><a href="multi-agyw.html#data"><i class="fa fa-check"></i><b>5.2</b> Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multi-agyw.html"><a href="multi-agyw.html#behavioural-data-from-household-surveys"><i class="fa fa-check"></i><b>5.2.1</b> Behavioural data from household surveys</a></li>
<li class="chapter" data-level="5.2.2" data-path="multi-agyw.html"><a href="multi-agyw.html#other-data"><i class="fa fa-check"></i><b>5.2.2</b> Other data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multi-agyw.html"><a href="multi-agyw.html#model-for-risk-group-proportions"><i class="fa fa-check"></i><b>5.3</b> Model for risk group proportions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="multi-agyw.html"><a href="multi-agyw.html#st-multinomial"><i class="fa fa-check"></i><b>5.3.1</b> Spatio-temporal multinomial logistic regression</a></li>
<li class="chapter" data-level="5.3.2" data-path="multi-agyw.html"><a href="multi-agyw.html#s-logistic"><i class="fa fa-check"></i><b>5.3.2</b> Spatial logistic regression</a></li>
<li class="chapter" data-level="5.3.3" data-path="multi-agyw.html"><a href="multi-agyw.html#female-sex-worker-population-size-adjustment"><i class="fa fa-check"></i><b>5.3.3</b> Female sex worker population size adjustment</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multi-agyw.html"><a href="multi-agyw.html#prevalence-and-incidence-by-risk-group"><i class="fa fa-check"></i><b>5.4</b> Prevalence and incidence by risk group</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multi-agyw.html"><a href="multi-agyw.html#disaggregation-of-naomi-prevalence-estimates"><i class="fa fa-check"></i><b>5.4.1</b> Disaggregation of Naomi prevalence estimates</a></li>
<li class="chapter" data-level="5.4.2" data-path="multi-agyw.html"><a href="multi-agyw.html#disaggregation-of-naomi-incidence-estimates"><i class="fa fa-check"></i><b>5.4.2</b> Disaggregation of Naomi incidence estimates</a></li>
<li class="chapter" data-level="5.4.3" data-path="multi-agyw.html"><a href="multi-agyw.html#expected-new-infections-reached"><i class="fa fa-check"></i><b>5.4.3</b> Expected new infections reached</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multi-agyw.html"><a href="multi-agyw.html#results-2"><i class="fa fa-check"></i><b>5.5</b> Results</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="multi-agyw.html"><a href="multi-agyw.html#model-for-risk-group-proportions-1"><i class="fa fa-check"></i><b>5.5.1</b> Model for risk group proportions</a></li>
<li class="chapter" data-level="5.5.2" data-path="multi-agyw.html"><a href="multi-agyw.html#prevalence-and-incidence-by-risk-group-1"><i class="fa fa-check"></i><b>5.5.2</b> Prevalence and incidence by risk group</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="multi-agyw.html"><a href="multi-agyw.html#discussion-1"><i class="fa fa-check"></i><b>5.6</b> Discussion</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="multi-agyw.html"><a href="multi-agyw.html#limitations"><i class="fa fa-check"></i><b>5.6.1</b> Limitations</a></li>
<li class="chapter" data-level="5.6.2" data-path="multi-agyw.html"><a href="multi-agyw.html#conclusion"><i class="fa fa-check"></i><b>5.6.2</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="naomi-aghq.html"><a href="naomi-aghq.html"><i class="fa fa-check"></i><b>6</b> Fast approximate Bayesian inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi-inference"><i class="fa fa-check"></i><b>6.1</b> Inference methods and software</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#la"><i class="fa fa-check"></i><b>6.1.1</b> The Laplace approximation</a></li>
<li class="chapter" data-level="6.1.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#quadrature"><i class="fa fa-check"></i><b>6.1.2</b> Quadrature</a></li>
<li class="chapter" data-level="6.1.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#inla"><i class="fa fa-check"></i><b>6.1.3</b> Integrated nested Laplace approximation</a></li>
<li class="chapter" data-level="6.1.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#software"><i class="fa fa-check"></i><b>6.1.4</b> Software</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#universal"><i class="fa fa-check"></i><b>6.2</b> A universal INLA implementation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#epil"><i class="fa fa-check"></i><b>6.2.1</b> Epilepsy GLMM</a></li>
<li class="chapter" data-level="6.2.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#loaloa"><i class="fa fa-check"></i><b>6.2.2</b> Loa loa ELGM</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi"><i class="fa fa-check"></i><b>6.3</b> The Naomi model</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi-model"><i class="fa fa-check"></i><b>6.3.1</b> Model structure</a></li>
<li class="chapter" data-level="6.3.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi-elgm"><i class="fa fa-check"></i><b>6.3.2</b> Naomi as an ELGM</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#pca-aghq"><i class="fa fa-check"></i><b>6.4</b> AGHQ in moderate dimensions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#aghq-with-variable-levels"><i class="fa fa-check"></i><b>6.4.1</b> AGHQ with variable levels</a></li>
<li class="chapter" data-level="6.4.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#principal-components-analysis"><i class="fa fa-check"></i><b>6.4.2</b> Principal components analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="naomi-aghq.html"><a href="naomi-aghq.html#malawi"><i class="fa fa-check"></i><b>6.5</b> Malawi case-study</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#naomi-nuts"><i class="fa fa-check"></i><b>6.5.1</b> NUTS convergence and suitability</a></li>
<li class="chapter" data-level="6.5.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#use-of-pca-aghq"><i class="fa fa-check"></i><b>6.5.2</b> Use of PCA-AGHQ</a></li>
<li class="chapter" data-level="6.5.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#inference-comparison"><i class="fa fa-check"></i><b>6.5.3</b> Inference comparison</a></li>
<li class="chapter" data-level="6.5.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#exceedance-probabilities"><i class="fa fa-check"></i><b>6.5.4</b> Exceedance probabilities</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="naomi-aghq.html"><a href="naomi-aghq.html#discussion-2"><i class="fa fa-check"></i><b>6.6</b> Discussion</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#a-universal-inla-implementation"><i class="fa fa-check"></i><b>6.6.1</b> A universal INLA implementation</a></li>
<li class="chapter" data-level="6.6.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#pca-aghq-with-application-to-inla-for-naomi"><i class="fa fa-check"></i><b>6.6.2</b> PCA-AGHQ with application to INLA for Naomi</a></li>
<li class="chapter" data-level="6.6.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#suggestions-for-future-work"><i class="fa fa-check"></i><b>6.6.3</b> Suggestions for future work</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>7</b> Conclusions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="conclusions.html"><a href="conclusions.html#contributions"><i class="fa fa-check"></i><b>7.1</b> Contributions</a></li>
<li class="chapter" data-level="7.2" data-path="conclusions.html"><a href="conclusions.html#limitations-1"><i class="fa fa-check"></i><b>7.2</b> Limitations</a></li>
<li class="chapter" data-level="7.3" data-path="conclusions.html"><a href="conclusions.html#future-work"><i class="fa fa-check"></i><b>7.3</b> Future work</a></li>
<li class="chapter" data-level="7.4" data-path="conclusions.html"><a href="conclusions.html#broader-reflections"><i class="fa fa-check"></i><b>7.4</b> Broader reflections</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html"><i class="fa fa-check"></i><b>A</b> Models for areal spatial structure</a>
<ul>
<li class="chapter" data-level="A.1" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#aghq-nuts"><i class="fa fa-check"></i><b>A.1</b> Comparison of AGHQ to NUTS</a></li>
<li class="chapter" data-level="A.2" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#lengthscale-prior"><i class="fa fa-check"></i><b>A.2</b> Lengthscale prior sensitivity</a></li>
<li class="chapter" data-level="A.3" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#simulation-appendix"><i class="fa fa-check"></i><b>A.3</b> Simulation study</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#lengthscale"><i class="fa fa-check"></i><b>A.3.1</b> Lengthscale recovery</a></li>
<li class="chapter" data-level="A.3.2" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#bym2-proportion"><i class="fa fa-check"></i><b>A.3.2</b> BYM2 proportion</a></li>
<li class="chapter" data-level="A.3.3" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#mean-squared-error"><i class="fa fa-check"></i><b>A.3.3</b> Mean squared error</a></li>
<li class="chapter" data-level="A.3.4" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#continuous-ranked-probability-score"><i class="fa fa-check"></i><b>A.3.4</b> Continuous ranked probability score</a></li>
<li class="chapter" data-level="A.3.5" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#calibration"><i class="fa fa-check"></i><b>A.3.5</b> Calibration</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#hiv-appendix"><i class="fa fa-check"></i><b>A.4</b> HIV study</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#lengthscale-1"><i class="fa fa-check"></i><b>A.4.1</b> Lengthscale</a></li>
<li class="chapter" data-level="A.4.2" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#bym2-proportion-1"><i class="fa fa-check"></i><b>A.4.2</b> BYM2 proportion</a></li>
<li class="chapter" data-level="A.4.3" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#estimates-1"><i class="fa fa-check"></i><b>A.4.3</b> Estimates</a></li>
<li class="chapter" data-level="A.4.4" data-path="models-for-areal-spatial-structure.html"><a href="models-for-areal-spatial-structure.html#cross-validation-1"><i class="fa fa-check"></i><b>A.4.4</b> Cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html"><i class="fa fa-check"></i><b>B</b> A model for risk group proportions</a>
<ul>
<li class="chapter" data-level="B.1" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#the-global-aids-strategy"><i class="fa fa-check"></i><b>B.1</b> The Global AIDS Strategy</a></li>
<li class="chapter" data-level="B.2" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#household-survey-data-1"><i class="fa fa-check"></i><b>B.2</b> Household survey data</a></li>
<li class="chapter" data-level="B.3" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#spatial-analysis-levels"><i class="fa fa-check"></i><b>B.3</b> Spatial analysis levels</a></li>
<li class="chapter" data-level="B.4" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#survey-questions"><i class="fa fa-check"></i><b>B.4</b> Survey questions and risk group allocation</a></li>
<li class="chapter" data-level="B.5" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#additional-figures"><i class="fa fa-check"></i><b>B.5</b> Additional figures</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html"><i class="fa fa-check"></i><b>C</b> Fast approximate Bayesian inference</a>
<ul>
<li class="chapter" data-level="C.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#epilepsy-example"><i class="fa fa-check"></i><b>C.1</b> Epilepsy example</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#tmb-epil"><i class="fa fa-check"></i><b>C.1.1</b> <code>TMB</code> C++ template</a></li>
<li class="chapter" data-level="C.1.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#tmb-modified-epil"><i class="fa fa-check"></i><b>C.1.2</b> Modified <code>TMB</code> C++ template</a></li>
<li class="chapter" data-level="C.1.3" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#stan-epil"><i class="fa fa-check"></i><b>C.1.3</b> <code>Stan</code> C++ template</a></li>
<li class="chapter" data-level="C.1.4" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#nuts-convergence-and-suitability"><i class="fa fa-check"></i><b>C.1.4</b> NUTS convergence and suitability</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#loa-loa-example"><i class="fa fa-check"></i><b>C.2</b> Loa loa example</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#nuts-convergence-and-suitability-1"><i class="fa fa-check"></i><b>C.2.1</b> NUTS convergence and suitability</a></li>
<li class="chapter" data-level="C.2.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#inference-comparison-1"><i class="fa fa-check"></i><b>C.2.2</b> Inference comparison</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-math"><i class="fa fa-check"></i><b>C.3</b> Simplified Naomi model description</a>
<ul>
<li class="chapter" data-level="C.3.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-process"><i class="fa fa-check"></i><b>C.3.1</b> Process specification</a></li>
<li class="chapter" data-level="C.3.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-likelihood"><i class="fa fa-check"></i><b>C.3.2</b> Additional likelihood specification</a></li>
<li class="chapter" data-level="C.3.3" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-identifiability"><i class="fa fa-check"></i><b>C.3.3</b> Identifiability constraints</a></li>
<li class="chapter" data-level="C.3.4" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#naomi-implementation"><i class="fa fa-check"></i><b>C.3.4</b> Implementation</a></li>
</ul></li>
<li class="chapter" data-level="C.4" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#nuts-convergence-and-suitability-2"><i class="fa fa-check"></i><b>C.4</b> NUTS convergence and suitability</a></li>
<li class="chapter" data-level="C.5" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#use-of-pca-aghq-1"><i class="fa fa-check"></i><b>C.5</b> Use of PCA-AGHQ</a></li>
<li class="chapter" data-level="C.6" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#normalising-constant-estimation"><i class="fa fa-check"></i><b>C.6</b> Normalising constant estimation</a></li>
<li class="chapter" data-level="C.7" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#inference-comparison-2"><i class="fa fa-check"></i><b>C.7</b> Inference comparison</a>
<ul>
<li class="chapter" data-level="C.7.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#point-estimates-1"><i class="fa fa-check"></i><b>C.7.1</b> Point estimates</a></li>
<li class="chapter" data-level="C.7.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#distributional-quantities-1"><i class="fa fa-check"></i><b>C.7.2</b> Distributional quantities</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p>Bayesian spatio-temporal methods for small-area estimation of HIV indicators</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fast-approximate-bayesian-inference" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">C</span> Fast approximate Bayesian inference<a href="fast-approximate-bayesian-inference.html#fast-approximate-bayesian-inference" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="epilepsy-example" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">C.1</span> Epilepsy example<a href="fast-approximate-bayesian-inference.html#epilepsy-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="tmb-epil" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">C.1.1</span> <code>TMB</code> C++ template<a href="fast-approximate-bayesian-inference.html#tmb-epil" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="fast-approximate-bayesian-inference.html#cb21-1" tabindex="-1"></a><span class="co">// epil.cpp</span></span>
<span id="cb21-2"><a href="fast-approximate-bayesian-inference.html#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="fast-approximate-bayesian-inference.html#cb21-3" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;TMB.hpp&gt;</span></span>
<span id="cb21-4"><a href="fast-approximate-bayesian-inference.html#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="fast-approximate-bayesian-inference.html#cb21-5" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> Type<span class="op">&gt;</span></span>
<span id="cb21-6"><a href="fast-approximate-bayesian-inference.html#cb21-6" tabindex="-1"></a>Type objective_function<span class="op">&lt;</span>Type<span class="op">&gt;::</span><span class="kw">operator</span><span class="op">()()</span></span>
<span id="cb21-7"><a href="fast-approximate-bayesian-inference.html#cb21-7" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb21-8"><a href="fast-approximate-bayesian-inference.html#cb21-8" tabindex="-1"></a>  DATA_INTEGER<span class="op">(</span>N<span class="op">);</span></span>
<span id="cb21-9"><a href="fast-approximate-bayesian-inference.html#cb21-9" tabindex="-1"></a>  DATA_INTEGER<span class="op">(</span>J<span class="op">);</span></span>
<span id="cb21-10"><a href="fast-approximate-bayesian-inference.html#cb21-10" tabindex="-1"></a>  DATA_INTEGER<span class="op">(</span>K<span class="op">);</span></span>
<span id="cb21-11"><a href="fast-approximate-bayesian-inference.html#cb21-11" tabindex="-1"></a>  DATA_MATRIX<span class="op">(</span>X<span class="op">);</span></span>
<span id="cb21-12"><a href="fast-approximate-bayesian-inference.html#cb21-12" tabindex="-1"></a>  DATA_VECTOR<span class="op">(</span>y<span class="op">);</span></span>
<span id="cb21-13"><a href="fast-approximate-bayesian-inference.html#cb21-13" tabindex="-1"></a>  DATA_MATRIX<span class="op">(</span>E<span class="op">);</span> <span class="co">// Epsilon matrix</span></span>
<span id="cb21-14"><a href="fast-approximate-bayesian-inference.html#cb21-14" tabindex="-1"></a>  </span>
<span id="cb21-15"><a href="fast-approximate-bayesian-inference.html#cb21-15" tabindex="-1"></a>  PARAMETER_VECTOR<span class="op">(</span>beta<span class="op">);</span></span>
<span id="cb21-16"><a href="fast-approximate-bayesian-inference.html#cb21-16" tabindex="-1"></a>  PARAMETER_VECTOR<span class="op">(</span>epsilon<span class="op">);</span></span>
<span id="cb21-17"><a href="fast-approximate-bayesian-inference.html#cb21-17" tabindex="-1"></a>  PARAMETER_VECTOR<span class="op">(</span>nu<span class="op">);</span></span>
<span id="cb21-18"><a href="fast-approximate-bayesian-inference.html#cb21-18" tabindex="-1"></a>  PARAMETER<span class="op">(</span>l_tau_epsilon<span class="op">);</span></span>
<span id="cb21-19"><a href="fast-approximate-bayesian-inference.html#cb21-19" tabindex="-1"></a>  PARAMETER<span class="op">(</span>l_tau_nu<span class="op">);</span></span>
<span id="cb21-20"><a href="fast-approximate-bayesian-inference.html#cb21-20" tabindex="-1"></a>  </span>
<span id="cb21-21"><a href="fast-approximate-bayesian-inference.html#cb21-21" tabindex="-1"></a>  Type tau_epsilon <span class="op">=</span> exp<span class="op">(</span>l_tau_epsilon<span class="op">);</span></span>
<span id="cb21-22"><a href="fast-approximate-bayesian-inference.html#cb21-22" tabindex="-1"></a>  Type tau_nu <span class="op">=</span> exp<span class="op">(</span>l_tau_nu<span class="op">);</span></span>
<span id="cb21-23"><a href="fast-approximate-bayesian-inference.html#cb21-23" tabindex="-1"></a>  Type sigma_epsilon <span class="op">=</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">/</span> tau_epsilon<span class="op">);</span></span>
<span id="cb21-24"><a href="fast-approximate-bayesian-inference.html#cb21-24" tabindex="-1"></a>  Type sigma_nu <span class="op">=</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">/</span> tau_nu<span class="op">);</span></span>
<span id="cb21-25"><a href="fast-approximate-bayesian-inference.html#cb21-25" tabindex="-1"></a>  vector<span class="op">&lt;</span>Type<span class="op">&gt;</span> eta<span class="op">(</span>X <span class="op">*</span> beta <span class="op">+</span> nu <span class="op">+</span> E <span class="op">*</span> epsilon<span class="op">);</span> <span class="co">// Linear predictor</span></span>
<span id="cb21-26"><a href="fast-approximate-bayesian-inference.html#cb21-26" tabindex="-1"></a>  vector<span class="op">&lt;</span>Type<span class="op">&gt;</span> lambda<span class="op">(</span>exp<span class="op">(</span>eta<span class="op">));</span></span>
<span id="cb21-27"><a href="fast-approximate-bayesian-inference.html#cb21-27" tabindex="-1"></a>  </span>
<span id="cb21-28"><a href="fast-approximate-bayesian-inference.html#cb21-28" tabindex="-1"></a>  Type nll<span class="op">;</span></span>
<span id="cb21-29"><a href="fast-approximate-bayesian-inference.html#cb21-29" tabindex="-1"></a>  nll <span class="op">=</span> Type<span class="op">(</span><span class="fl">0.0</span><span class="op">);</span></span>
<span id="cb21-30"><a href="fast-approximate-bayesian-inference.html#cb21-30" tabindex="-1"></a>  </span>
<span id="cb21-31"><a href="fast-approximate-bayesian-inference.html#cb21-31" tabindex="-1"></a>  <span class="co">// Note: dgamma() is parameterised as (shape, scale)</span></span>
<span id="cb21-32"><a href="fast-approximate-bayesian-inference.html#cb21-32" tabindex="-1"></a>  <span class="co">// R-INLA is parameterised as (shape, rate)</span></span>
<span id="cb21-33"><a href="fast-approximate-bayesian-inference.html#cb21-33" tabindex="-1"></a>  nll <span class="op">-=</span> dlgamma<span class="op">(</span>l_tau_epsilon<span class="op">,</span> Type<span class="op">(</span><span class="fl">0.001</span><span class="op">),</span> Type<span class="op">(</span><span class="fl">1.0</span> <span class="op">/</span> <span class="fl">0.001</span><span class="op">),</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb21-34"><a href="fast-approximate-bayesian-inference.html#cb21-34" tabindex="-1"></a>  nll <span class="op">-=</span> dlgamma<span class="op">(</span>l_tau_nu<span class="op">,</span> Type<span class="op">(</span><span class="fl">0.001</span><span class="op">),</span> Type<span class="op">(</span><span class="fl">1.0</span> <span class="op">/</span> <span class="fl">0.001</span><span class="op">),</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb21-35"><a href="fast-approximate-bayesian-inference.html#cb21-35" tabindex="-1"></a>  nll <span class="op">-=</span> dnorm<span class="op">(</span>epsilon<span class="op">,</span> Type<span class="op">(</span><span class="dv">0</span><span class="op">),</span> sigma_epsilon<span class="op">,</span> <span class="kw">true</span><span class="op">).</span>sum<span class="op">();</span></span>
<span id="cb21-36"><a href="fast-approximate-bayesian-inference.html#cb21-36" tabindex="-1"></a>  nll <span class="op">-=</span> dnorm<span class="op">(</span>nu<span class="op">,</span> Type<span class="op">(</span><span class="dv">0</span><span class="op">),</span> sigma_nu<span class="op">,</span> <span class="kw">true</span><span class="op">).</span>sum<span class="op">();</span></span>
<span id="cb21-37"><a href="fast-approximate-bayesian-inference.html#cb21-37" tabindex="-1"></a>  nll <span class="op">-=</span> dnorm<span class="op">(</span>beta<span class="op">,</span> Type<span class="op">(</span><span class="dv">0</span><span class="op">),</span> Type<span class="op">(</span><span class="dv">100</span><span class="op">),</span> <span class="kw">true</span><span class="op">).</span>sum<span class="op">();</span></span>
<span id="cb21-38"><a href="fast-approximate-bayesian-inference.html#cb21-38" tabindex="-1"></a>  </span>
<span id="cb21-39"><a href="fast-approximate-bayesian-inference.html#cb21-39" tabindex="-1"></a>  nll <span class="op">-=</span> dpois<span class="op">(</span>y<span class="op">,</span> lambda<span class="op">,</span> <span class="kw">true</span><span class="op">).</span>sum<span class="op">();</span></span>
<span id="cb21-40"><a href="fast-approximate-bayesian-inference.html#cb21-40" tabindex="-1"></a>  </span>
<span id="cb21-41"><a href="fast-approximate-bayesian-inference.html#cb21-41" tabindex="-1"></a>  ADREPORT<span class="op">(</span>tau_epsilon<span class="op">);</span></span>
<span id="cb21-42"><a href="fast-approximate-bayesian-inference.html#cb21-42" tabindex="-1"></a>  ADREPORT<span class="op">(</span>tau_nu<span class="op">);</span></span>
<span id="cb21-43"><a href="fast-approximate-bayesian-inference.html#cb21-43" tabindex="-1"></a>  </span>
<span id="cb21-44"><a href="fast-approximate-bayesian-inference.html#cb21-44" tabindex="-1"></a>  <span class="cf">return</span><span class="op">(</span>nll<span class="op">);</span></span>
<span id="cb21-45"><a href="fast-approximate-bayesian-inference.html#cb21-45" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="tmb-modified-epil" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">C.1.2</span> Modified <code>TMB</code> C++ template<a href="fast-approximate-bayesian-inference.html#tmb-modified-epil" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="fast-approximate-bayesian-inference.html#cb22-1" tabindex="-1"></a><span class="co">// epil_modified.cpp</span></span>
<span id="cb22-2"><a href="fast-approximate-bayesian-inference.html#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="fast-approximate-bayesian-inference.html#cb22-3" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;TMB.hpp&gt;</span></span>
<span id="cb22-4"><a href="fast-approximate-bayesian-inference.html#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="fast-approximate-bayesian-inference.html#cb22-5" tabindex="-1"></a><span class="kw">template</span> <span class="op">&lt;</span><span class="kw">class</span> Type<span class="op">&gt;</span></span>
<span id="cb22-6"><a href="fast-approximate-bayesian-inference.html#cb22-6" tabindex="-1"></a>Type objective_function<span class="op">&lt;</span>Type<span class="op">&gt;::</span><span class="kw">operator</span><span class="op">()()</span></span>
<span id="cb22-7"><a href="fast-approximate-bayesian-inference.html#cb22-7" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb22-8"><a href="fast-approximate-bayesian-inference.html#cb22-8" tabindex="-1"></a>  DATA_INTEGER<span class="op">(</span>N<span class="op">);</span></span>
<span id="cb22-9"><a href="fast-approximate-bayesian-inference.html#cb22-9" tabindex="-1"></a>  DATA_INTEGER<span class="op">(</span>J<span class="op">);</span></span>
<span id="cb22-10"><a href="fast-approximate-bayesian-inference.html#cb22-10" tabindex="-1"></a>  DATA_INTEGER<span class="op">(</span>K<span class="op">);</span></span>
<span id="cb22-11"><a href="fast-approximate-bayesian-inference.html#cb22-11" tabindex="-1"></a>  DATA_MATRIX<span class="op">(</span>X<span class="op">);</span></span>
<span id="cb22-12"><a href="fast-approximate-bayesian-inference.html#cb22-12" tabindex="-1"></a>  DATA_VECTOR<span class="op">(</span>y<span class="op">);</span></span>
<span id="cb22-13"><a href="fast-approximate-bayesian-inference.html#cb22-13" tabindex="-1"></a>  DATA_MATRIX<span class="op">(</span>E<span class="op">);</span> <span class="co">// Epsilon matrix</span></span>
<span id="cb22-14"><a href="fast-approximate-bayesian-inference.html#cb22-14" tabindex="-1"></a>  </span>
<span id="cb22-15"><a href="fast-approximate-bayesian-inference.html#cb22-15" tabindex="-1"></a>  DATA_IVECTOR<span class="op">(</span>x_starts<span class="op">);</span>  <span class="co">// Start index of each subvector of x</span></span>
<span id="cb22-16"><a href="fast-approximate-bayesian-inference.html#cb22-16" tabindex="-1"></a>  DATA_IVECTOR<span class="op">(</span>x_lengths<span class="op">);</span> <span class="co">// Length of each subvector of x</span></span>
<span id="cb22-17"><a href="fast-approximate-bayesian-inference.html#cb22-17" tabindex="-1"></a>  DATA_INTEGER<span class="op">(</span>i<span class="op">);</span>         <span class="co">// Index i</span></span>
<span id="cb22-18"><a href="fast-approximate-bayesian-inference.html#cb22-18" tabindex="-1"></a>  </span>
<span id="cb22-19"><a href="fast-approximate-bayesian-inference.html#cb22-19" tabindex="-1"></a>  PARAMETER<span class="op">(</span>x_i<span class="op">);</span></span>
<span id="cb22-20"><a href="fast-approximate-bayesian-inference.html#cb22-20" tabindex="-1"></a>  PARAMETER_VECTOR<span class="op">(</span>x_minus_i<span class="op">);</span></span>
<span id="cb22-21"><a href="fast-approximate-bayesian-inference.html#cb22-21" tabindex="-1"></a>  </span>
<span id="cb22-22"><a href="fast-approximate-bayesian-inference.html#cb22-22" tabindex="-1"></a>  vector<span class="op">&lt;</span>Type<span class="op">&gt;</span> x<span class="op">(</span><span class="dv">301</span><span class="op">);</span></span>
<span id="cb22-23"><a href="fast-approximate-bayesian-inference.html#cb22-23" tabindex="-1"></a>  <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-24"><a href="fast-approximate-bayesian-inference.html#cb22-24" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">301</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb22-25"><a href="fast-approximate-bayesian-inference.html#cb22-25" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>j <span class="op">+</span> <span class="dv">1</span> <span class="op">==</span> i<span class="op">)</span> <span class="op">{</span> <span class="co">// +1 because C++ does zero-indexing</span></span>
<span id="cb22-26"><a href="fast-approximate-bayesian-inference.html#cb22-26" tabindex="-1"></a>      x<span class="op">(</span>j<span class="op">)</span> <span class="op">=</span> x_i<span class="op">;</span></span>
<span id="cb22-27"><a href="fast-approximate-bayesian-inference.html#cb22-27" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb22-28"><a href="fast-approximate-bayesian-inference.html#cb22-28" tabindex="-1"></a>      x<span class="op">(</span>j<span class="op">)</span> <span class="op">=</span> x_minus_i<span class="op">(</span>k<span class="op">);</span></span>
<span id="cb22-29"><a href="fast-approximate-bayesian-inference.html#cb22-29" tabindex="-1"></a>      k<span class="op">++;</span></span>
<span id="cb22-30"><a href="fast-approximate-bayesian-inference.html#cb22-30" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb22-31"><a href="fast-approximate-bayesian-inference.html#cb22-31" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb22-32"><a href="fast-approximate-bayesian-inference.html#cb22-32" tabindex="-1"></a>  </span>
<span id="cb22-33"><a href="fast-approximate-bayesian-inference.html#cb22-33" tabindex="-1"></a>  vector<span class="op">&lt;</span>Type<span class="op">&gt;</span> beta <span class="op">=</span> x<span class="op">.</span>segment<span class="op">(</span>x_starts<span class="op">(</span><span class="dv">0</span><span class="op">),</span> x_lengths<span class="op">(</span><span class="dv">0</span><span class="op">));</span></span>
<span id="cb22-34"><a href="fast-approximate-bayesian-inference.html#cb22-34" tabindex="-1"></a>  vector<span class="op">&lt;</span>Type<span class="op">&gt;</span> epsilon <span class="op">=</span> x<span class="op">.</span>segment<span class="op">(</span>x_starts<span class="op">(</span><span class="dv">1</span><span class="op">),</span> x_lengths<span class="op">(</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb22-35"><a href="fast-approximate-bayesian-inference.html#cb22-35" tabindex="-1"></a>  vector<span class="op">&lt;</span>Type<span class="op">&gt;</span> nu <span class="op">=</span> x<span class="op">.</span>segment<span class="op">(</span>x_starts<span class="op">(</span><span class="dv">2</span><span class="op">),</span> x_lengths<span class="op">(</span><span class="dv">2</span><span class="op">));</span></span>
<span id="cb22-36"><a href="fast-approximate-bayesian-inference.html#cb22-36" tabindex="-1"></a></span>
<span id="cb22-37"><a href="fast-approximate-bayesian-inference.html#cb22-37" tabindex="-1"></a>  PARAMETER<span class="op">(</span>l_tau_epsilon<span class="op">);</span></span>
<span id="cb22-38"><a href="fast-approximate-bayesian-inference.html#cb22-38" tabindex="-1"></a>  PARAMETER<span class="op">(</span>l_tau_nu<span class="op">);</span></span>
<span id="cb22-39"><a href="fast-approximate-bayesian-inference.html#cb22-39" tabindex="-1"></a>  </span>
<span id="cb22-40"><a href="fast-approximate-bayesian-inference.html#cb22-40" tabindex="-1"></a>  Type tau_epsilon <span class="op">=</span> exp<span class="op">(</span>l_tau_epsilon<span class="op">);</span></span>
<span id="cb22-41"><a href="fast-approximate-bayesian-inference.html#cb22-41" tabindex="-1"></a>  Type tau_nu <span class="op">=</span> exp<span class="op">(</span>l_tau_nu<span class="op">);</span></span>
<span id="cb22-42"><a href="fast-approximate-bayesian-inference.html#cb22-42" tabindex="-1"></a>  Type sigma_epsilon <span class="op">=</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">/</span> tau_epsilon<span class="op">);</span></span>
<span id="cb22-43"><a href="fast-approximate-bayesian-inference.html#cb22-43" tabindex="-1"></a>  Type sigma_nu <span class="op">=</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">/</span> tau_nu<span class="op">);</span></span>
<span id="cb22-44"><a href="fast-approximate-bayesian-inference.html#cb22-44" tabindex="-1"></a>  vector<span class="op">&lt;</span>Type<span class="op">&gt;</span> eta<span class="op">(</span>X <span class="op">*</span> beta <span class="op">+</span> nu <span class="op">+</span> E <span class="op">*</span> epsilon<span class="op">);</span> <span class="co">// Linear predictor</span></span>
<span id="cb22-45"><a href="fast-approximate-bayesian-inference.html#cb22-45" tabindex="-1"></a>  vector<span class="op">&lt;</span>Type<span class="op">&gt;</span> lambda<span class="op">(</span>exp<span class="op">(</span>eta<span class="op">));</span></span>
<span id="cb22-46"><a href="fast-approximate-bayesian-inference.html#cb22-46" tabindex="-1"></a>  </span>
<span id="cb22-47"><a href="fast-approximate-bayesian-inference.html#cb22-47" tabindex="-1"></a>  Type nll<span class="op">;</span></span>
<span id="cb22-48"><a href="fast-approximate-bayesian-inference.html#cb22-48" tabindex="-1"></a>  nll <span class="op">=</span> Type<span class="op">(</span><span class="fl">0.0</span><span class="op">);</span></span>
<span id="cb22-49"><a href="fast-approximate-bayesian-inference.html#cb22-49" tabindex="-1"></a>  </span>
<span id="cb22-50"><a href="fast-approximate-bayesian-inference.html#cb22-50" tabindex="-1"></a>  <span class="co">// Note: dgamma() is parameterised as (shape, scale)</span></span>
<span id="cb22-51"><a href="fast-approximate-bayesian-inference.html#cb22-51" tabindex="-1"></a>  <span class="co">// R-INLA is parameterised as (shape, rate)</span></span>
<span id="cb22-52"><a href="fast-approximate-bayesian-inference.html#cb22-52" tabindex="-1"></a>  nll <span class="op">-=</span> dlgamma<span class="op">(</span>l_tau_epsilon<span class="op">,</span> Type<span class="op">(</span><span class="fl">0.001</span><span class="op">),</span> Type<span class="op">(</span><span class="fl">1.0</span> <span class="op">/</span> <span class="fl">0.001</span><span class="op">),</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb22-53"><a href="fast-approximate-bayesian-inference.html#cb22-53" tabindex="-1"></a>  nll <span class="op">-=</span> dlgamma<span class="op">(</span>l_tau_nu<span class="op">,</span> Type<span class="op">(</span><span class="fl">0.001</span><span class="op">),</span> Type<span class="op">(</span><span class="fl">1.0</span> <span class="op">/</span> <span class="fl">0.001</span><span class="op">),</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb22-54"><a href="fast-approximate-bayesian-inference.html#cb22-54" tabindex="-1"></a>  nll <span class="op">-=</span> dnorm<span class="op">(</span>epsilon<span class="op">,</span> Type<span class="op">(</span><span class="dv">0</span><span class="op">),</span> sigma_epsilon<span class="op">,</span> <span class="kw">true</span><span class="op">).</span>sum<span class="op">();</span></span>
<span id="cb22-55"><a href="fast-approximate-bayesian-inference.html#cb22-55" tabindex="-1"></a>  nll <span class="op">-=</span> dnorm<span class="op">(</span>nu<span class="op">,</span> Type<span class="op">(</span><span class="dv">0</span><span class="op">),</span> sigma_nu<span class="op">,</span> <span class="kw">true</span><span class="op">).</span>sum<span class="op">();</span></span>
<span id="cb22-56"><a href="fast-approximate-bayesian-inference.html#cb22-56" tabindex="-1"></a>  nll <span class="op">-=</span> dnorm<span class="op">(</span>beta<span class="op">,</span> Type<span class="op">(</span><span class="dv">0</span><span class="op">),</span> Type<span class="op">(</span><span class="dv">100</span><span class="op">),</span> <span class="kw">true</span><span class="op">).</span>sum<span class="op">();</span></span>
<span id="cb22-57"><a href="fast-approximate-bayesian-inference.html#cb22-57" tabindex="-1"></a>  </span>
<span id="cb22-58"><a href="fast-approximate-bayesian-inference.html#cb22-58" tabindex="-1"></a>  nll <span class="op">-=</span> dpois<span class="op">(</span>y<span class="op">,</span> lambda<span class="op">,</span> <span class="kw">true</span><span class="op">).</span>sum<span class="op">();</span></span>
<span id="cb22-59"><a href="fast-approximate-bayesian-inference.html#cb22-59" tabindex="-1"></a>  </span>
<span id="cb22-60"><a href="fast-approximate-bayesian-inference.html#cb22-60" tabindex="-1"></a>  ADREPORT<span class="op">(</span>tau_epsilon<span class="op">);</span></span>
<span id="cb22-61"><a href="fast-approximate-bayesian-inference.html#cb22-61" tabindex="-1"></a>  ADREPORT<span class="op">(</span>tau_nu<span class="op">);</span></span>
<span id="cb22-62"><a href="fast-approximate-bayesian-inference.html#cb22-62" tabindex="-1"></a>  </span>
<span id="cb22-63"><a href="fast-approximate-bayesian-inference.html#cb22-63" tabindex="-1"></a>  <span class="cf">return</span><span class="op">(</span>nll<span class="op">);</span></span>
<span id="cb22-64"><a href="fast-approximate-bayesian-inference.html#cb22-64" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="stan-epil" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">C.1.3</span> <code>Stan</code> C++ template<a href="fast-approximate-bayesian-inference.html#stan-epil" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb23-1"><a href="fast-approximate-bayesian-inference.html#cb23-1" tabindex="-1"></a><span class="co">// epil.stan</span></span>
<span id="cb23-2"><a href="fast-approximate-bayesian-inference.html#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="fast-approximate-bayesian-inference.html#cb23-3" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb23-4"><a href="fast-approximate-bayesian-inference.html#cb23-4" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N<span class="op">;</span>            <span class="co">// Number of patients</span></span>
<span id="cb23-5"><a href="fast-approximate-bayesian-inference.html#cb23-5" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> J<span class="op">;</span>            <span class="co">// Number of clinic visits</span></span>
<span id="cb23-6"><a href="fast-approximate-bayesian-inference.html#cb23-6" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> K<span class="op">;</span>            <span class="co">// Number of predictors (inc. intercept)</span></span>
<span id="cb23-7"><a href="fast-approximate-bayesian-inference.html#cb23-7" tabindex="-1"></a>  matrix<span class="op">[</span>N <span class="op">*</span> J<span class="op">,</span> K<span class="op">]</span> X<span class="op">;</span>        <span class="co">// Design matrix</span></span>
<span id="cb23-8"><a href="fast-approximate-bayesian-inference.html#cb23-8" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> y<span class="op">[</span>N <span class="op">*</span> J<span class="op">];</span>     <span class="co">// Outcome variable</span></span>
<span id="cb23-9"><a href="fast-approximate-bayesian-inference.html#cb23-9" tabindex="-1"></a>  matrix<span class="op">[</span>N <span class="op">*</span> J<span class="op">,</span> N<span class="op">]</span> E<span class="op">;</span>        <span class="co">// Epsilon matrix</span></span>
<span id="cb23-10"><a href="fast-approximate-bayesian-inference.html#cb23-10" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-11"><a href="fast-approximate-bayesian-inference.html#cb23-11" tabindex="-1"></a></span>
<span id="cb23-12"><a href="fast-approximate-bayesian-inference.html#cb23-12" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb23-13"><a href="fast-approximate-bayesian-inference.html#cb23-13" tabindex="-1"></a>  vector<span class="op">[</span>K<span class="op">]</span> beta<span class="op">;</span>            <span class="co">// Vector of coefficients</span></span>
<span id="cb23-14"><a href="fast-approximate-bayesian-inference.html#cb23-14" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> epsilon<span class="op">;</span>         <span class="co">// Patient specific errors</span></span>
<span id="cb23-15"><a href="fast-approximate-bayesian-inference.html#cb23-15" tabindex="-1"></a>  vector<span class="op">[</span>N <span class="op">*</span> J<span class="op">]</span> nu<span class="op">;</span>          <span class="co">// Patient-visit errors</span></span>
<span id="cb23-16"><a href="fast-approximate-bayesian-inference.html#cb23-16" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tau_epsilon<span class="op">;</span> <span class="co">// Precision of epsilon</span></span>
<span id="cb23-17"><a href="fast-approximate-bayesian-inference.html#cb23-17" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tau_nu<span class="op">;</span>      <span class="co">// Precision of nu</span></span>
<span id="cb23-18"><a href="fast-approximate-bayesian-inference.html#cb23-18" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-19"><a href="fast-approximate-bayesian-inference.html#cb23-19" tabindex="-1"></a></span>
<span id="cb23-20"><a href="fast-approximate-bayesian-inference.html#cb23-20" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb23-21"><a href="fast-approximate-bayesian-inference.html#cb23-21" tabindex="-1"></a>  vector<span class="op">[</span>N <span class="op">*</span> J<span class="op">]</span> eta <span class="op">=</span> X <span class="op">*</span> beta <span class="op">+</span> nu <span class="op">+</span> E <span class="op">*</span> epsilon<span class="op">;</span>  <span class="co">// Linear predictor</span></span>
<span id="cb23-22"><a href="fast-approximate-bayesian-inference.html#cb23-22" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-23"><a href="fast-approximate-bayesian-inference.html#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="fast-approximate-bayesian-inference.html#cb23-24" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb23-25"><a href="fast-approximate-bayesian-inference.html#cb23-25" tabindex="-1"></a>  beta <span class="op">~</span> normal<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">);</span></span>
<span id="cb23-26"><a href="fast-approximate-bayesian-inference.html#cb23-26" tabindex="-1"></a>  tau_epsilon <span class="op">~</span> gamma<span class="op">(</span><span class="fl">0.001</span><span class="op">,</span> <span class="fl">0.001</span><span class="op">);</span></span>
<span id="cb23-27"><a href="fast-approximate-bayesian-inference.html#cb23-27" tabindex="-1"></a>  tau_nu <span class="op">~</span> gamma<span class="op">(</span><span class="fl">0.001</span><span class="op">,</span> <span class="fl">0.001</span><span class="op">);</span></span>
<span id="cb23-28"><a href="fast-approximate-bayesian-inference.html#cb23-28" tabindex="-1"></a>  epsilon <span class="op">~</span> normal<span class="op">(</span><span class="dv">0</span><span class="op">,</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">/</span> tau_epsilon<span class="op">));</span></span>
<span id="cb23-29"><a href="fast-approximate-bayesian-inference.html#cb23-29" tabindex="-1"></a>  nu <span class="op">~</span> normal<span class="op">(</span><span class="dv">0</span><span class="op">,</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">/</span> tau_nu<span class="op">));</span></span>
<span id="cb23-30"><a href="fast-approximate-bayesian-inference.html#cb23-30" tabindex="-1"></a>  y <span class="op">~</span> poisson_log<span class="op">(</span>eta<span class="op">);</span></span>
<span id="cb23-31"><a href="fast-approximate-bayesian-inference.html#cb23-31" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="nuts-convergence-and-suitability" class="section level3 hasAnchor" number="10.1.4">
<h3><span class="header-section-number">C.1.4</span> NUTS convergence and suitability<a href="fast-approximate-bayesian-inference.html#nuts-convergence-and-suitability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="tmbstan-epil" class="section level4 hasAnchor" number="10.1.4.1">
<h4><span class="header-section-number">C.1.4.1</span> <code>tmbstan</code><a href="fast-approximate-bayesian-inference.html#tmbstan-epil" class="anchor-section" aria-label="Anchor link to header"></a></h4>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:tmbstan-epil"></span>
<img src="figures/naomi-aghq/tmbstan-epil.png" alt="Traceplots for the tmbstan parameters with the lowest ESS and highest potential scale reduction factor. These were l_tau_nu (an \(\text{ESS}\) of 377) and beta[3] (an \(\hat R\) of 1.006)." width="95%" />
<p class="caption">
Figure C.1: Traceplots for the <code>tmbstan</code> parameters with the lowest ESS and highest potential scale reduction factor. These were <code>l_tau_nu</code> (an <span class="math inline">\(\text{ESS}\)</span> of 377) and <code>beta[3]</code> (an <span class="math inline">\(\hat R\)</span> of 1.006).
</p>
</div>
</div>
<div id="rstan-epil" class="section level4 hasAnchor" number="10.1.4.2">
<h4><span class="header-section-number">C.1.4.2</span> <code>rstan</code><a href="fast-approximate-bayesian-inference.html#rstan-epil" class="anchor-section" aria-label="Anchor link to header"></a></h4>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:stan-epil"></span>
<img src="figures/naomi-aghq/stan-epil.png" alt="Traceplots for the rstan parameters with the lowest ESS and highest potential scale reduction factor. These were tau_nu (an \(\text{ESS}\) of 437) and tau_nu (an \(\hat R\) of 1.009). Rather than plotting the traceplot for tau_nu twice, the parameter epsilon[18] is included, which had the second highest \(\hat R\) of 1.008." width="95%" />
<p class="caption">
Figure C.2: Traceplots for the <code>rstan</code> parameters with the lowest ESS and highest potential scale reduction factor. These were <code>tau_nu</code> (an <span class="math inline">\(\text{ESS}\)</span> of 437) and <code>tau_nu</code> (an <span class="math inline">\(\hat R\)</span> of 1.009). Rather than plotting the traceplot for <code>tau_nu</code> twice, the parameter <code>epsilon[18]</code> is included, which had the second highest <span class="math inline">\(\hat R\)</span> of 1.008.
</p>
</div>
</div>
</div>
</div>
<div id="loa-loa-example" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">C.2</span> Loa loa example<a href="fast-approximate-bayesian-inference.html#loa-loa-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="nuts-convergence-and-suitability-1" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">C.2.1</span> NUTS convergence and suitability<a href="fast-approximate-bayesian-inference.html#nuts-convergence-and-suitability-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:nuts-loa-loa"></span>
<img src="figures/naomi-aghq/nuts-loa-loa.png" alt="Traceplots for the parameters with the lowest ESS and highest potential scale reduction factor." width="95%" />
<p class="caption">
Figure C.3: Traceplots for the parameters with the lowest ESS and highest potential scale reduction factor.
</p>
</div>
</div>
<div id="inference-comparison-1" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">C.2.2</span> Inference comparison<a href="fast-approximate-bayesian-inference.html#inference-comparison-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:loa-loa-mean-sd-pct"></span>
<img src="figures/naomi-aghq/loa-loa-mean-sd-pct.png" alt="Relative difference between the Gaussian and Laplace marginal posterior means and standard deviations to NUTS results at each \(u(s_i), v(s_i): i \in [190]\). Absolute differences are in Figure 6.14." width="95%" />
<p class="caption">
Figure C.4: Relative difference between the Gaussian and Laplace marginal posterior means and standard deviations to NUTS results at each <span class="math inline">\(u(s_i), v(s_i): i \in [190]\)</span>. Absolute differences are in Figure <a href="naomi-aghq.html#fig:loa-loa-mean-sd-abs">6.14</a>.
</p>
</div>
</div>
</div>
<div id="naomi-math" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">C.3</span> Simplified Naomi model description<a href="fast-approximate-bayesian-inference.html#naomi-math" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section describes the simplified version of the Naomi model <span class="citation">(<a href="#ref-eaton2021naomi">Eaton et al. 2021</a>)</span> in more detail.
The concise <span class="math inline">\(i\)</span> indexing used in Section <a href="naomi-aghq.html#naomi">6.3</a> is replaced by a more complete <span class="math inline">\(x, s, a\)</span> indexing.
There are four sections:</p>
<ol style="list-style-type: decimal">
<li>Section <a href="fast-approximate-bayesian-inference.html#naomi-process">C.3.1</a> gives the process specifications, giving the terms in each structured additive predictor, along with their distributions.</li>
<li>Section <a href="fast-approximate-bayesian-inference.html#naomi-likelihood">C.3.2</a> gives additional details about the likelihood terms not provided in Section <a href="naomi-aghq.html#naomi">6.3</a>.</li>
<li>Section <a href="fast-approximate-bayesian-inference.html#naomi-identifiability">C.3.3</a> gives identifiability constraints used in circumstances where incomplete data is available for the country.</li>
<li>Section <a href="fast-approximate-bayesian-inference.html#naomi-implementation">C.3.4</a> provides details of the <code>TMB</code> implementation.</li>
</ol>
<div id="naomi-process" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">C.3.1</span> Process specification<a href="fast-approximate-bayesian-inference.html#naomi-process" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:process">Table C.1: </span> The Naomi model can be conceptualised as having five processes. This table gives the number of latent field parameters and hyperparameters in each process, where <span class="math inline">\(n\)</span> is the number of districts in the country.</caption>
<colgroup>
<col width="27%" />
<col width="29%" />
<col width="19%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Model component</th>
<th>Latent field</th>
<th>Hyperparameter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Section <a href="fast-approximate-bayesian-inference.html#hiv-prev">C.3.1.1</a></td>
<td>HIV prevalence</td>
<td><span class="math inline">\(22 + 5n\)</span></td>
<td>9</td>
</tr>
<tr class="even">
<td>Section <a href="fast-approximate-bayesian-inference.html#art-cov">C.3.1.2</a></td>
<td>ART coverage</td>
<td><span class="math inline">\(25 + 5n\)</span></td>
<td>9</td>
</tr>
<tr class="odd">
<td>Section <a href="fast-approximate-bayesian-inference.html#hiv-inc">C.3.1.3</a></td>
<td>HIV incidence rate</td>
<td><span class="math inline">\(2 + n\)</span></td>
<td>3</td>
</tr>
<tr class="even">
<td>Section <a href="fast-approximate-bayesian-inference.html#anc-test">C.3.1.4</a></td>
<td>ANC testing</td>
<td><span class="math inline">\(2 + 2n\)</span></td>
<td>2</td>
</tr>
<tr class="odd">
<td>Section <a href="fast-approximate-bayesian-inference.html#art-attend">C.3.1.5</a></td>
<td>ART attendance</td>
<td><span class="math inline">\(n\)</span></td>
<td>1</td>
</tr>
<tr class="even">
<td></td>
<td>Total</td>
<td><span class="math inline">\(51 + 14n\)</span></td>
<td>24</td>
</tr>
</tbody>
</table>
<div id="hiv-prev" class="section level4 hasAnchor" number="10.3.1.1">
<h4><span class="header-section-number">C.3.1.1</span> HIV prevalence<a href="fast-approximate-bayesian-inference.html#hiv-prev" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>HIV prevalence <span class="math inline">\(\rho_{x, s, a} \in [0, 1]\)</span> was modelled on the logit scale using the structured additive predictor
<span class="math display" id="eq:prev">\[\begin{equation}
\text{logit}(\rho_{x, s, a}) = \beta^\rho_0 + \beta_{S}^{\rho, s = \text{M}} + \mathbf{u}^\rho_a + \mathbf{u}_a^{\rho, s = \text{M}} + \mathbf{u}^\rho_x + \mathbf{u}_x^{\rho, s = \text{M}} + \mathbf{u}_x^{\rho, a &lt; 15} + \boldsymbol{\mathbf{\eta}}^\rho_{R_x, s, a}. \tag{C.1}
\end{equation}\]</span>
Table <a href="fast-approximate-bayesian-inference.html#tab:prev">C.2</a> provides a description of the terms included in Equation <a href="fast-approximate-bayesian-inference.html#eq:prev">(C.1)</a>.
Independent half-normal prior distributions were chosen for the five standard deviation terms
<span class="math display">\[\begin{equation}
\{\sigma_A^\rho, \sigma_{AS}^\rho, \sigma_X^\rho, \sigma_{XS}^\rho, \sigma_{XA}^\rho\} \sim \mathcal{N}^{+}(0, 2.5),
\end{equation}\]</span>
independent uniform prior distributions for the two AR1 correlation parameters
<span class="math display">\[\begin{equation}
\{\phi_A^\rho, \phi_{AS}^\rho\} \sim \mathcal{U}(-1, 1),
\end{equation}\]</span>
and independent beta prior distributions for the two BYM2 proportion parameters
<span class="math display">\[\begin{equation}
\{\phi_X^\rho, \phi_{XS}^\rho\} \sim \text{Beta}(0.5, 0.5).
\end{equation}\]</span></p>
<table>
<caption><span id="tab:prev">Table C.2: </span> Each term in Equation <a href="fast-approximate-bayesian-inference.html#eq:prev">(C.1)</a> together with (where applicable) its prior distribution and a written description of its role.</caption>
<colgroup>
<col width="17%" />
<col width="25%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Distribution</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta^\rho_0\)</span></td>
<td><span class="math inline">\(\mathcal{N}(0, 5)\)</span></td>
<td>Intercept</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_{s}^{\rho, s = \text{M}}\)</span></td>
<td><span class="math inline">\(\mathcal{N}(0, 5)\)</span></td>
<td>The difference in logit prevalence for men compared to women</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mathbf{u}^\rho_a\)</span></td>
<td><span class="math inline">\(\text{AR}1(\sigma_A^\rho, \phi_A^\rho)\)</span></td>
<td>Age random effects for women</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{u}_a^{\rho, s = \text{M}}\)</span></td>
<td><span class="math inline">\(\text{AR}1(\sigma_{AS}^\rho, \phi_{AS}^\rho)\)</span></td>
<td>Age random effects for the difference in logit prevalence for men compared to women age <span class="math inline">\(a\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mathbf{u}^\rho_x\)</span></td>
<td><span class="math inline">\(\text{BYM}2(\sigma_X^\rho, \phi_X^\rho)\)</span></td>
<td>Spatial random effects for women</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{u}_x^{\rho, s = \text{M}}\)</span></td>
<td><span class="math inline">\(\text{BYM}2(\sigma_{XS}^\rho, \phi_{XS}^\rho)\)</span></td>
<td>Spatial random effects for the difference in logit prevalence for men compared to women in district <span class="math inline">\(x\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mathbf{u}_x^{\rho, a &lt; 15}\)</span></td>
<td><span class="math inline">\(\text{ICAR}(\sigma_{XA}^\rho)\)</span></td>
<td>Spatial random effects for the difference in logit paediatric prevalence to adult women prevalence in district <span class="math inline">\(x\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\boldsymbol{\mathbf{\eta}}^\rho_{R_x, s, a}\)</span></td>
<td><span class="math inline">\(-\)</span></td>
<td>Fixed offsets specifying assumed odds ratios for prevalence outside the age ranges for which data were available. Calculated from Spectrum model <span class="citation">(<a href="#ref-stover2019updates">Stover et al. 2019</a>)</span> outputs for region <span class="math inline">\(R_x\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="art-cov" class="section level4 hasAnchor" number="10.3.1.2">
<h4><span class="header-section-number">C.3.1.2</span> ART coverage<a href="fast-approximate-bayesian-inference.html#art-cov" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>ART coverage <span class="math inline">\(\alpha_{x, s, a} \in [0, 1]\)</span> was modelled on the logit scale using the structured additive predictor
<span class="math display">\[\begin{equation}
\text{logit}(\alpha_{x, s, a}) = \beta^\alpha_0 + \beta_{S}^{\alpha, s = \text{M}} + \mathbf{u}^\alpha_a + \mathbf{u}_a^{\alpha, s = \text{M}} + \mathbf{u}^\alpha_x + \mathbf{u}_x^{\alpha, s = \text{M}} + \mathbf{u}_x^{\alpha, a &lt; 15} + \boldsymbol{\mathbf{\eta}}^\alpha_{R_x, s, a}
\end{equation}\]</span>
with terms and priors analogous to the HIV prevalence process model in Section <a href="fast-approximate-bayesian-inference.html#hiv-prev">C.3.1.1</a> above.</p>
</div>
<div id="hiv-inc" class="section level4 hasAnchor" number="10.3.1.3">
<h4><span class="header-section-number">C.3.1.3</span> HIV incidence rate<a href="fast-approximate-bayesian-inference.html#hiv-inc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>HIV incidence rate <span class="math inline">\(\lambda_{x, s, a} &gt; 0\)</span> was modelled on the log scale using the structured additive predictor
<span class="math display" id="eq:inc">\[\begin{equation}
\log(\lambda_{x, s, a}) = \beta_0^\lambda + \beta_S^{\lambda, s = \text{M}} + \log(\rho_{x}^{\text{15-49}}) + \log(1 - \omega \cdot \alpha_{x}^{\text{15-49}}) + \mathbf{u}_x^\lambda + \boldsymbol{\mathbf{\eta}}_{R_x, s, a}^\lambda. \tag{C.2}
\end{equation}\]</span>
Table <a href="fast-approximate-bayesian-inference.html#tab:inc">C.3</a> provides a description of the terms included in Equation <a href="fast-approximate-bayesian-inference.html#eq:inc">(C.2)</a>.</p>
<table>
<caption><span id="tab:inc">Table C.3: </span> Each term in Equation <a href="fast-approximate-bayesian-inference.html#eq:inc">(C.2)</a> together with (where applicable) its prior distribution and a written description of its role.</caption>
<colgroup>
<col width="15%" />
<col width="14%" />
<col width="69%" />
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Distribution</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta^\lambda_0\)</span></td>
<td><span class="math inline">\(\mathcal{N}(0, 5)\)</span></td>
<td>Intercept term proportional to the average HIV transmission rate for untreated HIV positive adults</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_S^{\lambda, s = \text{M}}\)</span></td>
<td><span class="math inline">\(\mathcal{N}(0, 5)\)</span></td>
<td>The log incidence rate ratio for men compared to women</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\rho_{x}^{\text{15-49}}\)</span></td>
<td><span class="math inline">\(-\)</span></td>
<td>The HIV prevalence among adults 15-49 in district <span class="math inline">\(x\)</span> calculated by aggregating age-specific HIV prevalences</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\alpha_{x}^{\text{15-49}}\)</span></td>
<td><span class="math inline">\(-\)</span></td>
<td>The ART coverage among adults 15-49 in district <span class="math inline">\(x\)</span> calculated by aggregating age-specific ART coverages</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\omega = 0.7\)</span></td>
<td><span class="math inline">\(-\)</span></td>
<td>Average reduction in HIV transmission rate per increase in population ART coverage fixed based on inputs to the Estimation and Projection Package (EPP) model</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{u}_x^\lambda\)</span></td>
<td><span class="math inline">\(\mathcal{N}(0, \sigma^\lambda)\)</span></td>
<td>IID spatial random effects with <span class="math inline">\(\sigma^\lambda \sim \mathcal{N}^+(0, 1)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\boldsymbol{\mathbf{\eta}}^\lambda_{R_x, s, a}\)</span></td>
<td><span class="math inline">\(-\)</span></td>
<td>Fixed log incidence rate ratios by sex and age group calculated from Spectrum model outputs for region <span class="math inline">\(R_x\)</span></td>
</tr>
</tbody>
</table>
<p>The proportion recently infected among HIV positive persons <span class="math inline">\(\kappa_{x, s, a} \in [0, 1]\)</span> was modelled as
<span class="math display">\[\begin{equation}
\kappa_{x, s, a} = 1 - \exp \left(- \lambda_{x, s, a} \cdot \frac{1 - \rho_{x, s, a}}{\rho_{x, s, a}} \cdot (\Omega_T - \beta_T ) - \beta_T \right),
\end{equation}\]</span>
where <span class="math inline">\(\Omega_T \sim \mathcal{N}(\Omega_{T_0}, \sigma^{\Omega_T})\)</span> is the mean duration of recent infection, and <span class="math inline">\(\beta_T \sim \mathcal{N}^{+}(\beta_{T_0}, \sigma^{\beta_T})\)</span> is the false recent ratio.
The prior distribution for <span class="math inline">\(\Omega_T\)</span> was informed by the characteristics of the recent infection testing algorithm.
For PHIA surveys this was <span class="math inline">\(\Omega_{T_0} = 130 \text{ days}\)</span> and <span class="math inline">\(\sigma^{\Omega_T} = 6.12 \text{ days}\)</span>.
For PHIA surveys there was assumed to be no false recency, such that <span class="math inline">\(\beta_{T_0} = 0.0\)</span>, <span class="math inline">\(\sigma^{\beta_T} = 0.0\)</span>, and <span class="math inline">\(\beta_T = 0\)</span>.</p>
</div>
<div id="anc-test" class="section level4 hasAnchor" number="10.3.1.4">
<h4><span class="header-section-number">C.3.1.4</span> ANC testing<a href="fast-approximate-bayesian-inference.html#anc-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>HIV prevalence <span class="math inline">\(\rho_{x, a}^\text{ANC}\)</span> and ART coverage <span class="math inline">\(\alpha_{x, a}^\text{ANC}\)</span> among pregnant women were modelled as being offset on the logit scale from the corresponding district-age indicators <span class="math inline">\(\rho_{x, F, a}\)</span> and <span class="math inline">\(\alpha_{x, F, a}\)</span> according to
<span class="math display" id="eq:anc2" id="eq:anc1">\[\begin{align}
\text{logit}(\rho_{x, a}^{\text{ANC}}) &amp;= \text{logit}(\rho_{x, F, a}) + \beta^{\rho^{\text{ANC}}} + \mathbf{u}_x^{\rho^{\text{ANC}}} + \boldsymbol{\mathbf{\eta}}_{R_x, a}^{\rho^{\text{ANC}}}, \tag{C.3} \\
\text{logit}(\alpha_{x, a}^{\text{ANC}}) &amp;= \text{logit}(\alpha_{x, F, a}) + \beta^{\alpha^{\text{ANC}}} + \mathbf{u}_x^{\alpha^{\text{ANC}}} + \boldsymbol{\mathbf{\eta}}_{R_x, a}^{\alpha^{\text{ANC}}} \tag{C.4}.
\end{align}\]</span>
Table <a href="fast-approximate-bayesian-inference.html#tab:anc">C.4</a> provides a description of the terms included in Equation <a href="fast-approximate-bayesian-inference.html#eq:anc1">(C.3)</a> and Equation <a href="fast-approximate-bayesian-inference.html#eq:anc2">(C.4)</a>.</p>
<table>
<caption><span id="tab:anc">Table C.4: </span> Each term in Equations <a href="fast-approximate-bayesian-inference.html#eq:anc1">(C.3)</a> and <a href="fast-approximate-bayesian-inference.html#eq:anc2">(C.4)</a> together with (where applicable) its prior distribution and a written description of its role. The notation <span class="math inline">\(\theta\)</span> is used as stand in for <span class="math inline">\(\theta \in \{\rho, \alpha\}\)</span>.</caption>
<colgroup>
<col width="13%" />
<col width="16%" />
<col width="69%" />
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Distribution</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\beta^{\theta^{\text{ANC}}}\)</span></td>
<td><span class="math inline">\(\mathcal{N}(0, 5)\)</span></td>
<td>Intercept giving the average difference between population and ANC outcomes</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{u}_x^{\theta^{\text{ANC}}}\)</span></td>
<td><span class="math inline">\(\mathcal{N}(0, \sigma_X^{\theta^{\text{ANC}}})\)</span></td>
<td>IID district random effects with <span class="math inline">\(\sigma_X^{\theta^{\text{ANC}}} \sim \mathcal{N}^+(0, 1)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\boldsymbol{\mathbf{\eta}}_{R_x, a}^{\theta^{\text{ANC}}}\)</span></td>
<td><span class="math inline">\(-\)</span></td>
<td>Offsets for the log fertility rate ratios for HIV positive women compared to HIV negative women and for women on ART to HIV positive women not on ART, calculated from Spectrum model outputs for region <span class="math inline">\(R_x\)</span></td>
</tr>
</tbody>
</table>
<p>In the full Naomi model, for adult women 15-49 the number of ANC clients <span class="math inline">\(\Psi_{x, a} &gt; 0\)</span> were modelled as
<span class="math display">\[\begin{equation}
\log (\Psi_{x, a}) = \log (N_{x, \text{F}, a}) + \psi_{R_x, a} + \beta^\psi + \mathbf{u}_x^\psi,
\end{equation}\]</span>
where <span class="math inline">\(N_{x, \text{F}, a}\)</span> are the female population sizes, <span class="math inline">\(\psi_{R_x, a}\)</span> are fixed age-sex fertility ratios in Spectrum region <span class="math inline">\(R_x\)</span>, <span class="math inline">\(\beta^\psi\)</span> are log rate ratios for the number of ANC clients relative to the predicted fertility, and <span class="math inline">\(\mathbf{u}_x^\psi \sim \mathcal{N}(0, \sigma^\psi)\)</span> are district random effects.
Here these terms are fixed to <span class="math inline">\(\beta^\psi = 0\)</span> and <span class="math inline">\(\mathbf{u}_x^\psi = \mathbf{0}\)</span> such that <span class="math inline">\(\Psi_{x, a}\)</span> are simply constants.</p>
</div>
<div id="art-attend" class="section level4 hasAnchor" number="10.3.1.5">
<h4><span class="header-section-number">C.3.1.5</span> ART attendance<a href="fast-approximate-bayesian-inference.html#art-attend" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(\gamma_{x, x&#39;} \in [0, 1]\)</span> be the probability that a person on ART residing in district <span class="math inline">\(x\)</span> receives ART in district <span class="math inline">\(x&#39;\)</span>.
Assume that <span class="math inline">\(\gamma_{x, x&#39;} = 0\)</span> for <span class="math inline">\(x \notin \{x, \text{ne}(x)\}\)</span> such that individuals seek treatment only in their residing district or its neighbours <span class="math inline">\(\text{ne}(x) = \{x&#39;: x&#39; \sim x\}\)</span>, where <span class="math inline">\(\sim\)</span> is an adjacency relation, and <span class="math inline">\(\sum_{x&#39; \in \{x, \text{ne}(x)\}} \gamma_{x, x&#39;} = 1\)</span>.</p>
<p>The probabilities <span class="math inline">\(\gamma_{x, x&#39;}\)</span> for <span class="math inline">\(x \sim x&#39;\)</span> were modelled using multinomial logistic regression model, based on the log-odds ratios
<span class="math display" id="eq:log-or">\[\begin{equation}
\tilde \gamma_{x, x&#39;} = \log \left( \frac{\gamma_{x, x&#39;}}{1 - \gamma_{x, x&#39;}} \right) = \tilde \gamma_0 + \mathbf{u}_x^{\tilde \gamma}. \tag{C.5}
\end{equation}\]</span>
Table <a href="fast-approximate-bayesian-inference.html#tab:log-or">C.5</a> provides a description of the terms included in Equation <a href="fast-approximate-bayesian-inference.html#eq:log-or">(C.5)</a>.
Fixing <span class="math inline">\(\tilde \gamma_{x, x} = 0\)</span> then the multinomial probabilities may be recovered using the softmax
<span class="math display">\[\begin{equation}
\gamma_{x, x&#39;} = \frac{\exp(\tilde \gamma_{x, x&#39;})}{\sum_{x^\star \in \{x, \text{ne}(x)\}} \exp(\tilde \gamma_{x, x^\star})}.
\end{equation}\]</span></p>
<table>
<caption><span id="tab:log-or">Table C.5: </span> Each term in Equation <a href="fast-approximate-bayesian-inference.html#eq:log-or">(C.5)</a> and <a href="fast-approximate-bayesian-inference.html#eq:anc2">(C.4)</a> together with (where applicable) its prior distribution and a written description of its role.
No terms include <span class="math inline">\(x&#39;\)</span>, such that <span class="math inline">\(\gamma_{x, x&#39;}\)</span> is only a function of <span class="math inline">\(x\)</span>.</caption>
<colgroup>
<col width="19%" />
<col width="27%" />
<col width="52%" />
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Distribution</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\tilde \gamma_0\)</span></td>
<td><span class="math inline">\(-\)</span></td>
<td>Fixed intercept <span class="math inline">\(\tilde \gamma_0 = -4\)</span>. Implies a prior mean on <span class="math inline">\(\gamma_{x, x&#39;}\)</span> of 1.8%, such that a-priori <span class="math inline">\((100 - 1.8 \times \text{ne}(x))\%\)</span> of ART clients in district <span class="math inline">\(x\)</span> obtain treatment in their home district</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{u}_x^{\tilde \gamma}\)</span></td>
<td><span class="math inline">\(\mathcal{N}(0, \sigma_X^{\tilde \gamma})\)</span></td>
<td>District random effects, with <span class="math inline">\(\sigma_X^{\tilde \gamma} \sim \mathcal{N}^+(0, 2.5)\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="naomi-likelihood" class="section level3 hasAnchor" number="10.3.2">
<h3><span class="header-section-number">C.3.2</span> Additional likelihood specification<a href="fast-approximate-bayesian-inference.html#naomi-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Though Section <a href="naomi-aghq.html#naomi">6.3</a> provides a complete description of Naomi’s likelihood specification, any additional useful details are provided here.</p>
<div id="household-survey-data-2" class="section level4 hasAnchor" number="10.3.2.1">
<h4><span class="header-section-number">C.3.2.1</span> Household survey data<a href="fast-approximate-bayesian-inference.html#household-survey-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The generalised binomial <span class="math inline">\(y \sim \text{xBin}(m, p)\)</span> is defined for <span class="math inline">\(y, m \in \mathbb{R}^+\)</span> with <span class="math inline">\(y \leq m\)</span> such that
<span class="math display">\[\begin{align}
\log p(y) = &amp;\log \Gamma(m + 1) - \log \Gamma(y + 1) \\
            &amp;- \log \Gamma(m - y + 1) + y \log p + (m - y) \log(1 - p),
\end{align}\]</span>
where the gamma function <span class="math inline">\(\Gamma\)</span> is such that <span class="math inline">\(\forall n \in \mathbb{N}\)</span>, <span class="math inline">\(\Gamma(n) = (n - 1)!\)</span>.</p>
</div>
</div>
<div id="naomi-identifiability" class="section level3 hasAnchor" number="10.3.3">
<h3><span class="header-section-number">C.3.3</span> Identifiability constraints<a href="fast-approximate-bayesian-inference.html#naomi-identifiability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If data are missing, some parameters are fixed to default values to help with identifiability.
In particular:</p>
<ol style="list-style-type: decimal">
<li>If survey data on HIV prevalence or ART coverage by age and sex are not available then <span class="math inline">\(\mathbf{u}_a^\theta = 0\)</span> and <span class="math inline">\(\mathbf{u}_{a, s = \text{M}}^\theta = 0\)</span>.
In this case, the average age-sex pattern from the Spectrum is used.
For the Malawi case-study (Section <a href="naomi-aghq.html#malawi">6.5</a>), HIV prevalence and ART coverage data are not available for those aged 65+.
As a result, there are <span class="math inline">\(|\{\text{0-4}, \ldots, \text{50-54}\}| = 13\)</span> age groups included for the age random effects.</li>
<li>If no ART data, either survey or ART programme, are available but data on ART coverage among ANC clients are available, the level of ART coverage is not identifiable, but spatial variation is identifiable.
In this instance, overall ART coverage is determined by the Spectrum offset, and only area random effects are estimated such that
<span class="math display">\[\begin{equation}
\text{logit} \left(\alpha_{x, s, a} \right) = \mathbf{u}_x^\alpha + \boldsymbol{\mathbf{\eta}}_{R_x, s, a}^\alpha.
\end{equation}\]</span></li>
<li>If survey data on recent HIV infection are not included in the model, then <span class="math inline">\(\beta_0^\lambda = \beta_S^{\lambda, s = \text{M}} = 0\)</span> and <span class="math inline">\(\mathbf{u}_x^\lambda = \mathbf{0}\)</span>.
The sex ratio for HIV incidence is determined by the sex incidence rate ratio from Spectrum, and the incidence rate in all districts is modelled assuming the same average HIV transmission rate for untreated adults, but varies according to district-level estimates of HIV prevalence and ART coverage.</li>
</ol>
</div>
<div id="naomi-implementation" class="section level3 hasAnchor" number="10.3.4">
<h3><span class="header-section-number">C.3.4</span> Implementation<a href="fast-approximate-bayesian-inference.html#naomi-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>TMB</code> C++ code for the negative log-posterior of the simplified Naomi model is available from <a href="https://github.com/athowes/naomi-aghq"><code>https://github.com/athowes/naomi-aghq</code></a>.
For ease of understanding, Table <a href="fast-approximate-bayesian-inference.html#tab:tmb-lookup">C.6</a> provides correspondence between the mathematical notation used in Section <a href="fast-approximate-bayesian-inference.html#naomi-math">C.3</a> and the variable names used in the <code>TMB</code> code, for all hyperparameters and latent field parameters.
For further reference on the <code>TMB</code> software see <span class="citation">Kristensen (<a href="#ref-tmbdocumentation">2021</a>)</span>.</p>
<table>
<caption><span id="tab:tmb-lookup">Table C.6: </span> Correspondence between the variable name used in the Naomi <code>TMB</code> template and the mathematical notation used in Appendix <a href="fast-approximate-bayesian-inference.html#naomi-math">C.3</a>. The parameter type, either a hyperparameter or elements of the latent field, are given. All of the parameters are defined on the real-scale in some dimension. In the final three columns (<span class="math inline">\(\rho, \alpha, \lambda\)</span>) indication is given as to which component of the model the parameter is primarily used in.</caption>
<colgroup>
<col width="28%" />
<col width="20%" />
<col width="8%" />
<col width="10%" />
<col width="8%" />
<col width="11%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable name</th>
<th>Notation</th>
<th>Type</th>
<th>Domain</th>
<th><span class="math inline">\(\rho\)</span></th>
<th><span class="math inline">\(\alpha\)</span></th>
<th><span class="math inline">\(\lambda\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>logit_phi_rho_x</code></td>
<td><span class="math inline">\(\text{logit}(\phi_X^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>log_sigma_rho_x</code></td>
<td><span class="math inline">\(\log(\sigma_X^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>logit_phi_rho_xs</code></td>
<td><span class="math inline">\(\text{logit}(\phi_{XS}^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>log_sigma_rho_xs</code></td>
<td><span class="math inline">\(\log(\sigma_{XS}^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>logit_phi_rho_a</code></td>
<td><span class="math inline">\(\text{logit}(\phi_A^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>log_sigma_rho_a</code></td>
<td><span class="math inline">\(\log(\sigma_A^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>logit_phi_rho_as</code></td>
<td><span class="math inline">\(\text{logit}(\phi_{AS}^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>log_sigma_rho_as</code></td>
<td><span class="math inline">\(\log(\sigma_{AS}^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>log_sigma_rho_xa</code></td>
<td><span class="math inline">\(\log(\sigma_{XA}^\rho)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>logit_phi_alpha_x</code></td>
<td><span class="math inline">\(\text{logit}(\phi_X^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>log_sigma_alpha_x</code></td>
<td><span class="math inline">\(\log(\sigma_X^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>logit_phi_alpha_xs</code></td>
<td><span class="math inline">\(\text{logit}(\phi_{XS}^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>log_sigma_alpha_xs</code></td>
<td><span class="math inline">\(\log(\sigma_{XS}^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>logit_phi_alpha_a</code></td>
<td><span class="math inline">\(\text{logit}(\phi_A^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>log_sigma_alpha_a</code></td>
<td><span class="math inline">\(\log(\sigma_A^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>logit_phi_alpha_as</code></td>
<td><span class="math inline">\(\text{logit}(\phi_{AS}^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>log_sigma_alpha_as</code></td>
<td><span class="math inline">\(\log(\sigma_{AS}^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>log_sigma_alpha_xa</code></td>
<td><span class="math inline">\(\log(\sigma_{XA}^\alpha)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>OmegaT_raw</code></td>
<td><span class="math inline">\(\Omega_T\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>log_betaT</code></td>
<td><span class="math inline">\(\log(\beta_T)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>log_sigma_lambda_x</code></td>
<td><span class="math inline">\(\log(\sigma^\lambda)\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>log_sigma_ancrho_x</code></td>
<td><span class="math inline">\(\log(\sigma_X^{\rho^{\text{ANC}}})\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>log_sigma_ancalpha_x</code></td>
<td><span class="math inline">\(\log(\sigma_X^{\alpha^{\text{ANC}}})\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>log_sigma_or_gamma</code></td>
<td><span class="math inline">\(\log(\sigma_X^{\tilde \gamma})\)</span></td>
<td>Hyper</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>beta_rho</code></td>
<td><span class="math inline">\((\beta^\rho_0, \beta_{s}^{\rho, s = \text{M}})\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^2\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>beta_alpha</code></td>
<td><span class="math inline">\((\beta^\alpha_0, \beta_{S}^{\alpha, s = \text{M}})\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^2\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>beta_lambda</code></td>
<td><span class="math inline">\((\beta_0^\lambda, \beta_S^{\lambda, s = \text{M}})\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^2\)</span></td>
<td></td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td><code>beta_anc_rho</code></td>
<td><span class="math inline">\(\beta^{\rho^{\text{ANC}}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>beta_anc_alpha</code></td>
<td><span class="math inline">\(\beta^{\alpha^{\text{ANC}}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>u_rho_x</code></td>
<td><span class="math inline">\(\mathbf{w}^\rho_x\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>us_rho_x</code></td>
<td><span class="math inline">\(\mathbf{v}^\rho_x\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>u_rho_xs</code></td>
<td><span class="math inline">\(\mathbf{w}_x^{\rho, s = \text{M}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>us_rho_xs</code></td>
<td><span class="math inline">\(\mathbf{v}_x^{\rho, s = \text{M}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>u_rho_a</code></td>
<td><span class="math inline">\(\mathbf{u}^\rho_a\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{10}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>u_rho_as</code></td>
<td><span class="math inline">\(\mathbf{u}_a^{\rho, s = \text{M}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{10}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>u_rho_xa</code></td>
<td><span class="math inline">\(\mathbf{u}_x^{\rho, a &lt; 15}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td>Yes</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>u_alpha_x</code></td>
<td><span class="math inline">\(\mathbf{w}^\alpha_x\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>us_alpha_x</code></td>
<td><span class="math inline">\(\mathbf{v}^\alpha_x\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>u_alpha_xs</code></td>
<td><span class="math inline">\(\mathbf{w}_x^{\alpha, s = \text{M}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>us_alpha_xs</code></td>
<td><span class="math inline">\(\mathbf{v}_x^{\alpha, s = \text{M}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>u_alpha_a</code></td>
<td><span class="math inline">\(\mathbf{u}^\alpha_a\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{13}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>u_alpha_as</code></td>
<td><span class="math inline">\(\mathbf{u}_a^{\alpha, s = \text{M}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{10}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>u_alpha_xa</code></td>
<td><span class="math inline">\(\mathbf{u}_x^{\alpha, a &lt; 15}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>ui_lambda_x</code></td>
<td><span class="math inline">\(\mathbf{u}_x^\lambda\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td><code>ui_anc_rho_x</code></td>
<td><span class="math inline">\(\mathbf{u}_x^{\rho^{\text{ANC}}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="even">
<td><code>ui_anc_alpha_x</code></td>
<td><span class="math inline">\(\mathbf{u}_x^{\alpha^{\text{ANC}}}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td>Yes</td>
<td></td>
</tr>
<tr class="odd">
<td><code>log_or_gamma</code></td>
<td><span class="math inline">\(\mathbf{u}_x^{\tilde \gamma}\)</span></td>
<td>Latent</td>
<td><span class="math inline">\(\mathbb{R}^{n}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="nuts-convergence-and-suitability-2" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">C.4</span> NUTS convergence and suitability<a href="fast-approximate-bayesian-inference.html#nuts-convergence-and-suitability-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:rhat"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/rhat.png" alt="The maximum potential scale reduction factor was 1.021, below the value of 1.05 typically used as a cutoff for acceptable chain mixing. Additionally, the vast majority (93.7%) of \(\hat R\) values were less than 1.1." width="95%" />
<p class="caption">
Figure C.5: The maximum potential scale reduction factor was 1.021, below the value of 1.05 typically used as a cutoff for acceptable chain mixing. Additionally, the vast majority (93.7%) of <span class="math inline">\(\hat R\)</span> values were less than 1.1.
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:ess"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/ess.png" alt="The efficiency of the NUTS, as measured by a ratio of effective sample size to iterations, was low for most parameters (Panel A). Many iterations were required for the the effective number of samples (mean 1265) obtained to be satisfactory (Panel B)." width="95%" />
<p class="caption">
Figure C.6: The efficiency of the NUTS, as measured by a ratio of effective sample size to iterations, was low for most parameters (Panel A). Many iterations were required for the the effective number of samples (mean 1265) obtained to be satisfactory (Panel B).
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:worst-trace"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/worst-trace.png" alt="Traceplots for the parameters with the lowest ESS (Panel A) and highest potential scale reduction factor (Panel B). These were log_sigma_alpha_xs (an \(\text{ESS}\) of 208) and ui_lambda_x[10] (an \(\hat R\) of 1.021)." width="95%" />
<p class="caption">
Figure C.7: Traceplots for the parameters with the lowest ESS (Panel A) and highest potential scale reduction factor (Panel B). These were <code>log_sigma_alpha_xs</code> (an <span class="math inline">\(\text{ESS}\)</span> of 208) and <code>ui_lambda_x[10]</code> (an <span class="math inline">\(\hat R\)</span> of 1.021).
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:rho-a"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/rho_a.png" alt="Pairs plots for log_sigma_rho_a and logit_phi_rho_a." width="95%" />
<p class="caption">
Figure C.8: Pairs plots for <code>log_sigma_rho_a</code> and <code>logit_phi_rho_a</code>.
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:alpha-x"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/alpha_x.png" alt="Pairs plots for log_sigma_alpha_x and logit_phi_alpha_x." width="95%" />
<p class="caption">
Figure C.9: Pairs plots for <code>log_sigma_alpha_x</code> and <code>logit_phi_alpha_x</code>.
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:posterior-contraction"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/posterior-contraction.png" alt="The posterior contraction for each parameter in the model. Values are averaged for parameters of length greater than one. A posterior contraction of zero corresponds to the prior distribution and posterior distribution having the same standard deviation. This could indicate that the data is not informative about the parameter. The closer the posterior contraction is to one, the more than the marginal posterior distribution has concentrated about a single point." width="95%" />
<p class="caption">
Figure C.10: The posterior contraction for each parameter in the model. Values are averaged for parameters of length greater than one. A posterior contraction of zero corresponds to the prior distribution and posterior distribution having the same standard deviation. This could indicate that the data is not informative about the parameter. The closer the posterior contraction is to one, the more than the marginal posterior distribution has concentrated about a single point.
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:nuts-hand-comparison"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/nuts-hand-comparison.png" alt="Prior standard deviations were calculated by using NUTS to simulate from the prior distribution. This approach is more convenient than simulating directly from the model, but can lead to inaccuracies." width="95%" />
<p class="caption">
Figure C.11: Prior standard deviations were calculated by using NUTS to simulate from the prior distribution. This approach is more convenient than simulating directly from the model, but can lead to inaccuracies.
</p>
</div>
</div>
<div id="use-of-pca-aghq-1" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">C.5</span> Use of PCA-AGHQ<a href="fast-approximate-bayesian-inference.html#use-of-pca-aghq-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:nodes-quantiles-sd"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/nodes-quantiles-sd.png" alt="The standard deviation of the quadrature nodes can be used as a measure of coverage of the posterior marginal distribution. Nodes spaced evenly within the marginal distribution would be expected to uniformly distributed quantile, corresponding to a standard deviation of 0.2911, shown as a dashed line." width="95%" />
<p class="caption">
Figure C.12: The standard deviation of the quadrature nodes can be used as a measure of coverage of the posterior marginal distribution. Nodes spaced evenly within the marginal distribution would be expected to uniformly distributed quantile, corresponding to a standard deviation of 0.2911, shown as a dashed line.
</p>
</div>
</div>
<div id="normalising-constant-estimation" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">C.6</span> Normalising constant estimation<a href="fast-approximate-bayesian-inference.html#normalising-constant-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="inference-comparison-2" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">C.7</span> Inference comparison<a href="fast-approximate-bayesian-inference.html#inference-comparison-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="point-estimates-1" class="section level3 hasAnchor" number="10.7.1">
<h3><span class="header-section-number">C.7.1</span> Point estimates<a href="fast-approximate-bayesian-inference.html#point-estimates-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:mean-alt-output"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/mean-alt-output.png" alt="Figure caption." width="95%" />
<p class="caption">
Figure C.13: Figure caption.
</p>
</div>

<div class="figure" style="text-align: centre"><span style="display:block;" id="fig:sd-alt-output"></span>
<img src="resources/naomi-aghq/20231221-174823-f8b954aa/depends/sd-alt-output.png" alt="Figure caption." width="95%" />
<p class="caption">
Figure C.14: Figure caption.
</p>
</div>
</div>
<div id="distributional-quantities-1" class="section level3 hasAnchor" number="10.7.2">
<h3><span class="header-section-number">C.7.2</span> Distributional quantities<a href="fast-approximate-bayesian-inference.html#distributional-quantities-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Akaike, Hirotugu. 1973. <span>“<span class="nocase">Information theory as an extension of the maximum likelihood principle–In: Second International Symposium on Information Theory (Eds) BN Petrov, F</span>.”</span> <em>Csaki. BNPBF Csaki Budapest: Academiai Kiado</em>.
</div>
<div class="csl-entry">
Aldor-Noiman, Sivan, Lawrence D Brown, Andreas Buja, Wolfgang Rolke, and Robert A Stine. 2013. <span>“<span class="nocase">The power to see: A new graphical test of normality</span>.”</span> <em>The American Statistician</em> 67 (4): 249–60.
</div>
<div class="csl-entry">
Arambepola, Rohan, Tim CD Lucas, Anita K Nandi, Peter W Gething, and Ewan Cameron. 2022. <span>“<span class="nocase">A simulation study of disaggregation regression for spatial disease mapping</span>.”</span> <em>Statistics in Medicine</em> 41 (1): 1–16.
</div>
<div class="csl-entry">
Auvert, Bertran, Dirk Taljaard, Emmanuel Lagarde, Joelle Sobngwi-Tambekou, Rémi Sitta, and Adrian Puren. 2005. <span>“<span class="nocase">Randomized, controlled intervention trial of male circumcision for reduction of HIV infection risk: the ANRS 1265 Trial</span>.”</span> <em>PLoS Medicine</em> 2 (11): e298.
</div>
<div class="csl-entry">
Bachl, Fabian E, Finn Lindgren, David L Borchers, and Janine B Illian. 2019. <span>“<span class="nocase">inlabru: an R package for Bayesian spatial modelling from ecological survey data</span>.”</span> <em>Methods in Ecology and Evolution</em> 10 (6): 760–66.
</div>
<div class="csl-entry">
Baeten, Jared M, Deborah Donnell, Patrick Ndase, Nelly R Mugo, James D Campbell, Jonathan Wangisi, Jordan W Tappero, et al. 2012. <span>“Antiretroviral Prophylaxis for HIV Prevention in Heterosexual Men and Women.”</span> <em>New England Journal of Medicine</em> 367 (5): 399–410.
</div>
<div class="csl-entry">
Bailey, Robert C, Stephen Moses, Corette B Parker, Kawango Agot, Ian Maclean, John N Krieger, Carolyn FM Williams, Richard T Campbell, and Jeckoniah O Ndinya-Achola. 2007. <span>“<span class="nocase">Male circumcision for HIV prevention in young men in Kisumu, Kenya: a randomised controlled trial</span>.”</span> <em>The Lancet</em> 369 (9562): 643–56.
</div>
<div class="csl-entry">
Baker, Stuart G. 1994. <span>“<span class="nocase">The multinomial-Poisson transformation</span>.”</span> <em>Journal of the Royal Statistical Society: Series D (The Statistician)</em> 43 (4): 495–504.
</div>
<div class="csl-entry">
Baral, Stefan, Chris Beyrer, Kathryn Muessig, Tonia Poteat, Andrea L Wirtz, Michele R Decker, Susan G Sherman, and Deanna Kerrigan. 2012. <span>“<span class="nocase">Burden of HIV among female sex workers in low-income and middle-income countries: a systematic review and meta-analysis</span>.”</span> <em><span>The Lancet Infectious Diseases</span></em> 12 (7): 538–49.
</div>
<div class="csl-entry">
Barré-Sinoussi, Françoise, Jean-Claude Chermann, Fran Rey, Marie Therese Nugeyre, Sophie Chamaret, Jacqueline Gruest, Charles Dauguet, et al. 1983. <span>“<span class="nocase">Isolation of a T-lymphotropic retrovirus from a patient at risk for acquired immune deficiency syndrome (AIDS)</span>.”</span> <em>Science</em> 220 (4599): 868–71.
</div>
<div class="csl-entry">
Baydin, Atılım Günes, Barak A Pearlmutter, Alexey Andreyevich Radul, and Jeffrey Mark Siskind. 2017. <span>“<span class="nocase">Automatic differentiation in machine learning: a survey</span>.”</span> <em>The Journal of Machine Learning Research</em> 18 (1): 5595–5637.
</div>
<div class="csl-entry">
Bell, Bradley. 2023. <span>“<span class="nocase">CppAD: a package for C++ algorithmic differentiation</span>.”</span> <a href="http://www.coin-or.org/CppAD" class="uri">http://www.coin-or.org/CppAD</a>.
</div>
<div class="csl-entry">
Bennett, James E, Helen Tamura-Wicks, Robbie M Parks, Richard T Burnett, C Arden Pope III, Matthew J Bechle, Julian D Marshall, Goodarz Danaei, and Majid Ezzati. 2019. <span>“<span class="nocase">Particulate matter air pollution and national and county life expectancy loss in the USA: A spatiotemporal analysis</span>.”</span> <em>PLoS Medicine</em> 16 (7): e1002856.
</div>
<div class="csl-entry">
Berger, James. 2006. <span>“<span class="nocase">The Case for objective Bayesian analysis</span>.”</span> <em>Bayesian Analysis</em> 1 (3): 385–402.
</div>
<div class="csl-entry">
Bernardo, José M, and Adrian FM Smith. 2001. <em><span class="nocase">Bayesian theory</span></em>. John Wiley &amp; Sons.
</div>
<div class="csl-entry">
Besag, Julian, Jeremy York, and Annie Mollié. 1991. <span>“<span class="nocase">Bayesian image restoration, with two applications in spatial statistics</span>.”</span> <em>Annals of the Institute of Statistical Mathematics</em> 43 (1): 1–20.
</div>
<div class="csl-entry">
Best, N, N Arnold, A Thomas, L Waller, and E Conlon. 1999. <span>“<span class="nocase">Bayesian models for spatially correlated disease and exposure data</span>.”</span> In <em>Bayesian Statistics 6: Proceedings of the Sixth Valencia International Meeting</em>, 6:131. Oxford University Press.
</div>
<div class="csl-entry">
Best, Nicky, Sylvia Richardson, and Andrew Thomson. 2005. <span>“<span class="nocase">A comparison of Bayesian spatial models for disease mapping</span>.”</span> <em>Statistical Methods in Medical Research</em> 14 (1): 35–59.
</div>
<div class="csl-entry">
Betancourt, Michael. 2017. <span>“<span class="nocase">Robust Gaussian processes in Stan</span>.”</span> <a href="https://betanalpha.github.io/assets/case\%5Fstudies/gp\%5Fpart3/part3.html">https://betanalpha.github.io/assets/case\%5Fstudies/gp\%5Fpart3/part3.html</a>.
</div>
<div class="csl-entry">
Bhatt, Samir, DJ Weiss, E Cameron, D Bisanzio, B Mappin, U Dalrymple, KE Battle, et al. 2015. <span>“<span class="nocase">The effect of malaria control on Plasmodium falciparum in Africa between 2000 and 2015</span>.”</span> <em>Nature</em> 526 (7572): 207–11.
</div>
<div class="csl-entry">
Bilodeau, Blair, Alex Stringer, and Yanbo Tang. 2022. <span>“<span class="nocase">Stochastic convergence rates and applications of adaptive quadrature in Bayesian inference</span>.”</span> <em>Journal of the American Statistical Association</em>, 1–11.
</div>
<div class="csl-entry">
Bivand, Roger S, Edzer J Pebesma, Virgilio Gómez-Rubio, and Edzer Jan Pebesma. 2008. <em><span class="nocase">Applied spatial data analysis with R</span></em>. Springer.
</div>
<div class="csl-entry">
Blangiardo, Marta, Michela Cameletti, Gianluca Baio, and Håvard Rue. 2013. <span>“<span class="nocase">Spatial and spatio-temporal models with R-INLA</span>.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 4: 33–49.
</div>
<div class="csl-entry">
Blei, David M, Alp Kucukelbir, and Jon D McAuliffe. 2017. <span>“<span class="nocase">Variational inference: A review for statisticians</span>.”</span> <em>Journal of the American Statistical Association</em> 112 (518): 859–77.
</div>
<div class="csl-entry">
Bolker, Benjamin M, Beth Gardner, Mark Maunder, Casper W Berg, Mollie Brooks, Liza Comita, Elizabeth Crone, et al. 2013. <span>“<span class="nocase">Strategies for fitting nonlinear ecological models in R, AD Model Builder, and BUGS</span>.”</span> <em>Methods in Ecology and Evolution</em> 4 (6): 501–12.
</div>
<div class="csl-entry">
Bollhöfer, Matthias, Olaf Schenk, Radim Janalik, Steve Hamm, and Kiran Gullapalli. 2020. <span>“<span class="nocase">State-of-the-art sparse direct solvers</span>.”</span> <em>Parallel Algorithms in Computational Science and Engineering</em>, 3–33.
</div>
<div class="csl-entry">
Bosse, Nikos I, Sam Abbott, Anne Cori, Edwin van Leeuwen, Johannes Bracher, and Sebastian Funk. 2023. <span>“<span class="nocase">Scoring epidemiological forecasts on transformed scales</span>.”</span> <em>PLoS Computational Biology</em> 19 (8): e1011393.
</div>
<div class="csl-entry">
Bosse, Nikos I., Hugo Gruson, Anne Cori, Edwin van Leeuwen, Sebastian Funk, and Sam Abbott. 2022. <span>“<span class="nocase">Evaluating Forecasts with scoringutils in R</span>.”</span> arXiv. <a href="https://arxiv.org/abs/2205.07090">https://arxiv.org/abs/2205.07090</a>.
</div>
<div class="csl-entry">
Box, George EP, and Kenneth B Wilson. 1992. <span>“<span class="nocase">On the experimental attainment of optimum conditions</span>.”</span> In <em>Breakthroughs in Statistics: Methodology and Distribution</em>, 270–310. Springer.
</div>
<div class="csl-entry">
Breslow, Norman E, and David G Clayton. 1993. <span>“<span class="nocase">Approximate inference in generalized linear mixed models</span>.”</span> <em>Journal of the American Statistical Association</em> 88 (421): 9–25.
</div>
<div class="csl-entry">
Brier, Glenn W. 1950. <span>“<span class="nocase">Verification of forecasts expressed in terms of probability</span>.”</span> <em>Monthly Weather Review</em> 78 (1): 1–3.
</div>
<div class="csl-entry">
Brooks, Mollie E, Kasper Kristensen, Koen J Van Benthem, Arni Magnusson, Casper W Berg, Anders Nielsen, Hans J Skaug, Martin Machler, and Benjamin M Bolker. 2017. <span>“<span class="nocase">glmmTMB balances speed and flexibility among packages for zero-inflated generalized linear mixed modeling</span>.”</span> <em><span>The R Journal</span></em> 9 (2): 378–400.
</div>
<div class="csl-entry">
Brown, Patrick E. 2015. <span>“<span class="nocase">Model-based geostatistics the easy way</span>.”</span> <em>Journal of Statistical Software</em> 63: 1–24.
</div>
<div class="csl-entry">
Broyles, Laura N, Robert Luo, Debi Boeras, and Lara Vojnov. 2023. <span>“<span class="nocase">The risk of sexual transmission of HIV in individuals with low-level HIV viraemia: a systematic review</span>.”</span> <em>The Lancet</em>.
</div>
<div class="csl-entry">
Brugh, Kristen N, Quinn Lewis, Cameron Haddad, Jon Kumaresan, Timothy Essam, and Michelle S Li. 2021. <span>“<span class="nocase">Characterizing and mapping the spatial variability of HIV risk among adolescent girls and young women: A cross-county analysis of population-based surveys in Eswatini, Haiti, and Mozambique</span>.”</span> <em>PLoS One</em> 16 (12): e0261520.
</div>
<div class="csl-entry">
Carpenter, Bob, Andrew Gelman, Matthew D Hoffman, Daniel Lee, Ben Goodrich, Michael Betancourt, Marcus Brubaker, Jiqiang Guo, Peter Li, and Allen Riddell. 2017. <span>“<span class="nocase">Stan: A probabilistic programming language</span>.”</span> <em>Journal of Statistical Software</em> 76 (1).
</div>
<div class="csl-entry">
Casella, George. 1985. <span>“<span class="nocase">An introduction to empirical Bayes data analysis</span>.”</span> <em>The American Statistician</em> 39 (2): 83–87.
</div>
<div class="csl-entry">
CDC. 2014. <span>“Understanding the <span>HIV</span> Care Continuum.”</span> CDC. <a href="http://www.cdc.gov/hiv/pdf/dhap_continuum.pdf">http://www.cdc.gov/hiv/pdf/dhap_continuum.pdf</a>.
</div>
<div class="csl-entry">
Chau, Siu Lun, Shahine Bouabid, and Dino Sejdinovic. 2021. <span>“<span class="nocase">Deconditional downscaling with Gaussian processes</span>.”</span> <em>Advances in Neural Information Processing Systems</em> 34: 17813–25.
</div>
<div class="csl-entry">
Chen, Cici, Jon Wakefield, and Thomas Lumely. 2014. <span>“<span class="nocase">The use of sampling weights in Bayesian hierarchical models for small area estimation</span>.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 11: 33–43.
</div>
<div class="csl-entry">
Chopin, Nicolas, Omiros Papaspiliopoulos, et al. 2020. <em><span class="nocase">An introduction to sequential Monte Carlo</span></em>. Vol. 4. Springer.
</div>
<div class="csl-entry">
Cleland, John, J Ties Boerma, Michel Caraël, and Sharon S Weir. 2004. <span>“<span class="nocase">Monitoring sexual behaviour in general populations: a synthesis of lessons of the past decade</span>.”</span> <em>Sexually Transmitted Infections</em> 80 (suppl 2): ii1–7.
</div>
<div class="csl-entry">
Cohen, Myron S, Ying Q Chen, Marybeth McCauley, Theresa Gamble, Mina C Hosseinipour, Nagalingeswaran Kumarasamy, James G Hakim, et al. 2011. <span>“<span class="nocase">Prevention of HIV-1 infection with early antiretroviral therapy</span>.”</span> <em>New England Journal of Medicine</em> 365 (6): 493–505.
</div>
<div class="csl-entry">
Cramb, SM, EW Duncan, PD Baade, and KL Mengersen. 2018. <span>“<span class="nocase">Investigation of Bayesian spatial models</span>.”</span> Cancer Council Queensland; Queensland University of Technology (QUT).
</div>
<div class="csl-entry">
Crampin, Amelia C, Albert Dube, Sebastian Mboma, Alison Price, Menard Chihana, Andreas Jahn, Angela Baschieri, et al. 2012. <span>“<span class="nocase">Profile: the Karonga health and demographic surveillance system</span>.”</span> <em><span>International Journal of Epidemiology</span></em> 41 (3): 676–85.
</div>
<div class="csl-entry">
Cressie, Noel, and Christopher K Wikle. 2015. <em><span class="nocase">Statistics for spatio-temporal data</span></em>. John Wiley &amp; Sons.
</div>
<div class="csl-entry">
Csárdi, Gábor. 2023. <em><span class="nocase">cranlogs: Download Logs from the ’RStudio’ ’CRAN’ Mirror</span></em>.
</div>
<div class="csl-entry">
Davis, Philip J, and Philip Rabinowitz. 1975. <em><span class="nocase">Methods of numerical integration</span></em>. Academic Press.
</div>
<div class="csl-entry">
Dawid, A Philip. 1984. <span>“<span class="nocase">Present position and potential developments: Some personal views statistical theory the prequential approach</span>.”</span> <em>Journal of the Royal Statistical Society: Series A (General)</em> 147 (2): 278–90.
</div>
<div class="csl-entry">
de Valpine, Perry, Christopher Paciorek, Daniel Turek, Nick Michaud, Cliff Anderson-Bergman, Fritz Obermeyer, Claudia Wehrhahn Cortes, Abel Rodrìguez, Duncan Temple Lang, and Sally Paganin. 2023. <em><span>NIMBLE User Manual</span></em> (version 1.0.1). <a href="https://doi.org/10.5281/zenodo.1211190">https://doi.org/10.5281/zenodo.1211190</a>.
</div>
<div class="csl-entry">
Dean, CB, MD Ugarte, and AF Militino. 2001. <span>“<span class="nocase">Detecting interaction between random region and fixed age effects in disease mapping</span>.”</span> <em>Biometrics</em> 57 (1): 197–202.
</div>
<div class="csl-entry">
Dempster, Arthur P, Nan M Laird, and Donald B Rubin. 1977. <span>“<span class="nocase">Maximum likelihood from incomplete data via the EM algorithm</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 39 (1): 1–22.
</div>
<div class="csl-entry">
Dennis Jr, John E, David M Gay, and Roy E Walsh. 1981. <span>“<span class="nocase">An adaptive nonlinear least-squares algorithm</span>.”</span> <em>ACM Transactions on Mathematical Software (TOMS)</em> 7 (3): 348–68.
</div>
<div class="csl-entry">
Diaz, Jose Monsalve, Swaroop Pophale, Oscar Hernandez, David E Bernholdt, and Sunita Chandrasekaran. 2018. <span>“<span class="nocase">OpenMP 4.5 Validation and Verification Suite for Device Offload</span>.”</span> In <em>Evolving OpenMP for Evolving Architectures: 14th International Workshop on OpenMP, IWOMP 2018, Barcelona, Spain, September 26–28, 2018, Proceedings 14</em>, 82–95. Springer.
</div>
<div class="csl-entry">
Diggle, Peter J, and Emanuele Giorgi. 2016. <span>“<span class="nocase">Model-based geostatistics for prevalence mapping in low-resource settings</span>.”</span> <em>Journal of the American Statistical Association</em> 111 (515): 1096–1120.
</div>
<div class="csl-entry">
Diggle, Peter J, Paula Moraga, Barry Rowlingson, Benjamin M Taylor, et al. 2013. <span>“<span class="nocase">Spatial and spatio-temporal log-Gaussian Cox processes: extending the geostatistical paradigm</span>.”</span> <em>Statistical Science</em> 28 (4): 542–63.
</div>
<div class="csl-entry">
Dominguez, Kenneth L., Dawn K. Smith, Vasavi Thomas, Nicole Crepaz, Karen Lang, Walid Heneine, Janet M. McNicholl, et al. 2016. <span>“Updated Guidelines for Antiretroviral Postexposure Prophylaxis After Sexual, Injection Drug Use, or Other Nonoccupational Exposure to HIV—United States, 2016.”</span> <a href="https://stacks.cdc.gov/view/cdc/38856">https://stacks.cdc.gov/view/cdc/38856</a>.
</div>
<div class="csl-entry">
Donegan, Connor. 2022. <span>“<span class="nocase">geostan: An R package for Bayesian spatial analysis</span>.”</span> <em>The Journal of Open Source Software</em> 7 (79): 4716. <a href="https://doi.org/10.21105/joss.04716">https://doi.org/10.21105/joss.04716</a>.
</div>
<div class="csl-entry">
Duane, Simon, Anthony D Kennedy, Brian J Pendleton, and Duncan Roweth. 1987. <span>“<span>Hybrid Monte Carlo</span>.”</span> <em>Physics Letters B</em> 195 (2): 216–22.
</div>
<div class="csl-entry">
Duncan, Earl W, Nicole M White, and Kerrie Mengersen. 2017. <span>“<span class="nocase">Spatial smoothing in Bayesian models: a comparison of weights matrix specifications and their impact on inference</span>.”</span> <em>International Journal of Health Geographics</em> 16 (1): 1–16.
</div>
<div class="csl-entry">
Dwyer-Lindgren, Laura, Michael A Cork, Amber Sligar, Krista M Steuben, Kate F Wilson, Naomi R Provost, Benjamin K Mayala, et al. 2019. <span>“<span class="nocase">Mapping HIV prevalence in sub-Saharan Africa between 2000 and 2017</span>.”</span> <em>Nature</em> 570 (7760): 189–93.
</div>
<div class="csl-entry">
Dwyer-Lindgren, Laura, Abraham D Flaxman, Marie Ng, Gillian M Hansen, Christopher JL Murray, and Ali H Mokdad. 2015. <span>“<span class="nocase">Drinking patterns in US counties from 2002 to 2012</span>.”</span> <em>American Journal of Public Health</em> 105 (6): 1120–27.
</div>
<div class="csl-entry">
Eaton, Jeffrey W, Laura Dwyer-Lindgren, Steve Gutreuter, Megan O’Driscoll, Oliver Stevens, Sumali Bajaj, Rob Ashton, et al. 2021. <span>“<span class="nocase">Naomi: a new modelling tool for estimating HIV epidemic indicators at the district level in sub-Saharan Africa</span>.”</span> <em>Journal of the International AIDS Society</em> 24: e25788.
</div>
<div class="csl-entry">
Economist Impact. 2023. <span>“<span class="nocase">A triple dividend: the health, social and economic gains from financing the HIV response in Africa</span>.”</span>
</div>
<div class="csl-entry">
Esra, Rachel. 2023. <span>“<span class="nocase">Improved indicators for subnational unmet antiretroviral therapy need in the health system: updates to the Naomi model in 2023</span>.”</span>
</div>
<div class="csl-entry">
Fattah, EA, JV Niekerk, and H Rue. 2022. <span>“<span class="nocase">Smart gradient-an adaptive technique for improving gradient estimation</span>.”</span> <em>Foundations of Data Science</em>.
</div>
<div class="csl-entry">
Fisher, Ronald Aylmer. 1936. <span>“<span class="nocase">Design of experiments</span>.”</span> <em>British Medical Journal</em> 1 (3923): 554.
</div>
<div class="csl-entry">
FitzJohn, Rich, Robert Ashton, Alex Hill, Martin Eden, Wes Hinsley, Emma Russell, and James Thompson. 2023. <em>Orderly: Lightweight Reproducible Reporting</em>.
</div>
<div class="csl-entry">
Flaxman, Seth R, Yu-Xiang Wang, and Alexander J Smola. 2015. <span>“<span class="nocase">Who supported Obama in 2012? Ecological inference through distribution regression</span>.”</span> In <em>Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 289–98.
</div>
<div class="csl-entry">
Follestad, Turid, and Håvard Rue. 2003. <span>“<span class="nocase">Modelling spatial variation in disease risk using Gaussian Markov random field proxies for Gaussian random fields</span>.”</span>
</div>
<div class="csl-entry">
Fournier, David A, Hans J Skaug, Johnoel Ancheta, James Ianelli, Arni Magnusson, Mark N Maunder, Anders Nielsen, and John Sibert. 2012. <span>“<span class="nocase">AD Model Builder: using automatic differentiation for statistical inference of highly parameterized complex nonlinear models</span>.”</span> <em>Optimization Methods and Software</em> 27 (2): 233–49.
</div>
<div class="csl-entry">
Freni-Sterrantino, Anna, Massimo Ventrucci, and Håvard Rue. 2018. <span>“<span class="nocase">A note on intrinsic conditional autoregressive models for disconnected graphs</span>.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 26: 25–34.
</div>
<div class="csl-entry">
Fuglstad, Geir-Arne, Daniel Simpson, Finn Lindgren, and Håvard Rue. 2019. <span>“<span class="nocase">Constructing priors that penalize the complexity of Gaussian random fields</span>.”</span> <em>Journal of the American Statistical Association</em> 114 (525): 445–52.
</div>
<div class="csl-entry">
Gaedke-Merzhäuser, Lisa, Janet van Niekerk, Olaf Schenk, and Håvard Rue. 2023. <span>“<span class="nocase">Parallelized integrated nested Laplace approximations for fast Bayesian inference</span>.”</span> <em>Statistics and Computing</em> 33 (1): 25.
</div>
<div class="csl-entry">
Garnier, Simon, Ross, Noam, Rudis, Robert, Camargo, et al. 2023. <em><span class="nocase">viridis(Lite) - Colorblind-Friendly Color Maps for R</span></em>. <a href="https://doi.org/10.5281/zenodo.4679423">https://doi.org/10.5281/zenodo.4679423</a>.
</div>
<div class="csl-entry">
Gärtner, Thomas, Peter A Flach, Adam Kowalczyk, and Alexander J Smola. 2002. <span>“<span class="nocase">Multi-instance kernels</span>.”</span> In <em>ICML</em>, 2:7. 3.
</div>
<div class="csl-entry">
Gelfand, Alan E, Li Zhu, and Bradley P Carlin. 2001. <span>“<span class="nocase">On the change of support problem for spatio-temporal data</span>.”</span> <em>Biostatistics</em> 2 (1): 31–45.
</div>
<div class="csl-entry">
Gelman, Andrew. 2005. <span>“<span class="nocase">Analysis of variance—why it is more important than ever</span>.”</span>
</div>
<div class="csl-entry">
———. 2006. <span>“<span class="nocase">Prior distributions for variance parameters in hierarchical models (comment on article by Browne and Draper)</span>.”</span> <em>Bayesian Analysis</em> 1 (3): 515–34.
</div>
<div class="csl-entry">
———. 2007. <span>“<span class="nocase">Struggles with survey weighting and regression modeling</span>.”</span>
</div>
<div class="csl-entry">
Gelman, Andrew, John B Carlin, Hal S Stern, David B Dunson, Aki Vehtari, and Donald B Rubin. 2013. <em><span class="nocase">Bayesian data analysis</span></em>. CRC press.
</div>
<div class="csl-entry">
Gelman, Andrew, Jessica Hwang, and Aki Vehtari. 2014. <span>“<span class="nocase">Understanding predictive information criteria for Bayesian models</span>.”</span> <em>Statistics and Computing</em> 24 (6): 997–1016.
</div>
<div class="csl-entry">
Gelman, Andrew, and Donald B Rubin. 1992. <span>“<span class="nocase">Inference from iterative simulation using multiple sequences</span>.”</span> <em>Statistical Science</em>, 457–72.
</div>
<div class="csl-entry">
Gelman, Andrew, Daniel Simpson, and Michael Betancourt. 2017. <span>“<span class="nocase">The prior can often only be understood in the context of the likelihood</span>.”</span> <em>Entropy</em> 19 (10): 555.
</div>
<div class="csl-entry">
Gelman, Andrew, Aki Vehtari, Daniel Simpson, Charles C Margossian, Bob Carpenter, Yuling Yao, Lauren Kennedy, Jonah Gabry, Paul-Christian Bürkner, and Martin Modrák. 2020. <span>“<span class="nocase">Bayesian workflow</span>.”</span> <em>arXiv Preprint arXiv:2011.01808</em>.
</div>
<div class="csl-entry">
Geman, Stuart, and Donald Geman. 1984. <span>“<span class="nocase">Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images</span>.”</span> <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, no. 6: 721–41.
</div>
<div class="csl-entry">
Giordano, Ryan, Tamara Broderick, and Michael I. Jordan. 2018. <span>“<span class="nocase">Covariances, Robustness, and Variational Bayes</span>.”</span> <em>Journal of Machine Learning Research</em> 19 (51): 1–49. <a href="http://jmlr.org/papers/v19/17-670.html">http://jmlr.org/papers/v19/17-670.html</a>.
</div>
<div class="csl-entry">
Global Burden of Disease Collaborative Network. 2019. <span>“<span class="nocase">Global Burden of Disease Study 2019 (GBD 2019) Results.</span>”</span> <span>Institute for Health Metrics and Evaluation (IHME)</span>. <a href="https://vizhub.healthdata.org/gbd-results/">https://vizhub.healthdata.org/gbd-results/</a>.
</div>
<div class="csl-entry">
Glynn, Judith R, Ndoliwe Kayuni, Emmanuel Banda, Fiona Parrott, Sian Floyd, Monica Francis-Chizororo, Misheck Nkhata, et al. 2011. <span>“<span class="nocase">Assessing the validity of sexual behaviour reports in a whole population survey in rural Malawi</span>.”</span> <em><span>PLoS One</span></em> 6 (7): e22840.
</div>
<div class="csl-entry">
Gneiting, Tilmann, and Adrian E Raftery. 2007. <span>“<span class="nocase">Strictly proper scoring rules, prediction, and estimation</span>.”</span> <em>Journal of the American Statistical Association</em> 102 (477): 359–78.
</div>
<div class="csl-entry">
Godfrey-Faussett, Peter, Luisa Frescura, Quarraisha Abdool Karim, Michaela Clayton, Peter D Ghys, and 2025 prevention targets working group). 2022. <span>“HIV Prevention for the Next Decade: Appropriate, Person-Centred, Prioritised, Effective, Combination Prevention.”</span> <em>PLoS Medicine</em> 19 (9): e1004102.
</div>
<div class="csl-entry">
Goldstein, Michael. 2006. <span>“<span class="nocase">Subjective Bayesian analysis: principles and practice</span>.”</span>
</div>
<div class="csl-entry">
Gómez-Rubio, Virgilio. 2020. <em><span class="nocase">Bayesian inference with INLA</span></em>. CRC Press.
</div>
<div class="csl-entry">
Gössl, Christoff, Dorothee P Auer, and Ludwig Fahrmeir. 2001. <span>“<span class="nocase">Bayesian spatiotemporal inference in functional magnetic resonance imaging</span>.”</span> <em>Biometrics</em> 57 (2): 554–62.
</div>
<div class="csl-entry">
Gottlieb, Michael S, Howard M Schanker, Peng Thim Fan, Andrew Saxon, Joel D Weisman, Irving Pozalski, et al. 1981. <span>“<span class="nocase">Pneumocystis pneumonia—Los Angeles</span>.”</span> <em>Morbidity and Mortality Weekly Report</em> 30 (21): 1–3.
</div>
<div class="csl-entry">
Grabowski, M Kate, David M Serwadda, Ronald H Gray, Gertrude Nakigozi, Godfrey Kigozi, Joseph Kagaayi, Robert Ssekubugu, et al. 2017. <span>“<span class="nocase">HIV prevention efforts and incidence of HIV in Uganda</span>.”</span> <em>New England Journal of Medicine</em> 377 (22): 2154–66.
</div>
<div class="csl-entry">
Gray, Ronald H, Godfrey Kigozi, David Serwadda, Frederick Makumbi, Stephen Watya, Fred Nalugoda, Noah Kiwanuka, et al. 2007. <span>“<span class="nocase">Male circumcision for HIV prevention in men in Rakai, Uganda: a randomised trial</span>.”</span> <em>The Lancet</em> 369 (9562): 657–66.
</div>
<div class="csl-entry">
Gregson, Simon, Geoffrey P Garnett, Constance A Nyamukapa, Timothy B Hallett, James JC Lewis, Peter R Mason, Stephen K Chandiwana, and Roy M Anderson. 2006. <span>“<span class="nocase">HIV decline associated with behavior change in eastern Zimbabwe</span>.”</span> <em>Science</em> 311 (5761): 664–66.
</div>
<div class="csl-entry">
Haining, Robert P. 2003. <em><span class="nocase">Spatial data analysis: theory and practice</span></em>. Cambridge University Press.
</div>
<div class="csl-entry">
Hájek, Jaroslav. 1971. <span>“<span class="nocase">Discussion of <span>‘An essay on the logical foundations of survey sampling, part I’</span></span>.”</span> <em>Foundations of Statistical Inference (Proc. Sympos., Univ. Waterloo, Ontario, 1970)</em>, 236.
</div>
<div class="csl-entry">
Hamelijnck, O, T Damoulas, K Wang, and MA Girolami. 2019. <span>“<span class="nocase">Multi-resolution multi-task Gaussian processes</span>.”</span> <em>Advances in Neural Information Processing Systems</em> 32.
</div>
<div class="csl-entry">
Hastie, Trevor, and Robert Tibshirani. 1987. <span>“<span class="nocase">Generalized additive models: some applications</span>.”</span> <em>Journal of the American Statistical Association</em> 82 (398): 371–86.
</div>
<div class="csl-entry">
Hastings, W Keith. 1970. <span>“<span class="nocase">Monte Carlo sampling methods using Markov chains and their applications</span>.”</span>
</div>
<div class="csl-entry">
Helleringer, Stéphane, Hans-Peter Kohler, Linda Kalilani-Phiri, James Mkandawire, and Benjamin Armbruster. 2011. <span>“<span class="nocase">The reliability of sexual partnership histories: implications for the measurement of partnership concurrency during surveys</span>.”</span> <em>AIDS (London, England)</em> 25 (4): 503.
</div>
<div class="csl-entry">
Hodgins, Caroline, James Stannah, Salome Kuchukhidze, Lycias Zembe, Jeffrey W Eaton, Marie-Claude Boily, and Mathieu Maheu-Giroux. 2022. <span>“<span class="nocase">Population sizes, HIV prevalence, and HIV prevention among men who paid for sex in sub-Saharan Africa (2000–2020): A meta-analysis of 87 population-based surveys</span>.”</span> <em>PLoS Medicine</em> 19 (1): e1003861.
</div>
<div class="csl-entry">
Hoffman, Matthew D, Andrew Gelman, et al. 2014. <span>“<span class="nocase">The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo.</span>”</span> <em>J. Mach. Learn. Res.</em> 15 (1): 1593–623.
</div>
<div class="csl-entry">
Howes, Adam. 2023. <em><span class="nocase">arealutils: Utility functions for beyond-borders</span></em>.
</div>
<div class="csl-entry">
Howes, Adam, Kathryn A. Risher, Van Kính Nguyen, Oliver Stevens, Katherine M. Jia, Timothy M. Wolock, Rachel T. Esra, et al. 2023. <span>“<span class="nocase">Spatio-temporal estimates of HIV risk group proportions for adolescent girls and young women across 13 priority countries in sub-Saharan Africa</span>.”</span> <em>PLOS Global Public Health</em> 3 (4): 1–14. <a href="https://doi.org/10.1371/journal.pgph.0001731">https://doi.org/10.1371/journal.pgph.0001731</a>.
</div>
<div class="csl-entry">
ICAP. 2023. <span>“<span class="nocase">Population-based HIV impact assessment: guiding the global HIV response</span>.”</span> <a href="https://phia.icap.columbia.edu">https://phia.icap.columbia.edu</a>.
</div>
<div class="csl-entry">
Jäckel, Peter. 2005. <span>“<span class="nocase">A note on multivariate Gauss-Hermite quadrature</span>.”</span> <em>London: ABN-Amro. Re</em>.
</div>
<div class="csl-entry">
Jia, Katherine M, Hallie Eilerts, Olanrewaju Edun, Kevin Lam, Adam Howes, Matthew L Thomas, and Jeffrey W Eaton. 2022. <span>“<span class="nocase">Risk scores for predicting HIV incidence among adult heterosexual populations in sub-Saharan Africa: a systematic review and meta-analysis</span>.”</span> <em>Journal of the International AIDS Society</em> 25 (1): e25861.
</div>
<div class="csl-entry">
Jin, Harry, Arjee Restar, and Chris Beyrer. 2021. <span>“Overview of the Epidemiological Conditions of HIV Among Key Populations in Africa.”</span> <em>Journal of the International AIDS Society</em> 24: e25716.
</div>
<div class="csl-entry">
Johnson, L, and RE Dorrington. 2020. <span>“<span class="nocase">Thembisa version 4.3: A model for evaluating the impact of HIV/AIDS in South Africa</span>.”</span> <em>View Article</em>.
</div>
<div class="csl-entry">
Johnson, Olatunji, Peter Diggle, and Emanuele Giorgi. 2019. <span>“<span class="nocase">A spatially discrete approximation to log-Gaussian Cox processes for modelling aggregated disease count data</span>.”</span> <em>Statistics in Medicine</em> 38 (24): 4871–87.
</div>
<div class="csl-entry">
Kassanjee, Reshma, Thomas A. McWalter, Till Bärnighausen, and Alex Welte. 2012. <span>“A New General Biomarker-Based Incidence Estimator.”</span> <em>Epidemiology</em> 23 (5).
</div>
<div class="csl-entry">
Kelsall, Julia, and Jonathan Wakefield. 2002. <span>“<span class="nocase">Modeling spatial variation in disease risk: a geostatistical approach</span>.”</span> <em>Journal of the American Statistical Association</em> 97 (459): 692–701.
</div>
<div class="csl-entry">
Khoury, Muin J, Michael F Iademarco, and William T Riley. 2016. <span>“<span class="nocase">Precision public health for the era of precision medicine</span>.”</span> <em>American Journal of Preventive Medicine</em> 50 (3): 398–401.
</div>
<div class="csl-entry">
Kish, Leslie. 1965. <em><span class="nocase">Survey sampling</span></em>. 04; HN29, K5.
</div>
<div class="csl-entry">
Knorr-Held, Leonhard. 2000. <span>“<span class="nocase">Bayesian modelling of inseparable space-time variation in disease risk</span>.”</span> <em>Statistics in Medicine</em> 19 (17-18): 2555–67.
</div>
<div class="csl-entry">
Konstantinoudis, Garyfallos, Dominic Schuhmacher, Håvard Rue, and Ben D Spycher. 2020. <span>“<span class="nocase">Discrete versus continuous domain models for disease mapping</span>.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 32: 100319.
</div>
<div class="csl-entry">
Kristensen, Kasper. 2021. <span>“<span class="nocase">The comprehensive TMB documentation</span>.”</span> <a href="https://kaskr.github.io/adcomp/_book/Introduction.html" class="uri">https://kaskr.github.io/adcomp/_book/Introduction.html</a>.
</div>
<div class="csl-entry">
Kristensen, Kasper, Anders Nielsen, Casper W Berg, Hans Skaug, Bradley M Bell, et al. 2016. <span>“<span class="nocase">TMB: Automatic Differentiation and Laplace Approximation</span>.”</span> <em>Journal of Statistical Software</em> 70 (i05).
</div>
<div class="csl-entry">
Laplace, P. S. 1774. <span>“<span class="nocase">Memoire sur la probabilite de causes par les evenements</span>.”</span> <em>Memoire de l’Academie Royale Des Sciences</em>.
</div>
<div class="csl-entry">
Law, Ho Chung, Dino Sejdinovic, Ewan Cameron, Tim Lucas, Seth Flaxman, Katherine Battle, and Kenji Fukumizu. 2018. <span>“<span class="nocase">Variational learning on aggregate outputs with Gaussian processes</span>.”</span> <em>Advances in Neural Information Processing Systems</em> 31.
</div>
<div class="csl-entry">
Lee, Duncan. 2011. <span>“<span class="nocase">A comparison of conditional autoregressive models used in Bayesian disease mapping</span>.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 2 (2): 79–89.
</div>
<div class="csl-entry">
Lenth, Russell. 2009. <span>“<span class="nocase">Response-Surface Methods in R, Using rsm</span>.”</span> <em>Journal of Statistical Software</em> 32 (7): 1–17. <a href="https://doi.org/10.18637/jss.v032.i07">https://doi.org/10.18637/jss.v032.i07</a>.
</div>
<div class="csl-entry">
Leppik, IE, FE Dreifuss, T Bowman-Cloyd, N Santilli, M Jacobs, C Crosby, J Cloyd, et al. 1985. <span>“<span class="nocase">A double-blind crossover evaluation of progabide in partial seizures</span>.”</span> <em>Neurology</em> 35 (4): 285.
</div>
<div class="csl-entry">
Leroux, Brian G, Xingye Lei, and Norman Breslow. 2000. <span>“<span class="nocase">Estimation of disease rates in small areas: a new mixed model for spatial dependence</span>.”</span> In <em>Statistical Models in Epidemiology, the Environment, and Clinical Trials</em>, 179–91. Springer.
</div>
<div class="csl-entry">
Li, Ye, Patrick Brown, Dionne C Gesink, and Håvard Rue. 2012. <span>“<span class="nocase">Log Gaussian Cox processes and spatially aggregated disease incidence data</span>.”</span> <em>Statistical Methods in Medical Research</em> 21 (5): 479–507. <a href="https://doi.org/10.1177/0962280212446326">https://doi.org/10.1177/0962280212446326</a>.
</div>
<div class="csl-entry">
Li, Ye, Patrick Brown, Håvard Rue, Mustafa Al-Maini, and Paul Fortin. 2012. <span>“<span class="nocase">Spatial modelling of lupus incidence over 40 years with changes in census areas</span>.”</span> <em>Journal of the Royal Statistical Society Series C: Applied Statistics</em> 61 (1): 99–115.
</div>
<div class="csl-entry">
Lindgren, Finn, Håvard Rue, and Johan Lindström. 2011. <span>“<span class="nocase">An explicit link between Gaussian fields and Gaussian Markov random fields: the stochastic partial differential equation approach</span>.”</span> <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em> 73 (4): 423–98.
</div>
<div class="csl-entry">
Margossian, Charles C. 2019. <span>“<span class="nocase">A review of automatic differentiation and its efficient implementation</span>.”</span> <em>Wiley Interdisciplinary Reviews: Data Mining and Knowledge Discovery</em> 9 (4): e1305.
</div>
<div class="csl-entry">
Margossian, Charles C, and Andrew Gelman. 2023. <span>“For How Many Iterations Should We Run Markov Chain Monte Carlo?”</span> <em>arXiv Preprint arXiv:2311.02726</em>.
</div>
<div class="csl-entry">
Margossian, Charles, Aki Vehtari, Daniel Simpson, and Raj Agrawal. 2020. <span>“<span class="nocase">Hamiltonian Monte Carlo using an adjoint-differentiated Laplace approximation: Bayesian inference for latent Gaussian models and beyond</span>.”</span> <em>Advances in Neural Information Processing Systems</em> 33: 9086–97.
</div>
<div class="csl-entry">
Martin, Gael M, David T Frazier, and Christian P Robert. 2023. <span>“<span class="nocase">Computing Bayes: From then ‘til now</span>.”</span> <em>Statistical Science</em> 1 (1): 1–17.
</div>
<div class="csl-entry">
Martino, Sara, and Andrea Riebler. 2020. <span>“<span>Integrated Nested Laplace Approximations (INLA)</span>.”</span> In <em>Wiley StatsRef: Statistics Reference Online</em>, 1–19. John Wiley &amp; Sons, Ltd. https://doi.org/<a href="https://doi.org/10.1002/9781118445112.stat08212">https://doi.org/10.1002/9781118445112.stat08212</a>.
</div>
<div class="csl-entry">
Martino, Sara, and Håvard Rue. 2009. <span>“<span class="nocase">Implementing approximate Bayesian inference using Integrated Nested Laplace Approximation: A manual for the inla program</span>.”</span> <em>Department of Mathematical Sciences, NTNU, Norway</em>.
</div>
<div class="csl-entry">
Martins, Thiago G, Daniel Simpson, Finn Lindgren, and Håvard Rue. 2013. <span>“<span class="nocase">Bayesian computing with INLA: new features</span>.”</span> <em>Computational Statistics &amp; Data Analysis</em> 67: 68–83.
</div>
<div class="csl-entry">
Matheson, James E, and Robert L Winkler. 1976. <span>“<span class="nocase">Scoring rules for continuous probability distributions</span>.”</span> <em>Management Science</em> 22 (10): 1087–96.
</div>
<div class="csl-entry">
Mayala, Benjamin K., Samir Bhatt, and Peter Gething. 2020. <span>“<span class="nocase">Predicting HIV/AIDS at Subnational Levels using DHS Covariates related to HIV</span>.”</span> DHS Spatial Analysis Reports 18. Rockville, Maryland, USA: ICF.
</div>
<div class="csl-entry">
McCullagh, Peter, and John A Nelder. 1989. <em><span class="nocase">Generalized linear models</span></em>. Routledge.
</div>
<div class="csl-entry">
McElreath, Richard. 2020. <em><span class="nocase">Statistical rethinking: A Bayesian course with examples in R and Stan</span></em>. CRC press.
</div>
<div class="csl-entry">
McGillen, Jessica B, John Stover, Daniel J Klein, Sinokuthemba Xaba, Getrude Ncube, Mutsa Mhangara, Geraldine N Chipendo, et al. 2018. <span>“The Emerging Health Impact of Voluntary Medical Male Circumcision in Zimbabwe: An Evaluation Using Three Epidemiological Models.”</span> <em>PloS One</em> 13 (7): e0199453.
</div>
<div class="csl-entry">
Meng, Xiao-Li. 2018. <span>“<span class="nocase">Statistical paradises and paradoxes in big data (i) law of large populations, big data paradox, and the 2016 us presidential election</span>.”</span> <em>The Annals of Applied Statistics</em> 12 (2): 685–726.
</div>
<div class="csl-entry">
Metropolis, Nicholas, Arianna W Rosenbluth, Marshall N Rosenbluth, Augusta H Teller, and Edward Teller. 1953. <span>“<span class="nocase">Equation of State Calculations by Fast Computing Machines</span>.”</span> <em>J. Chem. Phys</em> 21: 1087.
</div>
<div class="csl-entry">
Meyer-Rath, Gesine, Jessica B McGillen, Diego F Cuadros, Timothy B Hallett, Samir Bhatt, Njeri Wabiri, Frank Tanser, and Thomas Rehle. 2018. <span>“Targeting the Right Interventions to the Right People and Places: The Role of Geospatial Analysis in HIV Program Planning.”</span> <em>AIDS (London, England)</em> 32 (8): 957.
</div>
<div class="csl-entry">
Minka, Thomas P. 2001. <span>“<span class="nocase">Expectation Propagation for approximate Bayesian inference</span>.”</span> In <em>Proceedings of the 17th Conference in Uncertainty in Artificial Intelligence</em>, 362–69.
</div>
<div class="csl-entry">
Monnahan, Cole C, and Kasper Kristensen. 2018. <span>“<span class="nocase">No-U-turn sampling for fast Bayesian inference in ADMB and TMB: Introducing the adnuts and tmbstan R packages</span>.”</span> <em>PloS One</em> 13 (5): e0197954.
</div>
<div class="csl-entry">
Monod, Mélodie, Andrea Brizzi, Ronald M. Galiwango, Robert Ssekubugu, Yu Chen, Xiaoyue Xi, Edward Nelson Kankaka, et al. 2023. <span>“Longitudinal Population-Level HIV Epidemiologic and Genomic Surveillance Highlights Growing Gender Disparity of HIV Transmission in Uganda.”</span> <em>Nature Microbiology</em>.
</div>
<div class="csl-entry">
Morris, Mitzi, Katherine Wheeler-Martin, Dan Simpson, Stephen J. Mooney, Andrew Gelman, and Charles DiMaggio. 2019. <span>“<span class="nocase">Bayesian hierarchical spatial models: Implementing the Besag York Mollié model in stan</span>.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 31: 100301. https://doi.org/<a href="https://doi.org/10.1016/j.sste.2019.100301">https://doi.org/10.1016/j.sste.2019.100301</a>.
</div>
<div class="csl-entry">
Nandi, Anita K, Tim CD Lucas, Rohan Arambepola, Peter Gething, and Daniel J Weiss. 2023. <span>“<span class="nocase">disaggregation: An R Package for Bayesian Spatial Disaggregation Modeling</span>.”</span> <em>Journal of Statistical Software</em> 106: 1–19.
</div>
<div class="csl-entry">
Naylor, John C, and Adrian FM Smith. 1982. <span>“<span class="nocase">Applications of a method for the efficient computation of posterior distributions</span>.”</span> <em>Journal of the Royal Statistical Society Series C: Applied Statistics</em> 31 (3): 214–25.
</div>
<div class="csl-entry">
Neal, Radford M. 2003. <span>“<span class="nocase">Slice sampling</span>.”</span> <em>The Annals of Statistics</em> 31 (3): 705–67.
</div>
<div class="csl-entry">
Neal, Radford M et al. 2011. <span>“<span class="nocase">MCMC using Hamiltonian dynamics</span>.”</span> <em>Handbook of Markov Chain Monte Carlo</em> 2 (11): 2.
</div>
<div class="csl-entry">
Nguyen, Van Kính, and Jeffrey W. Eaton. 2022. <span>“<span class="nocase">Trends and country-level variation in age at first sex in sub-Saharan Africa among birth cohorts entering adulthood between 1985 and 2020</span>.”</span> <em>BMC Public Health</em> 22 (1): 1120. <a href="https://doi.org/10.1186/s12889-022-13451-y">https://doi.org/10.1186/s12889-022-13451-y</a>.
</div>
<div class="csl-entry">
Nnko, Soori, J Ties Boerma, Mark Urassa, Gabriel Mwaluko, and Basia Zaba. 2004. <span>“<span class="nocase">Secretive females or swaggering males?: An assessment of the quality of sexual partnership reporting in rural Tanzania</span>.”</span> <em><span>Social Science &amp; Medicine</span></em> 59 (2): 299–310.
</div>
<div class="csl-entry">
Okabe, Masataka, and Kei Ito. 2008. <span>“Color Universal Design (CUD): How to Make Figures and Presentations That Are Friendly to Colorblind People.”</span> 2008. <a href="http://jfly.iam.u-tokyo.ac.jp/color/">http://jfly.iam.u-tokyo.ac.jp/color/</a>.
</div>
<div class="csl-entry">
Openshaw, S, and P. J. Taylor. 1979. <span>“<span class="nocase">A million or so correlation coefficients, three experiments on the modifiable areal unit problem</span>.”</span> <em>Statistical Applications in the Spatial Science</em>, 127–44.
</div>
<div class="csl-entry">
Ord, Toby. 2013. <span>“<span class="nocase">The moral imperative toward cost-effectiveness in global health</span>.”</span> <em>Center for Global Development</em> 12.
</div>
<div class="csl-entry">
Organization, World Health et al. 2022. <em>Consolidated Guidelines on HIV, Viral Hepatitis and STI Prevention, Diagnosis, Treatment and Care for Key Populations</em>. World Health Organization.
</div>
<div class="csl-entry">
Osgood-Zimmerman, Aaron, and Jon Wakefield. 2023. <span>“<span class="nocase">A Statistical Review of Template Model Builder: A Flexible Tool for Spatial Modelling</span>.”</span> <em>International Statistical Review</em> 91 (2): 318–42.
</div>
<div class="csl-entry">
Paciorek, Christopher J et al. 2013. <span>“<span class="nocase">Spatial models for point and areal data using Markov random fields on a fine grid</span>.”</span> <em>Electronic Journal of Statistics</em> 7: 946–72.
</div>
<div class="csl-entry">
Paciorek, Christopher J., and Mark J. Schervish. 2006. <span>“<span class="nocase">Spatial modelling using a new class of nonstationary covariance functions</span>.”</span> <em>Environmetrics</em> 17 (5): 483–506. https://doi.org/<a href="https://doi.org/10.1002/env.785">https://doi.org/10.1002/env.785</a>.
</div>
<div class="csl-entry">
Parks, Robbie M, James E Bennett, Helen Tamura-Wicks, Vasilis Kontis, Ralf Toumi, Goodarz Danaei, and Majid Ezzati. 2020. <span>“<span class="nocase">Anomalously warm temperatures are associated with increased injury deaths</span>.”</span> <em>Nature Medicine</em> 26 (1): 65–70.
</div>
<div class="csl-entry">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R: Standardized Support for Spatial Vector Data</span>.”</span> <em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div class="csl-entry">
Pebesma, Edzer J. 2004. <span>“<span class="nocase">Multivariable geostatistics in S: the gstat package</span>.”</span> <em>Computers &amp; Geosciences</em> 30: 683–91.
</div>
<div class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2023. <em><span class="nocase">Spatial Data Science: With Applications in R</span></em>. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div class="csl-entry">
Pettit, LI. 1990. <span>“<span class="nocase">The conditional predictive ordinate for the normal distribution</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 52 (1): 175–84.
</div>
<div class="csl-entry">
Pfeffermann, Danny et al. 2013. <span>“<span class="nocase">New Important Developments in Small Area Estimation</span>.”</span> <em>Statistical Science</em> 28 (1): 40–68.
</div>
<div class="csl-entry">
Pisani, Elizabeth, Stefano Lazzari, Neff Walker, and Bernhard Schwartländer. 2003. <span>“<span class="nocase">HIV surveillance: a global perspective</span>.”</span> <em>JAIDS Journal of Acquired Immune Deficiency Syndromes</em> 32: S3–11.
</div>
<div class="csl-entry">
Porcu, Emilio, Reinhard Furrer, and Douglas Nychka. 2021. <span>“<span class="nocase">30 Years of space–time covariance functions</span>.”</span> <em>Wiley Interdisciplinary Reviews: Computational Statistics</em> 13 (2): e1512.
</div>
<div class="csl-entry">
Press, William H, Teukolsky Saul A, William T Vetterling, and Brian P Flannery. 2007. <em><span class="nocase">Numerical recipes 3rd edition: The art of scientific computing</span></em>. Cambridge University Press.
</div>
<div class="csl-entry">
R Core Team. 2022. <em><span class="nocase">R: A Language and Environment for Statistical Computing</span></em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org">https://www.R-project.org</a>.
</div>
<div class="csl-entry">
Rashid, T, JE Bennett, D Muller, A Cross, J Pearson-Stuttard, H Daby, D Fecht, B Davies, and M Ezzati. 2023. <span>“<span class="nocase">Inequalities in mortality from leading cancers in districts of England from 2002 to 2019: population-based high-resolution spatiotemporal analysis of vital registration data</span>.”</span> <em>The Lancet Oncology</em>. <a href="http://hdl.handle.net/10044/1/107364">http://hdl.handle.net/10044/1/107364</a>.
</div>
<div class="csl-entry">
Riebler, Andrea, Sigrunn H Sørbye, Daniel Simpson, and Håvard Rue. 2016. <span>“<span class="nocase">An intuitive Bayesian spatial model for disease mapping that accounts for scaling</span>.”</span> <em>Statistical Methods in Medical Research</em> 25 (4): 1145–65.
</div>
<div class="csl-entry">
Risher, Kathryn A, Anne Cori, Georges Reniers, Milly Marston, Clara Calvert, Amelia Crampin, Tawanda Dadirai, et al. 2021. <span>“<span class="nocase">Age patterns of HIV incidence in eastern and southern Africa: a modelling analysis of observational population-based cohort studies</span>.”</span> <em>The Lancet HIV</em> 8 (7): e429–39.
</div>
<div class="csl-entry">
Robert, Christian P, and George Casella. 2005. <span>“<span class="nocase">Monte Carlo Statistical Methods (Springer Texts in Statistics)</span>.”</span> Springer.
</div>
<div class="csl-entry">
Roberts, Gareth O, and Jeffrey S Rosenthal. 2004. <span>“<span class="nocase">General state space Markov chains and MCMC algorithms</span>.”</span>
</div>
<div class="csl-entry">
Roy, Vivekananda. 2020. <span>“<span class="nocase">Convergence diagnostics for markov chain monte carlo</span>.”</span> <em>Annual Review of Statistics and Its Application</em> 7: 387–412.
</div>
<div class="csl-entry">
Rue, Havard. 2023. <span>“<span>‘R-INLA‘ Project - FAQ</span>.”</span> <a href="https://www.r-inla.org/faq">https://www.r-inla.org/faq</a>.
</div>
<div class="csl-entry">
Rue, Håvard. 2001. <span>“<span class="nocase">Fast sampling of Gaussian Markov random fields</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 63 (2): 325–38.
</div>
<div class="csl-entry">
———. 2020. <span>“<span class="nocase">Comment on R-INLA Discussion Group thread</span>.”</span>
</div>
<div class="csl-entry">
Rue, Håvard, and Turid Follestad. 2001. <span>“<span class="nocase">GMRFLib: a C-library for fast and exact simulation of Gaussian Markov random fields</span>.”</span> SIS-2002-236.
</div>
<div class="csl-entry">
Rue, Havard, and Leonhard Held. 2005. <em><span class="nocase">Gaussian Markov random fields: theory and applications</span></em>. CRC press.
</div>
<div class="csl-entry">
Rue, Håvard, and Sara Martino. 2007. <span>“<span class="nocase">Approximate Bayesian inference for hierarchical Gaussian Markov random field models</span>.”</span> <em>Journal of Statistical Planning and Inference</em> 137 (10): 3177–92.
</div>
<div class="csl-entry">
Rue, Håvard, Sara Martino, and Nicolas Chopin. 2009. <span>“<span class="nocase">Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 71 (2): 319–92.
</div>
<div class="csl-entry">
Rue, Håvard, Andrea Riebler, Sigrunn H Sørbye, Janine B Illian, Daniel P Simpson, and Finn K Lindgren. 2017. <span>“<span class="nocase">Bayesian computing with INLA: a review</span>.”</span> <em>Annual Review of Statistics and Its Application</em> 4: 395–421.
</div>
<div class="csl-entry">
Säilynoja, Teemu, Paul-Christian Bürkner, and Aki Vehtari. 2022. <span>“<span class="nocase">Graphical test for discrete uniformity and its applications in goodness-of-fit evaluation and multiple sample comparison</span>.”</span> <em>Statistics and Computing</em> 32 (2): 32.
</div>
<div class="csl-entry">
Saracco, James F, J Andrew Royle, David F DeSante, and Beth Gardner. 2010. <span>“<span class="nocase">Modeling spatial variation in avian survival and residency probabilities</span>.”</span> <em>Ecology</em> 91 (7): 1885–91.
</div>
<div class="csl-entry">
Saul, Janet, Gretchen Bachman, Shannon Allen, Nora F Toiv, Caroline Cooney, and Ta’Adhmeeka Beamon. 2018. <span>“<span class="nocase">The DREAMS core package of interventions: a comprehensive approach to preventing HIV among adolescent girls and young women</span>.”</span> <em>PLoS One</em> 13 (12): e0208167.
</div>
<div class="csl-entry">
Saunders, Daniel. 2023. <span>“<span class="nocase">The Besag-York-Mollie Model for Spatial Data</span>.”</span> In <em>PyMC Examples</em>, edited by PyMC Team. <a href="https://doi.org/10.5281/zenodo.5654871">https://doi.org/10.5281/zenodo.5654871</a>.
</div>
<div class="csl-entry">
Schad, Daniel J, Michael Betancourt, and Shravan Vasishth. 2021. <span>“Toward a Principled Bayesian Workflow in Cognitive Science.”</span> <em>Psychological Methods</em> 26 (1): 103.
</div>
<div class="csl-entry">
Schlüter, Daniela K, Martial L Ndeffo-Mbah, Innocent Takougang, Tony Ukety, Samuel Wanji, Alison P Galvani, and Peter J Diggle. 2016. <span>“<span class="nocase">Using community-level prevalence of Loa loa infection to predict the proportion of highly-infected individuals: statistical modelling to support lymphatic filariasis and onchocerciasis elimination programs</span>.”</span> <em>PLoS Neglected Tropical Diseases</em> 10 (12): e0005157.
</div>
<div class="csl-entry">
Schmid, Volker J, Brandon Whitcher, Anwar R Padhani, N Jane Taylor, and Guang-Zhong Yang. 2006. <span>“<span class="nocase">Bayesian methods for pharmacokinetic models in dynamic contrast-enhanced magnetic resonance imaging</span>.”</span> <em>IEEE Transactions on Medical Imaging</em> 25 (12): 1627–36.
</div>
<div class="csl-entry">
Shapley, Lloyd S et al. 1953. <span>“<span class="nocase">A value for n-person games</span>.”</span>
</div>
<div class="csl-entry">
Shumway, Robert H, and David S Stoffer. 2017. <span>“<span class="nocase">Time Series Analysis and Its Applications With R Examples</span>.”</span>
</div>
<div class="csl-entry">
Siegfried, Nandi, Lize van der Merwe, Peter Brocklehurst, and Tin Tin Sint. 2011. <span>“<span class="nocase">Antiretrovirals for reducing the risk of mother-to-child transmission of HIV infection</span>.”</span> <em>Cochrane Database of Systematic Reviews</em>, no. 7.
</div>
<div class="csl-entry">
Simpson, Daniel, Håvard Rue, Andrea Riebler, Thiago G Martins, Sigrunn H Sørbye, et al. 2017. <span>“<span class="nocase">Penalising model component complexity: A principled, practical approach to constructing priors</span>.”</span> <em>Statistical Science</em> 32 (1): 1–28.
</div>
<div class="csl-entry">
Sisson, Scott A, Yanan Fan, and Mark Beaumont. 2018. <em><span class="nocase">Handbook of approximate Bayesian computation</span></em>. CRC Press.
</div>
<div class="csl-entry">
Skaug, Hans J. 2009. <span>“<span class="nocase">Discussion of "Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations"</span>.”</span> In <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, 71:319–92. 2. Wiley Online Library.
</div>
<div class="csl-entry">
Slaymaker, Emma, Kathryn A. Risher, Ramadhani Abdul, Milly Marston, Keith Tomlin, Robert Newton, Anthony Ndyanabo, et al. 2020. <span>“<span class="nocase">Risk factors for new HIV infections in the general population in sub-Saharan Africa</span>.”</span>
</div>
<div class="csl-entry">
Smith, Nathaniel, and Stéfan van der Walt. 2015. <span>“<span class="nocase">A Better Default Colormap for Matplotlib</span>.”</span> In <em>Proceedings of the 14th Python in Science Conference (SciPy)</em>.
</div>
<div class="csl-entry">
Sørbye, Sigrunn Holbek, and Håvard Rue. 2014. <span>“<span class="nocase">Scaling intrinsic Gaussian Markov random field priors in spatial modelling</span>.”</span> <em>Spatial Statistics</em> 8: 39–51.
</div>
<div class="csl-entry">
———. 2017. <span>“<span class="nocase">Penalised complexity priors for stationary autoregressive processes</span>.”</span> <em>Journal of Time Series Analysis</em> 38 (6): 923–35.
</div>
<div class="csl-entry">
Spiegelhalter, David J, Nicola G Best, Bradley P Carlin, and Angelika Van Der Linde. 2002. <span>“<span class="nocase">Bayesian measures of model complexity and fit</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 64 (4): 583–639.
</div>
<div class="csl-entry">
Spiegelhalter, David, Andrew Thomas, Nicky Best, and Wally Gilks. 1996. <span>“<span>BUGS 0.5 Examples</span>.”</span> <em>MRC Biostatistics Unit, Institute of Public Health, Cambridge, UK</em> 256.
</div>
<div class="csl-entry">
Stan Development Team. 2023. <em><span>Stan</span> Reference Manual</em>. <a href="https://mc-stan.org/docs/reference-manual/index.html">https://mc-stan.org/docs/reference-manual/index.html</a>.
</div>
<div class="csl-entry">
Stein, Michael L. 1999. <span>“<span class="nocase">Interpolation of spatial data: some theory for kriging</span>.”</span>
</div>
<div class="csl-entry">
Stevens, Oliver, Keith Sabin, Rebecca Anderson, Sonia Arias Garcia, Kalai Willis, Amrita Rao, Anne F. McIntyre, et al. 2023. <span>“<span class="nocase">Population size, HIV prevalence, and antiretroviral therapy coverage among key populations in sub-Saharan Africa: collation and synthesis of survey data 2010-2023</span>.”</span> <em>medRxiv</em>. <a href="https://www.medrxiv.org/content/early/2023/11/22/2022.07.27.22278071">https://www.medrxiv.org/content/early/2023/11/22/2022.07.27.22278071</a>.
</div>
<div class="csl-entry">
Stover, John, Robert Glaubius, Lynne Mofenson, Caitlin M Dugdale, Mary-Ann Davies, Gabriela Patten, and Constantin Yiannoutsos. 2019. <span>“<span class="nocase">Updates to the Spectrum/AIM model for estimating key HIV indicators at national and subnational levels</span>.”</span> <em>AIDS (London, England)</em> 33 (Suppl 3): S227.
</div>
<div class="csl-entry">
Stover, John, and Yu Teng. 2021. <span>“<span class="nocase">The impact of condom use on the HIV epidemic</span>.”</span> <em>Gates Open Research</em> 5.
</div>
<div class="csl-entry">
Stringer, Alex. 2021. <span>“<span class="nocase">Implementing Approximate Bayesian Inference using Adaptive Quadrature: the aghq Package</span>.”</span> <em>arXiv Preprint arXiv:2101.04468</em>.
</div>
<div class="csl-entry">
Stringer, Alex, Patrick Brown, and Jamie Stafford. 2022. <span>“<span class="nocase">Fast, scalable approximations to posterior distributions in extended latent Gaussian models</span>.”</span> <em>Journal of Computational and Graphical Statistics</em>, 1–15.
</div>
<div class="csl-entry">
Tanaka, Yusuke, Toshiyuki Tanaka, Tomoharu Iwata, Takeshi Kurashima, Maya Okawa, Yasunori Akagi, and Hiroyuki Toda. 2019. <span>“<span class="nocase">Spatially aggregated Gaussian processes with multivariate areal outputs</span>.”</span> In <em>Advances in Neural Information Processing Systems</em>, 3005–15.
</div>
<div class="csl-entry">
Tanser, Frank, Tulio de Oliveira, Mathieu Maheu-Giroux, and Till Bärnighausen. 2014. <span>“<span class="nocase">Concentrated HIV sub-epidemics in generalized epidemic settings</span>.”</span> <em>Current Opinion in HIV and AIDS</em> 9 (2): 115.
</div>
<div class="csl-entry">
Tatem, Andrew J. 2017. <span>“<span class="nocase">WorldPop, open data for spatial demography</span>.”</span> <em>Scientific Data</em> 4 (1): 1–4.
</div>
<div class="csl-entry">
Teh, Yee Whye, Bryn Elesedy, Bobby He, Michael Hutchinson, Sheheryar Zaidi, Avishkar Bhoopchand, Ulrich Paquet, Nenad Tomasev, Jonathan Read, and Peter J. Diggle. 2022. <span>“<span class="nocase">Efficient Bayesian inference of Instantaneous Reproduction Numbers at Fine Spatial Scales, with an Application to Mapping and Nowcasting the Covid-19 Epidemic in British Local Authorities</span>.”</span> <em>Journal of the Royal Statistical Society Series A: Statistics in Society</em> 185 (1): S65–85. <a href="https://doi.org/10.1111/rssa.12971">https://doi.org/10.1111/rssa.12971</a>.
</div>
<div class="csl-entry">
Thall, Peter F, and Stephen C Vail. 1990. <span>“<span class="nocase">Some covariance models for longitudinal count data with overdispersion</span>.”</span> <em>Biometrics</em>, 657–71.
</div>
<div class="csl-entry">
The Global Fund. 2018. <em><span class="nocase">The Global Fund Measurement Framework for Adolescent Girls and Young Women Programs</span></em>. <a href="https://www.theglobalfund.org/media/8076/me\%5Fadolescentsgirlsandyoungwomenprograms\%5Fframeworkmeasurement\%5Fen.pdf">https://www.theglobalfund.org/media/8076/me\%5Fadolescentsgirlsandyoungwomenprograms\%5Fframeworkmeasurement\%5Fen.pdf</a>.
</div>
<div class="csl-entry">
Thigpen, Michael C, Poloko M Kebaabetswe, Lynn A Paxton, Dawn K Smith, Charles E Rose, Tebogo M Segolodi, Faith L Henderson, et al. 2012. <span>“Antiretroviral Preexposure Prophylaxis for Heterosexual HIV Transmission in Botswana.”</span> <em>New England Journal of Medicine</em> 367 (5): 423–34.
</div>
<div class="csl-entry">
Thyng, Kristen M, Chad A Greene, Robert D Hetland, Heather M Zimmerle, and Steven F DiMarco. 2016. <span>“True Colors of Oceanography: Guidelines for Effective and Accurate Colormap Selection.”</span> <em>Oceanography</em> 29 (3): 9–13.
</div>
<div class="csl-entry">
Tierney, Luke, and Joseph B Kadane. 1986. <span>“<span class="nocase">Accurate approximations for posterior moments and marginal densities</span>.”</span> <em>Journal of the American Statistical Association</em> 81 (393): 82–86.
</div>
<div class="csl-entry">
Tobler, Waldo R. 1970. <span>“<span class="nocase">A computer movie simulating urban growth in the Detroit region</span>.”</span> <em>Economic Geography</em> 46 (sup1): 234–40.
</div>
<div class="csl-entry">
Tokdar, Surya T, and Robert E Kass. 2010. <span>“<span class="nocase">Importance sampling: a review</span>.”</span> <em>Wiley Interdisciplinary Reviews: Computational Statistics</em> 2 (1): 54–60.
</div>
<div class="csl-entry">
UNAIDS. 2014. <span>“<span class="nocase">90-90-90. An ambitious treatment target to help end the AIDS epidemic</span>.”</span>
</div>
<div class="csl-entry">
UNAIDS. 2021a. <span>“<span class="nocase">2021 UNAIDS Global AIDS Update - Confronting Inequalities - Lessons for pandemic responses from 40 Years of AIDS</span>.”</span> Geneva, Switzerland.
</div>
<div class="csl-entry">
UNAIDS. 2021b. <span>“<span class="nocase">Global AIDS strategy 2021–2026. End inequalities. End AIDS</span>.”</span>
</div>
<div class="csl-entry">
UNAIDS. 2022. <span>“<span>In Danger: UNAIDS Global AIDS Update 2022</span>.”</span> <a href="https://www.unaids.org/en/resources/documents/2022/in-danger-global-aids-update" class="uri">https://www.unaids.org/en/resources/documents/2022/in-danger-global-aids-update</a>.
</div>
<div class="csl-entry">
———. 2023a. <span>“<span class="nocase">AIDSinfo: Global data on HIV epidemiology and response</span>.”</span> <a href="https://aidsinfo.unaids.org/" class="uri">https://aidsinfo.unaids.org/</a>.
</div>
<div class="csl-entry">
———. 2023b. <span>“<span class="nocase">The path that ends AIDS: UNAIDS Global AIDS Update 2023</span>.”</span> <a href="https://www.unaids.org/en/resources/documents/2023/global-aids-update-2023" class="uri">https://www.unaids.org/en/resources/documents/2023/global-aids-update-2023</a>.
</div>
<div class="csl-entry">
UNAIDS and WHO. 2021. <span>“Voluntary Medical Male Circumcision Progress Brief.”</span> UNAIDS. <a href="https://hivpreventioncoalition.unaids.org/wp-content/uploads/2021/04/JC3022_VMMC_4-pager_En_v3.pdf">https://hivpreventioncoalition.unaids.org/wp-content/uploads/2021/04/JC3022_VMMC_4-pager_En_v3.pdf</a>.
</div>
<div class="csl-entry">
UNAIDS, WHO, et al. 2022. <em>Using Recency Assays for HIV Surveillance: 2022 Technical Guidance</em>. World Health Organization.
</div>
<div class="csl-entry">
UNICEF. 2019. <span>“<span class="nocase">Adolescent &amp; social norms situation in Mozambique</span>.”</span> <a href="https://www.unicef.org/mozambique/en/adolescent-social-norms">https://www.unicef.org/mozambique/en/adolescent-social-norms</a>.
</div>
<div class="csl-entry">
U.S. Department of State. 2022. <span>“<span>Latest Global Program Results</span>.”</span> <a href="https://www.state.gov/wp-content/uploads/2022/11/PEPFAR-Latest-Global-Results_December-2022.pdf" class="uri">https://www.state.gov/wp-content/uploads/2022/11/PEPFAR-Latest-Global-Results_December-2022.pdf</a>.
</div>
<div class="csl-entry">
USAID. 2012. <span>“<span class="nocase">Sampling and Household Listing Manual: Demographic and Health Surveys Methodology</span>.”</span> <a href="https://dhsprogram.com/pubs/pdf/DHSM4/DHS6_Sampling_Manual_Sept2012_DHSM4.pdf">https://dhsprogram.com/pubs/pdf/DHSM4/DHS6_Sampling_Manual_Sept2012_DHSM4.pdf</a>.
</div>
<div class="csl-entry">
Utazi, C Edson, Julia Thorley, VA Alegana, MJ Ferrari, Kristine Nilsen, Saki Takahashi, CJE Metcalf, Justin Lessler, and AJ Tatem. 2019. <span>“<span class="nocase">A spatial regression model for the disaggregation of areal unit based data to high-resolution grids with application to vaccination coverage mapping</span>.”</span> <em>Statistical Methods in Medical Research</em> 28 (10-11): 3226–41.
</div>
<div class="csl-entry">
Valpine, Perry de, Daniel Turek, Christopher J Paciorek, Clifford Anderson-Bergman, Duncan Temple Lang, and Rastislav Bodik. 2017. <span>“<span class="nocase">Programming with models: writing statistical algorithms for general model structures with NIMBLE</span>.”</span> <em>Journal of Computational and Graphical Statistics</em> 26 (2): 403–13.
</div>
<div class="csl-entry">
Van Niekerk, Janet, Elias Krainski, Denis Rustand, and Håvard Rue. 2023. <span>“<span class="nocase">A new avenue for Bayesian inference with INLA</span>.”</span> <em>Computational Statistics &amp; Data Analysis</em> 181: 107692.
</div>
<div class="csl-entry">
Vehtari, Aki, Andrew Gelman, and Jonah Gabry. 2017. <span>“Practical Bayesian Model Evaluation Using Leave-One-Out Cross-Validation and WAIC.”</span> <em>Statistics and Computing</em> 27: 1413–32.
</div>
<div class="csl-entry">
Vehtari, Aki, and Janne Ojanen. 2012. <span>“<span class="nocase">A survey of Bayesian predictive methods for model assessment, selection and comparison</span>.”</span> <em>Statistics Surveys</em> 6 (none): 142–228. <a href="https://doi.org/10.1214/12-SS102">https://doi.org/10.1214/12-SS102</a>.
</div>
<div class="csl-entry">
Wakefield, J, and S Morris. 1999. <span>“<span class="nocase">Spatial dependence and errors-in-variables in environmental epidemiology</span>.”</span> <em>Bayesian Statistics</em> 6: 657–84.
</div>
<div class="csl-entry">
Wakefield, Jonathan, and Hilary Lyons. 2010. <span>“<span class="nocase">Spatial Aggregation and the Ecological Fallacy</span>.”</span> In <em>Chapman &amp; Hall/CRC Handbooks of Modern Statistical Methods</em>, 2010:541–58. <a href="https://doi.org/10.1201/9781420072884-c30">https://doi.org/10.1201/9781420072884-c30</a>.
</div>
<div class="csl-entry">
Ward, Brian. 2023. <em><span class="nocase">bridgestan: BridgeStan, Accessing Stan Model Functions in R</span></em>.
</div>
<div class="csl-entry">
Watanabe, Sumio. 2013. <span>“<span class="nocase">A widely applicable Bayesian information criterion</span>.”</span> <em>Journal of Machine Learning Research</em> 14 (Mar): 867–97.
</div>
<div class="csl-entry">
Weiser, Constantin. 2016. <em><span class="nocase">mvQuad: Methods for Multivariate Quadrature.</span></em> <a href="http://CRAN.R-project.org/package=mvQuad">http://CRAN.R-project.org/package=mvQuad</a>.
</div>
<div class="csl-entry">
Weiss, Daniel J, Bonnie Mappin, Ursula Dalrymple, Samir Bhatt, Ewan Cameron, Simon I Hay, and Peter W Gething. 2015. <span>“<span class="nocase">Re-examining environmental correlates of Plasmodium falciparum malaria endemicity: a data-intensive variable selection approach</span>.”</span> <em>Malaria Journal</em> 14 (1): 1–18.
</div>
<div class="csl-entry">
WHO and UNAIDS. 2007. <span>“New Data on Male Circumcision and HIV Prevention: Policy and Programme Implications.”</span> <em>Geneva: World Health Organization</em>.
</div>
<div class="csl-entry">
Wilke, Claus O. 2019. <em>Fundamentals of Data Visualization: A Primer on Making Informative and Compelling Figures</em>. O’Reilly Media.
</div>
<div class="csl-entry">
Wilson, Katie, and Jon Wakefield. 2018. <span>“<span class="nocase">Pointless spatial modeling</span>.”</span> <em>Biostatistics</em> 21 (2): e17–32. <a href="https://doi.org/10.1093/biostatistics/kxy041">https://doi.org/10.1093/biostatistics/kxy041</a>.
</div>
<div class="csl-entry">
Wolock, Timothy M, Seth Flaxman, Kathryn A Risher, Tawanda Dadirai, Simon Gregson, and Jeffrey W Eaton. 2021. <span>“<span class="nocase">Evaluating distributional regression strategies for modelling self-reported sexual age-mixing</span>.”</span> Edited by Eduardo Franco, Talía Malagón, and Adam Akullian. <em>eLife</em> 10 (June): e68318. <a href="https://doi.org/10.7554/eLife.68318">https://doi.org/10.7554/eLife.68318</a>.
</div>
<div class="csl-entry">
Wood, Simon N. 2017. <em><span class="nocase">Generalized additive models: an introduction with R</span></em>. CRC press.
</div>
<div class="csl-entry">
———. 2020. <span>“<span class="nocase">Simplified integrated nested Laplace approximation</span>.”</span> <em>Biometrika</em> 107 (1): 223–30.
</div>
<div class="csl-entry">
Wringe, A, I Cremin, J Todd, N McGrath, I Kasamba, K Herbst, P Mushore, B Żaba, and E Slaymaker. 2009. <span>“<span class="nocase">Comparative assessment of the quality of age-at-event reporting in three HIV cohort studies in sub-Saharan Africa</span>.”</span> <em>Sexually Transmitted Infections</em> 85 (Suppl 1): i56–63.
</div>
<div class="csl-entry">
Yao, Yuling, Aki Vehtari, Daniel Simpson, and Andrew Gelman. 2018. <span>“<span class="nocase">Yes, but did it work?: Evaluating variational inference</span>.”</span> In <em>International Conference on Machine Learning</em>, 5581–90. PMLR.
</div>
<div class="csl-entry">
Yousefi, Fariba, Michael T Smith, and Mauricio Alvarez. 2019. <span>“<span class="nocase">Multi-task learning for aggregated data using Gaussian processes</span>.”</span> <em>Advances in Neural Information Processing Systems</em> 32.
</div>
<div class="csl-entry">
Zaba, Basia, Elizabeth Pisani, Emma Slaymaker, and J Ties Boerma. 2004. <span>“<span class="nocase">Age at first sex: understanding recent trends in African demographic surveys</span>.”</span> <em>Sexually Transmitted Infections</em> 80 (suppl 2): ii28–35.
</div>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-eaton2021naomi" class="csl-entry">
Eaton, Jeffrey W, Laura Dwyer-Lindgren, Steve Gutreuter, Megan O’Driscoll, Oliver Stevens, Sumali Bajaj, Rob Ashton, et al. 2021. <span>“<span class="nocase">Naomi: a new modelling tool for estimating HIV epidemic indicators at the district level in sub-Saharan Africa</span>.”</span> <em>Journal of the International AIDS Society</em> 24: e25788.
</div>
<div id="ref-tmbdocumentation" class="csl-entry">
Kristensen, Kasper. 2021. <span>“<span class="nocase">The comprehensive TMB documentation</span>.”</span> <a href="https://kaskr.github.io/adcomp/_book/Introduction.html" class="uri">https://kaskr.github.io/adcomp/_book/Introduction.html</a>.
</div>
<div id="ref-stover2019updates" class="csl-entry">
Stover, John, Robert Glaubius, Lynne Mofenson, Caitlin M Dugdale, Mary-Ann Davies, Gabriela Patten, and Constantin Yiannoutsos. 2019. <span>“<span class="nocase">Updates to the Spectrum/AIM model for estimating key HIV indicators at national and subnational levels</span>.”</span> <em>AIDS (London, England)</em> 33 (Suppl 3): S227.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-model-for-risk-group-proportions.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
