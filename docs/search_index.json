[["index.html", "Methods and applications of Bayesian spatio-temporal statistics for small-area estimation of HIV indicators Welcome Acknowledgments", " Methods and applications of Bayesian spatio-temporal statistics for small-area estimation of HIV indicators Adam Howes Abstract Progress towards ending AIDS as a public health threat by 2030 is faltering. Effective public health response requires accurate, timely, high-resolution estimates of epidemic and demographic indicators. Limitations of available data make obtaining these estimates difficult. I develop and apply Bayesian spatio-temporal methods to meet this challenge. Firstly, I examine models for area-level spatial structure. Secondly, I estimate district-level HIV risk group proportions, enabling behavioural prioritisation of prevention interventions, as suggested by the Global AIDS Strategy. Finally, I develop a novel Bayesian inference method, combining adaptive Gauss-Hermite quadrature with principal component analysis, motivated by the Naomi district-level model of HIV indicators. In sum, the contributions in this thesis help to guide HIV policy in sub-Saharan Africa, as well as advancing Bayesian methods for spatio-temporal data. Welcome This is the e-book version of my PhD thesis, submitted to Imperial College London in accordance with the requirements of the degree of Doctor of Philosophy in Modern Statistics and Statistical Machine Learning. You can alternatively view the PDF copy. The associated GitHub repository is athowes/thesis. Acknowledgments Thanks to Jeff Eaton and Seth Flaxman for supervision of this research; staff and students of the StatML CDT at Imperial and Oxford; members of the HIV Inference Group at Imperial; members of the Machine Learning and Global Health Network; the Bill &amp; Melinda Gates Foundation and EPSRC for funding this PhD; Mike McLaren, Kevin Esvelt, the Nucleic Acid Observatory team, and the Sculpting Evolution lab for hosting my visit to MIT; Alex Stringer for hosting my visit to Waterloo; the Effective Altruism community; my friends and family. "],["introduction.html", "1 Introduction 1.1 Chapter overview", " 1 Introduction This thesis is about applied and methodological Bayesian statistics. It is Bayesian in the sense that I use probability models to draw conclusions from data. It is applied and methodological in the sense that I am concerned with real world questions and the means to answer them. The real world questions relate to surveillance of HIV in sub-Saharan Africa. Though important progress has been made, over forty years since the first reported cases millions of people remain impacted by HIV each year. Quantifying the epidemic using statistics is an important part of the public health response, and the path towards disease control and elimination. The data in this thesis are related to people. Usually, people answering survey questions or using healthcare facilities. Because the data have positions in space and time, statisticians describe it as spatio-temporal (Cressie and Wikle 2015). While there is a great diversity of spatio-temporal data, there are important and distinctive commonalities which make their shared study worthwhile. Computation is an essential part of modern statistical practice, and each project chapter is accompanied by code, hosted on GitHub. 1.1 Chapter overview Chapter 2: I start by reviewing the required background for the rest of the thesis, namely relating to the HIV/AIDS epidemic and Bayesian spatio-temporal statistics. Chapter 3: The prevailing model for spatial structure used in small-area estimation (Besag, York, and Mollié 1991) was designed with analysis of a grid of pixels in mind. In disease mapping, we work using the districts of a country, which are not a grid. I evaluate the practical consequences of this this concern (Howes, Eaton, and Flaxman 2023+). Chapter 4: Adolescent girls and young women are a demographic group at disproportionate risk of HIV infection. The Global AIDS Strategy suggests prioritising interventions on the basis of behaviour to prevent the most new infections using available resources. I estimate the size of behavioural risk groups across priority countries to enable implementation of this strategy, and assess the potential benefits in terms of numbers of new infections prevented (Howes et al. 2023). Chapter 5: The Naomi small-area estimation model (Eaton et al. 2021) is used by countries to estimate district-level HIV indicators. With this motivation, I develop an approximate Bayesian inference method combining adaptive Gauss-Hermite quadrature with principal components analysis (Howes et al. 2023+). I apply the method to data from Malawi, and analyse the consequence of inference method choice for policy relevant outcomes. Further, I open the door to a new class of fast, flexible, and accurate Bayesian inference algorithms. Chapter 6: I discuss avenues for future work, and my conclusions regarding the research. References "],["background.html", "2 Background 2.1 The HIV/AIDS epidemic 2.2 Bayesian spatio-temporal statistics", " 2 Background 2.1 The HIV/AIDS epidemic HIV/AIDS remains a source of substantial disease burden. In 2021 there were thirty-eight million people living with HIV, six hundred fifty thousand AIDS-related deaths, and one million, five hundred thousand people newly infected with HIV (UNAIDS 2021b). A major global effort has been made to address the epidemic. Significant progress has been made, both in reducing the number of new HIV cases and decreasing the number of AIDS related deaths (Figure \\(\\ref{fig:overall-picture}\\)). Roll out of antiretroviral therapy (ART) has been a key tool. Other interventions include condoms, pre-exposure prophylaxis (PrEP) and PEP, education, economic empowerment, VMMC. Figure 2.1: Overall picture. Disease burden is not evenly distributed in space. The region most affected is Sub-Saharan Africa. Within sub-Saharan Africa, there is significant geographic heterogeneity. Disease burden is not evenly distributed across populations. Disproportionately impacted groups are sometimes referred to as key populations. Key populations include men who have sex with men, female sex workers, people who inject drugs, transgender people, and incarcerated people. Key populations are often marginalised, and face legal and social issues. In sub-Saharan Africa, the epidemic is not as concentrated in key populations as in other contexts. Large demographic groups at higher risk include adolescent girls and young women. HIV interventions can be prioritised. Precision public health aims to get the right interventions, to the right population, in the right place, at the right time. Methods for prevention prioritisation include geographic, demographic, key population services, risk screening, and individual-level risk characteristics. Surveillance is used is conducted to track epidemic trends, identify at-risk populations, find drivers of transmission, and evaluate the impact of prevention and treatment programs. HIV prevalence is the proportion of the population who have HIV. HIV incidence is the rate of new HIV infections. ART coverage is the proprotion of people living with HIV who are on ART. There are significant data related difficulties associated with furnishing these estimates. These include sparsity in space and time, survey bias, conflicting information sources, hard to reach populations, changing demographies. These data limitations foreground the importance of synthesising multiple sources of information to obtain estimates. Doing so increases the difficulty and complexity of the statistical modelling required. Aims for HIV response going forward, and surveillance capabilities are needed to meet them. Phasing out of nationally-representative household surveys for HIV. 2.2 Bayesian spatio-temporal statistics 2.2.1 Bayesian statistics Bayesian statistics is a paradigm for learning from data. I provide a brief overview in this section, and recommend McElreath (2020) or Gelman et al. (2013) for a more complete introduction. At it’s best, the Bayesian framework allows the analyst focus their attention on modelling the data at hand. This is achieved by the construction of a generative model for the observed data \\(y\\) together with parameters \\(\\vartheta\\) \\[\\begin{equation} (y, \\vartheta) \\sim p(y, \\vartheta). \\end{equation}\\] This model is generative in the sense that one could simulate pairs \\((y, \\vartheta)\\) from it. If these pairs differ too greatly from what the analyst would expect, then the generative model may be refined. This is what is known as a prior predictive check. Computation of the posterior distribution \\[\\begin{equation} p(\\vartheta \\, | \\, y) = \\frac{p(y \\, | \\, \\vartheta) p(\\vartheta)}{p(y)}, \\label{eq:posterior} \\end{equation}\\] usually proceeds using approximate Bayesian inference methods. Markov chain Monte Carlo (MCMC) is the most popular approach for computing Equation \\(\\ref{eq:posterior}\\), and proceeds by simulating samples from a Markov chain with stationary distribution equal to the distribution of interest. Variational Bayes approaches assume the posterior distribution belongs to some class and use optimisation to choose the best member of that class. Particular properties of spatio-temporal models make integrated nested Laplace approximations, if feasible, often the best option Empirical Bayes approaches, like Template Model Builder (Osgood-Zimmerman and Wakefield 2021). 2.2.2 Spatio-temporal statistics In spatio-temporal statistics the data we observe are indexed by spatial or temporal location. Commonly used independent and identically distributed (IID) assumptions on observations are rarely suitable in this setting because we expect there to be spatio-temporal correlation structure. Split the parameters \\(\\vartheta = (x, \\theta)\\). Call \\(x\\) the latent field. Call \\(\\theta\\) the hyperparameters. Often, the latent field is assumed to be jointly multivariate Gaussian. 2.2.3 Latent Gaussian and extended latent Gaussian models Latent Gaussian models (Håvard Rue, Martino, and Chopin 2009) are of the form \\[\\begin{align*} y_i &amp;\\sim p(y_i \\, | \\, \\eta_i, \\theta_1), \\quad i \\in [n]\\\\ \\mu_i &amp;= \\mathbb{E}(y_i \\, | \\, \\eta_i) = g(\\eta_i), \\\\ \\eta_i &amp;= \\beta_0 + \\sum_{l = 1}^{p} \\beta_j z_{ji} + \\sum_{k = 1}^{r} f_k(u_{ki}), \\end{align*}\\] where \\([n] = \\{1, \\ldots, n\\}\\). The response variable is \\(y = (y)_{i \\in [n]}\\) with likelihood \\(p(y \\, | \\, \\eta, \\theta_1) = \\prod_{i = 1}^n p(y_i \\, | \\, \\eta_i, \\theta_1)\\), where \\(\\eta = (\\eta)_{i \\in [n]}\\). Each response has conditional mean \\(\\mu_i\\) with inverse link function \\(g: \\mathbb{R} \\to \\mathbb{R}\\) such that \\(\\mu_i = g(\\eta_i)\\). The vector \\(\\theta_1 \\in \\mathbb{R}^s\\), with \\(s_1\\) assumed small, are additional parameters of the likelihood. The structured additive predictor \\(\\eta_i\\) may include an intercept \\(\\beta_0\\), linear effects \\(\\beta_j\\) of the covariates \\(z_{ji}\\), and unknown functions \\(f_k(\\cdot)\\) of the covariates \\(u_{ki}\\). The parameters \\(\\beta_0\\), \\(\\{\\beta_j\\}\\), \\(\\{f_k(\\cdot)\\}\\) are each assigned Gaussian priors. It is convenient to collect these parameters into a vector \\(x \\in \\mathbb{R}^N\\) called the latent field such that \\(x \\sim \\mathcal{N}(0, Q(\\theta_2)^{-1})\\) where \\(\\theta_2 \\in \\mathbb{R}^{s_2}\\) are further parameters, again with \\(s_2\\) assumed small. Let \\(\\theta = (\\theta_1, \\theta_2) \\in \\mathbb{R}^s\\) with \\(m = s_1 + s_2\\) be all hyperparameters, with prior \\(p(\\theta)\\). Common examples of latent Gaussian models include the following. Many of the leading-edge models used in small-area estimation fall outside the latent Gaussian model class. Examples include disaggregation models, evidence synthesis models (Eaton et al. 2019, 2021), attendance models, risk group models. However, many of these models do fit into the class of extended latent Gaussian models (Stringer, Brown, and Stafford 2021). By allowing many-to-one link functions, extended latent Gaussian models facilitate modelling of non-linearities. 2.2.4 Survey methods References "],["beyond-borders.html", "3 Spatial structure 3.1 Background 3.2 Models based on adjacency 3.3 Models using kernels 3.4 Simulation study 3.5 HIV prevalence study 3.6 Discussion", " 3 Spatial structure Code for the analysis in this chapter is available from athowes/beyond-borders and supported by the R package arealutils. Include an edited version of the corresponding paper here. 3.1 Background 3.1.1 Areal and point data 3.1.2 Spatial random effects 3.2 Models based on adjacency 3.2.1 The Besag model 3.2.2 The BYM2 model 3.3 Models using kernels 3.3.1 The centroid kernel model 3.3.2 The integrated kernel model 3.4 Simulation study 3.4.1 Synthetic data-sets 3.4.2 Inferential models 3.4.2.1 Priors 3.4.2.2 Kernel details 3.4.3 Inference algorithms 3.4.4 Model assessment 3.4.4.1 Continuous ranked probability score 3.4.5 Results 3.5 HIV prevalence study 3.5.1 Results 3.6 Discussion 3.6.1 Limitations 3.6.2 Conclusion "],["multi-agyw.html", "4 A model for risk group proportions 4.1 Background 4.2 Data 4.3 Model for risk group proportions 4.4 Prevalence and incidence by risk group 4.5 Discussion", " 4 A model for risk group proportions In this chapter I describe an application of Bayesian spatio-temporal statistics to small-area estimation of HIV risk group proportions. This work was conducted in collaboration with colleagues from the MRC Centre for Global Infectious Disease Analysis and UNAIDS. My primary role was to develop the statistical model. I built on an earlier version of the analysis conducted by Kathryn Risher. The results are described in Howes et al. (2023). Kathryn has further created a spreadsheet tool using the resulting estimates which is now being used by countries to guide policy. Code for the analysis in this chapter is available from athowes/multi-agyw and supported by the R package multi.utils (Howes 2022). 4.1 Background Risk of acquiring HIV infection varies by individual. Moreover, variation is systematic across demographic characteristics. Adolescent girls and young women (AGYW, here defined as females aged 15-29) are one demographic group at increased risk. AGYW comprise 44% of new infections, while only 28% of the population (UNAIDS 2021a), and HIV incidence for AGYW is 2.4 times higher than for similarly aged males. The reasons for this disparity are given in Table 4.1. Table 4.1: Reasons. Reason Description Structural vulnerability and power imbalances Text Age patterns of sexual mixing Text Younger age at first sex Text Increased susceptibility to HIV infection Text On this basis, AGYW have been identified as a priority population for HIV prevention services (Saul et al. 2018; The Global Fund 2018). The Global AIDS Strategy 2021-2026 (UNAIDS 2021b) proposed stratifying HIV prevention packages to AGYW based on 1) local population-level HIV incidence and 2) individual-level sexual risk behaviour. As risk depends on both factors, prioritisation of prevention services would be more efficient if both are taken into account (Figure 4.1). The strategy encourages programmes to define targets for the proportion of AGYW to be reached with a range of interventions. Estimates of the size of each risk group are required. Figure 4.1: Risk depends on both individual-level risk behaviour and population-level HIV incidence. Table 4.2: Behavioural risk groups. Risk group Description Local HIV incidence Incidence ratio None Not sexually active – 0.0 Low One cohabiting partner – 1.0 (Baseline) High Non-regular or multiple partner(s) – 1.72 Very High Transactional sex (adjusted to correspond to female sex workers) 0.1-0.3% 13.0 0.3-1.0% 9.0 1.0-3.0% 6.0 &gt;3.0% 3.0 4.2 Data I used household survey data from 13 countries: Botswana, Cameroon, Kenya, Lesotho, Malawi, Mozambique, Namibia, South Africa, Eswatini, Tanzania, Uganda, Zambia and Zimbabwe. These countries have been designated AGYW priority countries. I found that it was not appropriate to use the surveys without a specific transactional sex question on an equal footing to the other surveys. 4.3 Model for risk group proportions I took a two-stage modelling approach to estimate the four risk group proportions. Index the four risk groups as \\(k \\in \\{1, 2, 3, 4\\}\\), and denote being in either the third or fourth risk group by \\(k = 3^{+}\\). First, using all the surveys, I used a spatio-temporal multinomial logistic regression model (Section 4.3.1) to estimate the proportion of AGYW in the risk groups \\(k \\in \\{1, 2, 3^{+}\\}\\). Then, using only those surveys with a specific transactional sex question, I fit a spatial logistic regression model (Section 4.3.2) to estimate the proportion of those in the \\(k = 3^{+}\\) risk group that were in the \\(k = 3\\) and \\(k = 4\\) risk groups respectively. 4.3.1 Spatio-temporal multinomial logistic regression Let \\(i \\in \\{1, \\ldots, n\\}\\) denote districts partitioning the 13 studied AGYW priority countries \\(c[i] \\in \\{1, \\ldots, 13\\}\\). Consider the years 1999-2018 denoted as \\(t \\in \\{1, \\ldots, T\\}\\), and age groups \\(a \\in \\{\\text{15--19}, \\text{20--24}, \\text{25--29}\\}\\). Let \\(p_{itak} &gt; 0\\) with \\(\\sum_{k = 1}^{3^{+}} p_{itak} = 1\\), be the probabilities of membership of risk group \\(k\\). 4.3.1.1 Multinomial logistic regression A baseline category multinomial logistic regression model is specified by \\[\\begin{align} \\y_{ita} &amp;= (y_{ita1}, \\ldots, y_{ita3^{+}})^\\top \\sim \\text{Multinomial}(m_{ita}; \\, p_{ita1}, \\ldots, p_{ita3^{+}}), \\\\ \\log \\left( \\frac{p_{itak}}{p_{ita1}} \\right) &amp;= \\eta_{itak}, \\quad k = 2, 3^{+}, \\end{align}\\] where the number in risk group \\(k\\) is \\(y_{itak}\\), the fixed sample size is \\(m_{ita} = \\sum_{k = 1}^{3^{+}} y_{itak}\\), and \\(k = 1\\) is chosen as the baseline category. This model is not an LGM, and is not possible to fit in R-INLA. 4.3.1.2 The multinomial-Poisson transformation We use the multinomial-Poisson transformation to enable inference with R-INLA. The transformation reframes a given multinomial logisitic regression model as an equivalent Poisson log-linear model of the form \\[\\begin{align} y_{itak} &amp;\\sim \\text{Poisson}(\\kappa_{itak}), \\label{eq:poisson1} \\\\ \\log(\\kappa_{itak}) &amp;= \\eta_{itak}. \\label{eq:poisson2} \\end{align}\\] The basis of the transformation is that, conditional on their sum, Poisson counts are jointly multinomially distributed (McCullagh and Nelder 1989) as follows \\[\\begin{equation} \\mathbf{y}_{ita} \\, | \\, m_{ita} \\sim \\text{Multinomial} \\left( m_{ita}; \\frac{\\kappa_{ita1}}{\\kappa_{ita}}, \\ldots, \\frac{\\kappa_{ita3^{+}}}{\\kappa_{ita}} \\right), \\end{equation}\\] where \\(\\kappa_{ita} = \\sum_{k = 1}^{3^{+}} \\kappa_{itak}\\). Category probabilities are then obtained by the softmax function \\[\\begin{equation} p_{itak} = \\frac{\\exp(\\eta_{itak})}{\\sum_{k = 1}^{3^{+}} \\exp(\\eta_{itak})} = \\frac{\\kappa_{itak}}{\\sum_{k = 1}^{3^{+}} \\kappa_{itak}} = \\frac{\\kappa_{itak}}{\\kappa_{ita}}. \\end{equation}\\] Under the equivalent model, the sample sizes \\(m_{ita} = \\sum_k y_{itak}\\) are treated as random \\(m_{ita} \\sim \\text{Poisson} \\left( \\kappa_{ita} \\right)\\) rather than fixed. The joint distribution of \\(p(\\mathbf{y}_{ita}, m_{ita}) = p(\\mathbf{y}_{ita} \\, | \\, m_{ita})p(m_{ita})\\) is then \\[\\begin{align} p(\\mathbf{y}_{ita}, m_{ita}) &amp;= \\exp(-\\kappa_{ita}) \\frac{(\\kappa_{ita})^{m_{ita}}}{m_{ita}!} \\times \\frac{m_{ita}!}{\\prod_k y_{itak}!} \\prod_k \\left( \\frac{\\kappa_{itak}}{\\kappa_{ita}} \\right)^{y_{itak}} \\\\ &amp;= \\prod_k \\left( \\frac{\\exp(-\\kappa_{itak}) \\left( \\kappa_{itak} \\right)^{y_{itak}}}{y_{itak}!} \\right) \\\\ &amp;= \\prod_k \\text{Poisson} \\left( y_{itak} \\, | \\, \\kappa_{itak} \\right). \\label{eq:prodpoisson} \\end{align}\\] corresponding to the product of independent Poisson likelihoods as in Equation \\(\\ref{eq:poisson1}\\). This model, including random sample sizes, is equivalent to the multinomial logistic regression only when the normalisation constants \\(m_{ita}\\) are recovered exactly. To ensure that this is the case, one approach is to include observation-specific random effects \\(\\theta_{ita}\\) in the equation for the linear predictor. Multiplying each of \\(\\{\\kappa_{itak}\\}_{k = 1}^{3^+}\\) by \\(\\exp(\\theta_{ita})\\) has no effect on the category probabilities, but does provide the necessary flexibility for \\(\\kappa_{ita}\\) to recover \\(m_{ita}\\) exactly. Although in theory an improper prior \\(\\theta_{ita} \\propto 1\\) should be used, I found that in practise, by keeping \\(\\eta_{ita}\\) otherwise small using appropriate constraints, so that arbitrarily large values of \\(\\theta_{ita}\\) are not required, it is sufficient (and practically preferable for inference) to instead use a vague prior. 4.3.1.3 Model specifications I considered four models for \\(\\eta_{ita}\\) in Equation \\(\\ref{eq:poisson2}\\) of the form \\[\\begin{equation} \\eta_{ita} = \\theta_{ita} + \\beta_k + \\zeta_{c[i]k} + \\alpha_{ac[i]k} + \\phi_{ik} + \\gamma_{tk}. \\end{equation}\\] Observation random effects \\(\\theta_{ita} \\sim \\mathcal{N}(0, 1000^2)\\) were included in all models I considered, and are required for the multinomial-Poisson transformation to be valid. To capture country-specific proportion estimates for each category, I included category random effects \\(\\beta_k \\sim \\mathcal{N}(0, \\tau_\\beta^{-1})\\) and country-category random effects \\(\\zeta_{ck} \\sim \\mathcal{N}(0, \\tau_\\zeta^{-1})\\). Heterogeneity in risk group proportions by age was allowed by including age-country-category random effects \\(\\alpha_{ack} \\sim \\mathcal{N}(0, \\tau_\\alpha^{-1})\\). 4.3.1.3.1 Spatial random effects For the space-category \\(\\phi_{ik}\\) random effects I considered two specifications: Independent and identically distributed (IID) \\(\\phi_{ik} \\sim \\mathcal{N}(0, \\tau_\\phi^{-1})\\), Besag (Besag, York, and Mollié 1991) grouped by category \\[ \\bphi = (\\phi_{11}, \\ldots, \\phi_{n1}, \\ldots, \\phi_{1{3^{+}}}, \\ldots \\phi_{n3^{+}})^\\top \\sim \\mathcal{N}(\\mathbf{0}, (\\tau_\\phi \\mathbf{R}^\\star_\\phi)^{-}). \\] The scaled structure matrix \\(\\mathbf{R}^\\star_\\phi = \\mathbf{R}^\\star_b \\otimes \\mathbf{I}\\) is given by the Kronecker product of the scaled Besag structure matrix \\(\\mathbf{R}^\\star_b\\) and the identity matrix \\(\\mathbf{I}\\), and \\({-}\\) denotes the generalised matrix inverse. Scaling of the structure matrix to have generalised variance one ensures interpretable priors may be placed on the precision parameter (Sørbye and Rue 2014). I followed the further recommendations of Freni-Sterrantino, Ventrucci, and Rue (2018) with regard to disconnected adjacency graphs, singletons and constraints. The Besag structure matrix \\(\\mathbf{R}_b\\) was obtained by the precision matrix of the random effects \\(\\mathbf{b} = (b_1, \\ldots, b_n)^\\top\\) with full conditionals \\[\\begin{equation} b_i \\, | \\, \\mathbf{b}_{-i} \\sim \\N\\left(\\frac{\\sum_{j: j \\sim i} b_j}{n_{\\delta i}}, \\frac{1}{n_{\\delta i}}\\right), \\end{equation}\\] where \\(j \\sim i\\) if the districts \\(A_i\\) and \\(A_j\\) are adjacent, and \\(n_{\\delta i}\\) is the number of districts adjacent to \\(A_i\\). In preliminary testing, I excluded spatial random effects from the model, but found that this negatively effected performance. I also tested using the BYM2 model (Simpson et al. 2017) in place of the Besag, but found that the proportion parameter posteriors tended to be highly peaked at the value one. For simplicity and to avoid numerical issues, by using Besag random effects I effectively decided to fix this proportion to one. 4.3.1.3.2 Temporal random effects For the year-category \\(\\gamma_{tk}\\) random effects I considered two specifications: IID \\(\\phi_{tk} \\sim \\mathcal{N}(0, \\tau_\\phi^{-1})\\), First order autoregressive (AR1) grouped by category \\[ \\bm{\\gamma} = (\\gamma_{11}, \\ldots, \\gamma_{13^{+}}, \\ldots, \\gamma_{T1}, \\ldots, \\gamma_{T3^{+}})^\\top \\sim \\mathcal{N}(\\mathbf{0}, (\\tau_\\phi \\mathbf{R}^\\star_\\gamma)^{-}). \\] The scaled structure matrix \\(\\mathbf{R}^\\star_\\gamma = \\mathbf{R}^\\star_r \\otimes \\mathbf{I}\\) is given by the Kronecker product of a scaled AR1 structure matrix \\(\\mathbf{R}^\\star_r\\) and the identity matrix \\(\\mathbf{I}\\). The AR1 structure matrix \\(\\mathbf{R}_r\\) is obtained by precision matrix of the random effects \\(\\mathbf{r} = (r_1, \\ldots, r_T)^\\top\\) specified by \\[\\begin{align} r_1 &amp;\\sim \\left( 0, \\frac{1}{1 - \\rho^2} \\right), \\\\ r_t &amp;= \\rho r_{t - 1} + \\epsilon_t, \\quad t = 2, \\ldots, T, \\end{align}\\] where \\(\\epsilon_t \\sim \\mathcal{N}(0, 1)\\) and \\(|\\rho| &lt; 1\\). 4.3.1.3.3 Priors All random effect precision parameters \\(\\tau \\in \\{\\tau_\\beta, \\tau_\\zeta, \\tau_\\alpha, \\tau_\\phi, \\tau_\\gamma\\}\\) were given independent penalised complexity (PC) priors (Simpson et al. 2017) with base model \\(\\sigma = 0\\) given by \\(p(\\tau) = 0.5 \\nu \\tau^{-3/2} \\exp \\left( - \\nu \\tau^{-1/2} \\right)\\) where \\(\\nu = - \\ln(0.01) / 2.5\\) such that \\(\\mathbb{P}(\\sigma &gt; 2.5) = 0.01\\). For the lag-one correlation parameter \\(\\rho\\), I used the PC prior, as derived by Sørbye and Rue (2017), with base model \\(\\rho = 1\\) and condition \\(\\mathbb{P}(\\rho &gt; 0 = 0.75)\\). I chose the base model \\(\\rho = 1\\) corresponding to no change in behaviour over time, rather than the alternative \\(\\rho = 0\\) corresponding to no correlation in behaviour over time, as I judged the former to be more plausible a priori. 4.3.1.4 Constraints To ensure interpretable posterior inferences relating to the random effects, I applied sum-to-zero constraints such that none of the category interaction random effects altered overall category probabilities. For the space-year-category random effects, I applied analogous sum-to-zero constraints to maintain roles of the space-category and year-category random effects. Together, these were: Category \\(\\sum_k \\beta_k = 0\\), Country \\(\\sum_c \\zeta_{ck} = 0, \\, \\forall \\, k\\), Age-country \\(\\sum_a \\alpha_{ack} = 0, \\, \\forall \\, c, k\\), Spatial \\(\\sum_i \\phi_{ik} = 0, \\, \\forall \\, k\\), Temporal \\(\\sum_t \\gamma_{tk} = 0, \\, \\forall \\, k\\). 4.3.1.5 Survey weighted likelihood I included surveys which use a complex design, in which each individual has an unequal probability of being included in the sample. For example the DHS often employs a two-stage cluster design, first taking an urban rural stratified sample of ennumeration areas, before selecting households from each ennumeration area using systematic sampling (DHS 2012). To account for this aspect of survey design, I use a weighted pseudo-likelihood where the observed counts \\(y\\) are replaced by effective counts \\(y^\\star\\) calculated using the survey weights \\(w_j\\) of all individuals \\(j\\) in the corresponding strata. I multiplied direct estimates produced using the survey package (Lumley 2004) by the Kish effective sample size (Kish 1965) \\[\\begin{equation} m^\\star = \\frac{\\left(\\sum_j w_j \\right)^2}{\\sum_j {w_j}^2} \\end{equation}\\] to obtain \\(y^\\star\\). These counts may not be integers, and as such the Poisson likelihood I used in Equation \\(\\ref{eq:poisson1}\\) is not appropriate. Instead, I used a generalised Poisson pseudo-likelihood \\(y^\\star \\sim \\text{xPoisson}(\\kappa)\\), given by \\[\\begin{equation} p(y^\\star) = \\frac{\\kappa^{y^\\star}}{\\left \\lfloor{y^\\star!}\\right \\rfloor } \\exp \\left(- \\kappa \\right), \\end{equation}\\] as implemented by family = \"xPoisson\" in R-INLA, which accepts non-integer input. 4.3.1.6 Model selection 4.3.2 Spatial logistic regression To estimate the proportion of those in the \\(k = 3^{+}\\) risk group that were in the \\(k = 3\\) and \\(k = 4\\) risk groups respectively, I fit logistic regression models of the form \\[\\begin{align} y_{ia4} &amp;\\sim \\text{Binomial} \\left( y_{ia3} + y_{ia4}, q_{ia} \\right), \\label{eq:logistic-regression} \\\\ q_{ia} &amp;= \\text{logit}^{-1} \\left( \\eta_{ia} \\right), \\end{align}\\] where \\(q_{ia} = p_{ia4} / (p_{ia3} + p_{ia4}) = p_{ia4} / p_{ia{3^+}}\\). Taking this two-step approach allowed me to include all surveys in the multinomial regression model, but only those surveys with a specific transactional sex question in Equation \\(\\ref{eq:logistic-regression}\\). As all such surveys occurred in 2013-2018, in the logistic regression model I assumed \\(q_{ia}\\) to be constant over time. I considered six logistic regression models each including a constant \\(\\beta_0 \\sim \\mathcal{N}(-2, 1^2)\\), country random effects \\(\\zeta_{c} \\sim \\mathcal{N}(0, \\tau_\\zeta^{-1})\\), and age-country random effects \\(\\alpha_{ac} \\sim \\mathcal{N}(0, \\tau_\\alpha^{-1})\\). The prior on \\(\\beta_0\\) placed 95% prior probability on the range 2-50% for the percentage of those with non-regular or multiple partners who report transactional sex. I considered two specifications (IID, Besag) for the spatial random effects \\(\\phi_i\\). To aid estimation with sparse data, I also considered national-level covariates for the proportion of men who have paid for sex ever or in the last twelve months , available from Hodgins et al. (2022). For both random effect precision parameters \\(\\tau \\in \\{\\tau_\\alpha, \\tau_\\zeta\\}\\) we used the PC prior with base model \\(\\sigma = 0\\) and \\(\\mathbb{P}(\\sigma &gt; 2.5 = 0.01)\\). For the regression parameters \\(\\beta \\in \\{\\beta_\\texttt{cfswever}, \\beta_\\texttt{cfswrecent}\\}\\) we used the prior \\(\\beta \\sim \\mathcal{N}(0, 2.5^2)\\). 4.3.2.1 Model specifications 4.3.2.2 Survey weighted likelihood 4.3.2.3 Model selection 4.3.3 Coverage assessment 4.3.4 Female sex worker population size adjustment Responding “yes” to the survey question “have you had sex in return for gifts, cash or anything else in the past 12 months” is not considered sufficient to constitute sex work. In recognition of this, I adjusted the estimates obtained based on the survey to match FSW population size estimates obtained via alternative methods. Stevens et al. (2022) used a Bayesian meta-analysis of key population specific data sources to estimate adult (15-49) FSW population size by country. I disaggregated these estimates by age as follows. First, I calculated the total sexually debuted population in each age group, in each country. To describe the distribution of age at first sex, I used skew logistic distributions (Nguyen and Eaton 2022) with cumulative distribution function given by \\[\\begin{equation} F(x) = \\left(1 + \\exp(\\kappa_c (\\mu_c - x)) \\right)^{- \\gamma_c}, \\end{equation}\\] where \\(\\kappa_c, \\mu_c, \\gamma_c &gt; 0\\) are country-specific shape, shape and skewness parameters respectively. Next, I used the assumed \\(\\text{Gamma}(\\alpha = 10.4, \\beta = 0.36)\\) FSW age distribution in South Africa from the Thembisa model (Johnson and Dorrington 2020) to calculate the implied ratio between the number of FSW and the sexually debuted population in each age group. I assumed these ratios in South Africa were applicable to every country, allowing calculation of the number of FSW by age group in all 13 countries. The results obtained are shown in Figure 4.2. Figure 4.2: Proportion of FSW by age group (including the age groups 30-34, 35-39, 40-44 and 45-49) as produced by the disaggregation procedure. 4.3.5 Results 4.3.5.1 Coverage assessment 4.3.5.2 Variance decomposition 4.3.5.3 Estimates 4.4 Prevalence and incidence by risk group 4.4.1 Disaggregation of Naomi estimates I calculated HIV incidence \\(\\lambda_{iak}\\) and number of new HIV infections \\(I_{iak}\\) stratified according to district, age group and risk group by linear disaggregation \\[\\begin{align} I_{ia} &amp;= \\sum_k I_{iak} = \\sum_k \\lambda_{iak}N_{iak} \\\\ &amp;= 0 + \\lambda_{ia2} N_{ia2} + \\lambda_{ia3} N_{ia3} + \\lambda_{ia4} N_{ia4} \\\\ &amp;= \\lambda_{ia2} \\left(N_{ia2} + \\text{RR}_{3} N_{ia3} + \\text{RR}_4(\\lambda_{ia}) N_{ia4} \\right). \\end{align}\\] Risk group specific HIV incidence estimates are then given by \\[\\begin{align} \\lambda_{ia1} &amp;= 0, \\\\ \\lambda_{ia2} &amp;= I_{ia} / \\left(N_{ia2} + \\text{RR}_{3} N_{ia3} + \\text{RR}_4(\\lambda_{ia}) N_{ia4}\\right), \\\\ \\lambda_{ia3} &amp;= \\text{RR}_{3} \\lambda_{ia2}, \\\\ \\lambda_{ia4} &amp;= \\text{RR}_4(\\lambda_{ia}) \\lambda_{ia2}. \\end{align}\\] which I evaluated using Naomi model estimates of the number of new HIV infections \\(I_{ia} = \\lambda_{ia} N_{ia}\\), HIV infection risk ratios \\(\\{\\text{RR}_3, \\text{RR}_4(\\lambda_{ia})\\}\\), and risk group population sizes as above. The risk ratio \\(\\text{RR}_4(\\lambda_{ia})\\) was defined as a function of general population incidence. The number of new HIV infections are then \\(I_{iak} = \\lambda_{iak} N_{iak}\\). 4.4.2 Expected new infections reached I calculated the number of new infections that would be reached prioritising according to each possible stratification of the population–that is for all \\(2^3 = 8\\) possible combinations of stratification by location, age, and risk group. As an illustration, for stratification just by age, I aggregated the number of new HIV infections and HIV incidence as such \\[\\begin{align} I_a &amp;= \\sum_{ik} I_{iak}, \\\\ \\lambda_a &amp;= I_a / \\sum_{ik} N_{iak}. \\end{align}\\] Under this stratification, individuals in each age group \\(a\\) are prioritised according to the highest HIV incidence \\(\\lambda_a\\). By cumulatively summing the expected infections, for each fraction of the total population reached I calculated the fraction of total expected new infections that would be reached. 4.4.3 Results 4.5 Discussion 4.5.0.1 Distribution of risk Connection to phylogenetic results from BDI About transmission rather than incidence Only age-sex structured not age-sex-behaviour Does not undermine my work 4.5.0.2 Community engagement CSO engagement Problem in Malawi with FSW 4.5.1 Limitations 4.5.2 Conclusion References "],["naomi-aghq.html", "5 Fast approximate Bayesian inference 5.1 Background 5.2 The Naomi model 5.3 Adaptive Gauss-Hermite quadrature 5.4 Malawi case-study 5.5 Discussion", " 5 Fast approximate Bayesian inference In this chapter I describe a novel Bayesian inference method I developed with the aim of facilitating fast and accurate inference for the Naomi small-area estimation model. This work builds on that of others, including Håvard Rue, Martino, and Chopin (2009), Kristensen et al. (2016) and Stringer, Brown, and Stafford (2021). I began working on this project in 2020, but did not make significant progress until I read Alex Stringer’s work. We later began collaborating, including Alex supervising my visit to the University of Waterloo in 2022. Code for the analysis in this chapter is available from athowes/naomi-aghq and supported by the R package inf.utils. Include an edited version of the corresponding paper here. 5.1 Background 5.2 The Naomi model 5.3 Adaptive Gauss-Hermite quadrature 5.4 Malawi case-study 5.5 Discussion References "],["conclusions.html", "6 Future work and conclusions 6.1 Future work 6.2 Conclusions", " 6 Future work and conclusions 6.1 Future work Avenues for future work include: Extending the risk group model described in Chapter 4 to include all adults 15-49. This may involve modelling of age-stratified sexual partnerships (Wolock et al. 2021). Such a model would likely fall out of the scope of R-INLA, but would be possible to write with TMB and therefore amenable to the methods discussed in 5. Evaluating the accuracy of aghq with Laplace marginals for a greater variety of extended latent Gaussian models. 6.2 Conclusions Chapter 3 is interesting because: I designed experiments to thoroughly compare models for spatial structure using tools for model assessment such as proper scoring rules and posterior predictive checks. Chapter 4 is interesting because: I estimated HIV risk group proportions for AGYW, enabling countries to prioritise their delivery of HIV prevention services. I analysed the number of new infections that might be reached under a variety of risk stratification strategies. I used R-INLA to specify multinomial spatio-temporal models via the Poisson-multinomial transformation. This includes complex two- and three-way Kronecker product interactions defined using the group and replicate options. Chapter 5 is interesting because: I developed a novel Bayesian inference method, motivated by a challenging and practically important problem in HIV inference. The method enables integrated nested Laplace approximations to be fit to and studied on a wider class of models than was previously possible. My implementation of the method was straightforward, building on the TMB and aghq packages, and described completely and accessibly in Howes et al. (2023+). My final conclusions are: Modelling complex data, more often than not, pushes the boundaries of the statistical toolkit available. A challenge I encountered was the difficulty of implementing identical models across multiple frameworks with the aim of studying the inference method. Or, of a similarly fraught nature, comparing different models implemented in different frameworks with the aim of studying model differences. The frequently asked questions section of the R-INLA website (Havard Rue 2023) notes that “the devil is in the details”. I have resolved this challenge by using a given TMB model template to fit models using multiple inference methodologies. The benefits of such a ecosystem of packages are noted by Stringer (2021). I particularly highlight the benefit of enabling analysts to easily vary their choice of inference method based on the stage of model development that they are in. To the best of my abilities, I have written this thesis, and the work described within it, in keeping with the principles of open science. I hope that doing so allows my work to be scrutinised, and optimistically built upon. This would not have been possible without a range of tools from the R ecosystem such as rmarkdown and rticles, as well as those developed within the MRC Centre for Global Infectious Disease Analysis such as orderly and didehpc. References "],["the-first-appendix.html", "A The First Appendix", " A The First Appendix "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
