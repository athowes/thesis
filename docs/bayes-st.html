<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Bayesian spatio-temporal statistics | Bayesian spatio-temporal methods for small-area estimation of HIV indicators</title>
  <meta name="description" content="3 Bayesian spatio-temporal statistics | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Bayesian spatio-temporal statistics | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Bayesian spatio-temporal statistics | Bayesian spatio-temporal methods for small-area estimation of HIV indicators" />
  
  
  

<meta name="author" content="Adam Howes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hiv-aids.html"/>
<link rel="next" href="beyond-borders.html"/>
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="templates/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#chapter-overview"><i class="fa fa-check"></i><b>1.1</b> Chapter overview</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hiv-aids.html"><a href="hiv-aids.html"><i class="fa fa-check"></i><b>2</b> The HIV/AIDS epidemic</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hiv-aids.html"><a href="hiv-aids.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="hiv-aids.html"><a href="hiv-aids.html#surveillance"><i class="fa fa-check"></i><b>2.2</b> HIV surveillance</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="hiv-aids.html"><a href="hiv-aids.html#challenges"><i class="fa fa-check"></i><b>2.2.1</b> Challenges</a></li>
<li class="chapter" data-level="2.2.2" data-path="hiv-aids.html"><a href="hiv-aids.html#statistical-approaches"><i class="fa fa-check"></i><b>2.2.2</b> Statistical approaches</a></li>
<li class="chapter" data-level="2.2.3" data-path="hiv-aids.html"><a href="hiv-aids.html#future-directions"><i class="fa fa-check"></i><b>2.2.3</b> Future directions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayes-st.html"><a href="bayes-st.html"><i class="fa fa-check"></i><b>3</b> Bayesian spatio-temporal statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-statistics"><i class="fa fa-check"></i><b>3.1</b> Bayesian statistics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-modelling"><i class="fa fa-check"></i><b>3.1.1</b> Bayesian modelling</a></li>
<li class="chapter" data-level="3.1.2" data-path="bayes-st.html"><a href="bayes-st.html#bayesian-computation"><i class="fa fa-check"></i><b>3.1.2</b> Bayesian computation</a></li>
<li class="chapter" data-level="3.1.3" data-path="bayes-st.html"><a href="bayes-st.html#interplay-between-modelling-and-computation"><i class="fa fa-check"></i><b>3.1.3</b> Interplay between modelling and computation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="bayes-st.html"><a href="bayes-st.html#spatio-temporal-statistics"><i class="fa fa-check"></i><b>3.2</b> Spatio-temporal statistics</a></li>
<li class="chapter" data-level="3.3" data-path="bayes-st.html"><a href="bayes-st.html#hierarchical-lgm-elgm"><i class="fa fa-check"></i><b>3.3</b> Model classes</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="bayes-st.html"><a href="bayes-st.html#hierarchical"><i class="fa fa-check"></i><b>3.3.1</b> Hierarchical models</a></li>
<li class="chapter" data-level="3.3.2" data-path="bayes-st.html"><a href="bayes-st.html#mixed-effects-models"><i class="fa fa-check"></i><b>3.3.2</b> Mixed effects models</a></li>
<li class="chapter" data-level="3.3.3" data-path="bayes-st.html"><a href="bayes-st.html#latent-gaussian-models"><i class="fa fa-check"></i><b>3.3.3</b> Latent Gaussian models</a></li>
<li class="chapter" data-level="3.3.4" data-path="bayes-st.html"><a href="bayes-st.html#extended-latent-gaussian-models"><i class="fa fa-check"></i><b>3.3.4</b> Extended latent Gaussian models</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bayes-st.html"><a href="bayes-st.html#survey"><i class="fa fa-check"></i><b>3.4</b> Survey methods</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="bayes-st.html"><a href="bayes-st.html#survey-notation-and-key-terms"><i class="fa fa-check"></i><b>3.4.1</b> Survey notation and key terms</a></li>
<li class="chapter" data-level="3.4.2" data-path="bayes-st.html"><a href="bayes-st.html#survey-design"><i class="fa fa-check"></i><b>3.4.2</b> Survey design</a></li>
<li class="chapter" data-level="3.4.3" data-path="bayes-st.html"><a href="bayes-st.html#survey-analysis"><i class="fa fa-check"></i><b>3.4.3</b> Survey analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="beyond-borders.html"><a href="beyond-borders.html"><i class="fa fa-check"></i><b>4</b> Models for spatial structure</a>
<ul>
<li class="chapter" data-level="4.1" data-path="beyond-borders.html"><a href="beyond-borders.html#background-1"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="beyond-borders.html"><a href="beyond-borders.html#models-based-on-adjacency"><i class="fa fa-check"></i><b>4.2</b> Models based on adjacency</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="beyond-borders.html"><a href="beyond-borders.html#the-besag-model"><i class="fa fa-check"></i><b>4.2.1</b> The Besag model</a></li>
<li class="chapter" data-level="4.2.2" data-path="beyond-borders.html"><a href="beyond-borders.html#best-practises-for-the-besag-model"><i class="fa fa-check"></i><b>4.2.2</b> Best practises for the Besag model</a></li>
<li class="chapter" data-level="4.2.3" data-path="beyond-borders.html"><a href="beyond-borders.html#the-reparameterised-besag-york-mollié-model"><i class="fa fa-check"></i><b>4.2.3</b> The reparameterised Besag-York-Mollié model</a></li>
<li class="chapter" data-level="4.2.4" data-path="beyond-borders.html"><a href="beyond-borders.html#concerns-about-the-besag-models-representation-of-space"><i class="fa fa-check"></i><b>4.2.4</b> Concerns about the Besag model’s representation of space</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="beyond-borders.html"><a href="beyond-borders.html#models-using-kernels"><i class="fa fa-check"></i><b>4.3</b> Models using kernels</a></li>
<li class="chapter" data-level="4.4" data-path="beyond-borders.html"><a href="beyond-borders.html#simulation-study"><i class="fa fa-check"></i><b>4.4</b> Simulation study</a></li>
<li class="chapter" data-level="4.5" data-path="beyond-borders.html"><a href="beyond-borders.html#hiv-prevalence-study"><i class="fa fa-check"></i><b>4.5</b> HIV prevalence study</a></li>
<li class="chapter" data-level="4.6" data-path="beyond-borders.html"><a href="beyond-borders.html#discussion"><i class="fa fa-check"></i><b>4.6</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multi-agyw.html"><a href="multi-agyw.html"><i class="fa fa-check"></i><b>5</b> A model for risk group proportions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multi-agyw.html"><a href="multi-agyw.html#background-2"><i class="fa fa-check"></i><b>5.1</b> Background</a></li>
<li class="chapter" data-level="5.2" data-path="multi-agyw.html"><a href="multi-agyw.html#data"><i class="fa fa-check"></i><b>5.2</b> Data</a></li>
<li class="chapter" data-level="5.3" data-path="multi-agyw.html"><a href="multi-agyw.html#model-for-risk-group-proportions"><i class="fa fa-check"></i><b>5.3</b> Model for risk group proportions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="multi-agyw.html"><a href="multi-agyw.html#st-multinomial"><i class="fa fa-check"></i><b>5.3.1</b> Spatio-temporal multinomial logistic regression</a></li>
<li class="chapter" data-level="5.3.2" data-path="multi-agyw.html"><a href="multi-agyw.html#s-logistic"><i class="fa fa-check"></i><b>5.3.2</b> Spatial logistic regression</a></li>
<li class="chapter" data-level="5.3.3" data-path="multi-agyw.html"><a href="multi-agyw.html#female-sex-worker-population-size-adjustment"><i class="fa fa-check"></i><b>5.3.3</b> Female sex worker population size adjustment</a></li>
<li class="chapter" data-level="5.3.4" data-path="multi-agyw.html"><a href="multi-agyw.html#results"><i class="fa fa-check"></i><b>5.3.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multi-agyw.html"><a href="multi-agyw.html#prevalence-and-incidence-by-risk-group"><i class="fa fa-check"></i><b>5.4</b> Prevalence and incidence by risk group</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multi-agyw.html"><a href="multi-agyw.html#disaggregation-of-naomi-estimates"><i class="fa fa-check"></i><b>5.4.1</b> Disaggregation of Naomi estimates</a></li>
<li class="chapter" data-level="5.4.2" data-path="multi-agyw.html"><a href="multi-agyw.html#expected-new-infections-reached"><i class="fa fa-check"></i><b>5.4.2</b> Expected new infections reached</a></li>
<li class="chapter" data-level="5.4.3" data-path="multi-agyw.html"><a href="multi-agyw.html#results-1"><i class="fa fa-check"></i><b>5.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multi-agyw.html"><a href="multi-agyw.html#discussion-1"><i class="fa fa-check"></i><b>5.5</b> Discussion</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="multi-agyw.html"><a href="multi-agyw.html#limitations"><i class="fa fa-check"></i><b>5.5.1</b> Limitations</a></li>
<li class="chapter" data-level="5.5.2" data-path="multi-agyw.html"><a href="multi-agyw.html#conclusion"><i class="fa fa-check"></i><b>5.5.2</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="naomi-aghq.html"><a href="naomi-aghq.html"><i class="fa fa-check"></i><b>6</b> Fast approximate Bayesian inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#inference-methods"><i class="fa fa-check"></i><b>6.1</b> Inference methods</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#the-laplace-approximation"><i class="fa fa-check"></i><b>6.1.1</b> The Laplace approximation</a></li>
<li class="chapter" data-level="6.1.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#quadrature"><i class="fa fa-check"></i><b>6.1.2</b> Quadrature</a></li>
<li class="chapter" data-level="6.1.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#integrated-nested-laplace-approximation"><i class="fa fa-check"></i><b>6.1.3</b> Integrated nested Laplace approximation</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#software"><i class="fa fa-check"></i><b>6.2</b> Software</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#tmb"><i class="fa fa-check"></i><b>6.2.1</b> <code>TMB</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#r-inla"><i class="fa fa-check"></i><b>6.2.2</b> <code>R-INLA</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#a-universal-inla-implementation"><i class="fa fa-check"></i><b>6.3</b> A universal INLA implementation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#epilepsy-example"><i class="fa fa-check"></i><b>6.3.1</b> Epilepsy example</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#the-naomi-model"><i class="fa fa-check"></i><b>6.4</b> The Naomi model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#model-structure"><i class="fa fa-check"></i><b>6.4.1</b> Model structure</a></li>
<li class="chapter" data-level="6.4.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#connection-to-elgms"><i class="fa fa-check"></i><b>6.4.2</b> Connection to ELGMs</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="naomi-aghq.html"><a href="naomi-aghq.html#extension-of-aghq-to-moderate-dimensions"><i class="fa fa-check"></i><b>6.5</b> Extension of AGHQ to moderate dimensions</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#aghq-with-variable-levels"><i class="fa fa-check"></i><b>6.5.1</b> AGHQ with variable levels</a></li>
<li class="chapter" data-level="6.5.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#principal-components-analysis"><i class="fa fa-check"></i><b>6.5.2</b> Principal components analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="naomi-aghq.html"><a href="naomi-aghq.html#malawi-case-study"><i class="fa fa-check"></i><b>6.6</b> Malawi case-study</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="naomi-aghq.html"><a href="naomi-aghq.html#nuts-convergence"><i class="fa fa-check"></i><b>6.6.1</b> NUTS convergence</a></li>
<li class="chapter" data-level="6.6.2" data-path="naomi-aghq.html"><a href="naomi-aghq.html#use-of-pca-aghq"><i class="fa fa-check"></i><b>6.6.2</b> Use of PCA-AGHQ</a></li>
<li class="chapter" data-level="6.6.3" data-path="naomi-aghq.html"><a href="naomi-aghq.html#model-assessment"><i class="fa fa-check"></i><b>6.6.3</b> Model assessment</a></li>
<li class="chapter" data-level="6.6.4" data-path="naomi-aghq.html"><a href="naomi-aghq.html#inference-comparison"><i class="fa fa-check"></i><b>6.6.4</b> Inference comparison</a></li>
<li class="chapter" data-level="6.6.5" data-path="naomi-aghq.html"><a href="naomi-aghq.html#exceedance-probabilities"><i class="fa fa-check"></i><b>6.6.5</b> Exceedance probabilities</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="naomi-aghq.html"><a href="naomi-aghq.html#discussion-2"><i class="fa fa-check"></i><b>6.7</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>7</b> Future work and conclusions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="conclusions.html"><a href="conclusions.html#strengths"><i class="fa fa-check"></i><b>7.1</b> Strengths</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="conclusions.html"><a href="conclusions.html#chapter-refbeyond-borders"><i class="fa fa-check"></i><b>7.1.1</b> Chapter @ref(beyond-borders)</a></li>
<li class="chapter" data-level="7.1.2" data-path="conclusions.html"><a href="conclusions.html#chapter-refmulti-agyw"><i class="fa fa-check"></i><b>7.1.2</b> Chapter @ref(multi-agyw)</a></li>
<li class="chapter" data-level="7.1.3" data-path="conclusions.html"><a href="conclusions.html#chapter-refnaomi-aghq"><i class="fa fa-check"></i><b>7.1.3</b> Chapter @ref(naomi-aghq)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="conclusions.html"><a href="conclusions.html#future-work"><i class="fa fa-check"></i><b>7.2</b> Future work</a></li>
<li class="chapter" data-level="7.3" data-path="conclusions.html"><a href="conclusions.html#conclusions-1"><i class="fa fa-check"></i><b>7.3</b> Conclusions</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="spatial-structure.html"><a href="spatial-structure.html"><i class="fa fa-check"></i><b>A</b> Spatial structure</a></li>
<li class="chapter" data-level="B" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html"><i class="fa fa-check"></i><b>B</b> A model for risk group proportions</a>
<ul>
<li class="chapter" data-level="B.1" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#the-global-aids-strategy"><i class="fa fa-check"></i><b>B.1</b> The Global AIDS Strategy</a></li>
<li class="chapter" data-level="B.2" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#household-survey-data"><i class="fa fa-check"></i><b>B.2</b> Household survey data</a></li>
<li class="chapter" data-level="B.3" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#spatial-analysis-levels"><i class="fa fa-check"></i><b>B.3</b> Spatial analysis levels</a></li>
<li class="chapter" data-level="B.4" data-path="a-model-for-risk-group-proportions.html"><a href="a-model-for-risk-group-proportions.html#survey-questions"><i class="fa fa-check"></i><b>B.4</b> Survey questions and risk group allocation</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html"><i class="fa fa-check"></i><b>C</b> Fast approximate Bayesian inference</a>
<ul>
<li class="chapter" data-level="C.1" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#simplified-naomi-model-description"><i class="fa fa-check"></i><b>C.1</b> Simplified Naomi model description</a></li>
<li class="chapter" data-level="C.2" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#model-assessment-1"><i class="fa fa-check"></i><b>C.2</b> Model assessment</a></li>
<li class="chapter" data-level="C.3" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#aghq-and-pca-aghq-details"><i class="fa fa-check"></i><b>C.3</b> AGHQ and PCA-AGHQ details</a></li>
<li class="chapter" data-level="C.4" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#normalising-constant-estimation"><i class="fa fa-check"></i><b>C.4</b> Normalising constant estimation</a></li>
<li class="chapter" data-level="C.5" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#inference-comparison-1"><i class="fa fa-check"></i><b>C.5</b> Inference comparison</a></li>
<li class="chapter" data-level="C.6" data-path="fast-approximate-bayesian-inference.html"><a href="fast-approximate-bayesian-inference.html#mcmc-convergence-and-suitability"><i class="fa fa-check"></i><b>C.6</b> MCMC convergence and suitability</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p>Bayesian spatio-temporal methods for small-area estimation of HIV indicators</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayes-st" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Bayesian spatio-temporal statistics<a href="bayes-st.html#bayes-st" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- For PDF output, include these two LaTeX commands after unnumbered chapter headings, otherwise the mini table of contents and the running header will show the previous chapter -->
<div id="bayesian-statistics" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Bayesian statistics<a href="bayes-st.html#bayesian-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian statistics is a mathematical paradigm for learning from data.
It is well suited for to the challenges posed by Section <a href="hiv-aids.html#surveillance">2.2</a> because it allows principled and flexible integration of data and scientific knowledge.
In this section I provide brief overview.
For a more complete introduction, I recommend <span class="citation">McElreath (<a href="#ref-mcelreath2020statistical">2020</a>)</span> or <span class="citation">Gelman et al. (<a href="#ref-gelman2013bayesian">2013</a>)</span>.</p>
<div id="bayesian-modelling" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Bayesian modelling<a href="bayes-st.html#bayesian-modelling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At its best, the Bayesian paradigm allows the analyst focus on how best to model the data.
This is achieved by the construction of a generative model <span class="math inline">\(p(\mathbf{y}, \boldsymbol{\mathbf{\phi}})\)</span> for the observed data <span class="math inline">\(\mathbf{y} = (y_1, \ldots, y_n)\)</span> together with parameters <span class="math inline">\(\boldsymbol{\mathbf{\phi}} = (\phi_1, \ldots, \phi_d)\)</span>.
Here <span class="math inline">\(n\)</span> is the dimension of the data and <span class="math inline">\(d\)</span> is the number of parameters.
The model is generative in the sense that one can simulate from it to generate draws
<span class="math display">\[\begin{equation}
(\mathbf{y}, \boldsymbol{\mathbf{\phi}}) \sim p(\mathbf{y}, \boldsymbol{\mathbf{\phi}})
\end{equation}\]</span>
If these draws differ too greatly from what the analyst would expect, then the generative model does not capture their scientific understanding, and can be refined.
In this way, models can be built iteratively, with complexity added gradually.</p>
<p>The model is usually constructed from two parts, known respectively as the likelihood <span class="math inline">\(p(\mathbf{y} \, | \, \boldsymbol{\mathbf{\phi}})\)</span> and the prior distribution <span class="math inline">\(p(\boldsymbol{\mathbf{\phi}})\)</span>.
The joint distribution is obtained by the product <span class="math inline">\(p(\mathbf{y}, \boldsymbol{\mathbf{\phi}}) = p(\mathbf{y} \, | \, \boldsymbol{\mathbf{\phi}}) p(\boldsymbol{\mathbf{\phi}})\)</span>.
The likelihood, as a function of <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span> with <span class="math inline">\(\mathbf{y}\)</span> fixed, reflects the probability of observing the data when the true value of the parameters is <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span>.
The prior distribution encapsulates beliefs about the parameters <span class="math inline">\(\boldsymbol{\mathbf{\phi}}\)</span> before the data is observed.</p>
<p>Recommendations for specifying the prior distribution vary.
A central issue is the extent to which subjective information should be incorporated into the prior distribution, and thereby influence the posterior distribution.
Proponents of the objective Bayesian paradigm suggest that the prior distribution should be non-informative, so as not to introduce subjectivity into the analysis.
That said, we shall see that the distinction between likelihood and prior distribution can be blurred (Section <a href="bayes-st.html#hierarchical-lgm-elgm">3.3</a>).
As such, it may be argued that issues of subjectivity are not unique to the prior distribution, and ultimately the challenge of specifying the data generating process is better thought of more holistically <span class="citation">(<a href="#ref-gelman2017prior">Gelman, Simpson, and Betancourt 2017</a>)</span>.</p>
</div>
<div id="bayesian-computation" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Bayesian computation<a href="bayes-st.html#bayesian-computation" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:conjugate"></span>
<img src="figures/bayesian/conjugate.png" alt="An example of Bayesian modelling and computation for a simple one parameter model. The likelihood is \(y_i \sim \text{Poisson}(\phi)\) for \(i = 1, 2, 3\) and prior distribution is \(\phi \sim \text{Gamma}(3, 1)\). Given observed data \(\mathbf{y} = (1, 2, 3)\) the posterior distribution is available in closed form as \(\text{Gamma}(9, 4)\). This is because the model is conjugate and the posterior distribution is in the same family as the prior distribution. Conjugate models are frequently used because of their convenience, in preference to other perhaps more appropriate models which might be more computationally demanding." width="95%" />
<p class="caption">
Figure 3.1: An example of Bayesian modelling and computation for a simple one parameter model. The likelihood is <span class="math inline">\(y_i \sim \text{Poisson}(\phi)\)</span> for <span class="math inline">\(i = 1, 2, 3\)</span> and prior distribution is <span class="math inline">\(\phi \sim \text{Gamma}(3, 1)\)</span>. Given observed data <span class="math inline">\(\mathbf{y} = (1, 2, 3)\)</span> the posterior distribution is available in closed form as <span class="math inline">\(\text{Gamma}(9, 4)\)</span>. This is because the model is conjugate and the posterior distribution is in the same family as the prior distribution. Conjugate models are frequently used because of their convenience, in preference to other perhaps more appropriate models which might be more computationally demanding.
</p>
</div>
<p>The posterior distribution <span class="math inline">\(p(\boldsymbol{\mathbf{\phi}} \, | \, \mathbf{y})\)</span> encapsulates probabilistic beliefs about the parameters given the observed data.
Using the eponymous Bayes’ theorem, it is given by
<span class="math display" id="eq:posterior">\[\begin{equation}
p(\boldsymbol{\mathbf{\phi}} \, | \, \mathbf{y}) = \frac{p(\mathbf{y} \, | \, \boldsymbol{\mathbf{\phi}}) p(\boldsymbol{\mathbf{\phi}})}{p(\mathbf{y})}. \tag{3.1}
\end{equation}\]</span>
Unfortunately, it is usually intractable to calculate Equation <a href="bayes-st.html#eq:posterior">(3.1)</a> directly because of the potentially high-dimensional integral <span class="math inline">\(p(\mathbf{y}) = \int p(\mathbf{y}, \boldsymbol{\mathbf{\phi}}) \text{d}\boldsymbol{\mathbf{\phi}}\)</span> in the denominator, sometimes known as the marginal likelihood or evidence.
As such, although it is easy to evaluate <span class="math inline">\(p(\boldsymbol{\mathbf{\phi}} \, | \, \mathbf{y}) \propto p(\mathbf{y} \, | \, \boldsymbol{\mathbf{\phi}}) p(\boldsymbol{\mathbf{\phi}})\)</span>, it is typically difficult to evaluate the posterior distribution itself.</p>
<p>A variety of computational methods have been developed to tackle this problem.
The main categories are:</p>
<ol style="list-style-type: decimal">
<li><strong>Sampling algorithms</strong> These approaches look to generate samples from the posterior distribution, and are known as Monte Carlo methods, named after the casino <span class="citation">(<a href="#ref-robert2005monte">Robert and Casella 2005</a>)</span>.
The most popular is Markov chain Monte Carlo (MCMC), which proceeds by simulating from a Markov chain with the posterior distribution as its stationary distribution.
In this thesis, I make use of the No-U-Turn sampler [NUTS; <span class="citation">Hoffman, Gelman, et al. (<a href="#ref-hoffman2014no">2014</a>)</span>], a Hamiltonian Monte Carlo [HMC; <span class="citation">Duane et al. (<a href="#ref-duane1987hybrid">1987</a>)</span>; <span class="citation">Neal et al. (<a href="#ref-neal2011mcmc">2011</a>)</span>] algorithm, implemented in the Stan <span class="citation">(<a href="#ref-carpenter2017stan">Carpenter et al. 2017</a>)</span> probabilistic programming language (PPL).</li>
<li><strong>Variational inference</strong> In variational inference (VI), the posterior distribution is assumed to belong to a particular class of functions.
Optimisation algorithms are then used to choose the best member of that class.
Though VI is fast, it may not be accurate <span class="citation">(<a href="#ref-yao2018yes">Yao et al. 2018</a>)</span>.</li>
<li><strong>Expectation maximisation</strong></li>
<li><strong>Deterministic approximations</strong> These approximations are the subject of Chapter <a href="naomi-aghq.html#naomi-aghq">6</a>.</li>
</ol>
</div>
<div id="interplay-between-modelling-and-computation" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Interplay between modelling and computation<a href="bayes-st.html#interplay-between-modelling-and-computation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bayesian computation aspires to abstract away calculation of the posterior distribution from the analyst.
Modern computational techniques and software have made this aspiration a reality for many models.
However, computation of the posterior distribution remains intractable for a majority of models.
As such, the analyst need not only to be concerned with choosing a model suitable for the data, but also choosing a model for which the posterior distribution is tractable in reasonable time.
As such, there is an important interplay between modelling and computation, wherein models are bound by the limits of computation.
As computation improves, the space of models available to the analyst expands.</p>
</div>
</div>
<div id="spatio-temporal-statistics" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Spatio-temporal statistics<a href="bayes-st.html#spatio-temporal-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In spatio-temporal statistics <span class="citation">(<a href="#ref-cressie2015statistics">Cressie and Wikle 2015</a>)</span>, we observe data indexed by spatial or temporal location.
In this thesis we assume that the spatial study region <span class="math inline">\(\mathcal{S} \subseteq \mathbb{R}^2\)</span> has two dimensions, corresponding to latitude and longitude.
Data may be associated to a point <span class="math inline">\(s \in \mathcal{S}\)</span> or area <span class="math inline">\(A \subseteq \mathcal{S}\)</span> in the study region.
The temporal study period <span class="math inline">\(\mathcal{T} \subseteq \mathbb{R}\)</span> can more generally be assumed to be one dimensional.
Similarly, data may be associated to a point <span class="math inline">\(t \in \mathcal{T}\)</span> or period of time <span class="math inline">\(T \in \mathcal{T}\)</span>.</p>
<p>Spatio-temporal data has some important properties.
Foremost among them is correlation structure.
Tobler’s first law of geography, also expressed by <span class="citation">Fisher (<a href="#ref-fisher1936design">1936</a>)</span>, is that “everything is related to everything else, but near things are more related than distant things” <span class="citation">(<a href="#ref-tobler1970computer">Tobler 1970</a>)</span>.
This law extends not only to space but also time.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:zmb-maps"></span>
<img src="figures/bayesian/zmb-maps.png" alt="To demonstrate the benefits of spatial modelling, I simulated simple random samples with varying sample size in each of the 156 constituencies of Zambia. I then calculated direct and modelled estimates for each survey. The model was a logistic regression with linear predictor given by an intercept and a Besag spatial random effect. HIV estimates for Zambia have previously been generated at the district-level comprising 116 spatial units. Moving forward, there is interest in generating estimates at the constituency level, as program planning is more locally devolved. This figure is adapted from a presentation I gave for the Zambia HIV Estimates Technical Working Group, available from athowes/zambia-unaids." width="95%" />
<p class="caption">
Figure 3.2: To demonstrate the benefits of spatial modelling, I simulated simple random samples with varying sample size in each of the 156 constituencies of Zambia. I then calculated direct and modelled estimates for each survey. The model was a logistic regression with linear predictor given by an intercept and a Besag spatial random effect. HIV estimates for Zambia have previously been generated at the district-level comprising 116 spatial units. Moving forward, there is interest in generating estimates at the constituency level, as program planning is more locally devolved. This figure is adapted from a presentation I gave for the Zambia HIV Estimates Technical Working Group, available from <a href="https://github.com/athowes/zambia-unaids"><code>athowes/zambia-unaids</code></a>.
</p>
</div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:zmb-scatter"></span>
<img src="figures/bayesian/zmb-scatter.png" alt="The estimates from surveys with higher sample size have higher Pearson correlation coefficient (\(R\)) with the underlying truth. For a fixed sample size, correlation can be improved by using modelled estimates to borrow information across spatial units, rather than using the higher variance direct estimates. Points along the dashed diagonal line correspond to agreement between the estimate obtained from the survey and the underlying truth used to generate the data. The setting matches that of Figure 3.2." width="95%" />
<p class="caption">
Figure 3.3: The estimates from surveys with higher sample size have higher Pearson correlation coefficient (<span class="math inline">\(R\)</span>) with the underlying truth. For a fixed sample size, correlation can be improved by using modelled estimates to borrow information across spatial units, rather than using the higher variance direct estimates. Points along the dashed diagonal line correspond to agreement between the estimate obtained from the survey and the underlying truth used to generate the data. The setting matches that of Figure <a href="bayes-st.html#fig:zmb-maps">3.2</a>.
</p>
</div>
</div>
<div id="hierarchical-lgm-elgm" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Model classes<a href="bayes-st.html#hierarchical-lgm-elgm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="hierarchical" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Hierarchical models<a href="bayes-st.html#hierarchical" class="anchor-section" aria-label="Anchor link to header"></a></h3>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:hierarchical-structure"></span>
<img src="figures/bayesian/hierarchical-structure.png" alt="A simple example of group structure within data. Each individual \(i = 1, \ldots, n\) is associated to \(m_i\) observations \(y_{i1}, \ldots, y_{im_i}\)." width="95%" />
<p class="caption">
Figure 3.4: A simple example of group structure within data. Each individual <span class="math inline">\(i = 1, \ldots, n\)</span> is associated to <span class="math inline">\(m_i\)</span> observations <span class="math inline">\(y_{i1}, \ldots, y_{im_i}\)</span>.
</p>
</div>
<p>Often it is natural to group some observations together.
Bayesian hierarchical or multilevel models, comprised of multiple stages, allow for natural handling data of this sort, even with complex nested or crossed grouping structures.
In a three-stage hierarchical model, we partition the parameters so that <span class="math inline">\(\boldsymbol{\mathbf{\phi}} = (\mathbf{x}, \boldsymbol{\mathbf{\theta}})\)</span>.
I refer to <span class="math inline">\(\mathbf{x} = (x_1, \ldots, x_n)\)</span> as the latent field, and <span class="math inline">\(\boldsymbol{\mathbf{\theta}} = (\theta_1, \ldots, \theta_m)\)</span> as the hyperparameters.
The generative model for data <span class="math inline">\(\mathbf{y}\)</span> is then
<span class="math display">\[\begin{align}
\mathbf{y} &amp;\sim p(\mathbf{y} \, | \, \mathbf{x}, \boldsymbol{\mathbf{\theta}}), \\
\mathbf{x} &amp;\sim p(\mathbf{x} \, | \, \boldsymbol{\mathbf{\theta}}), \\
\boldsymbol{\mathbf{\theta}} &amp;\sim p(\boldsymbol{\mathbf{\theta}}),
\end{align}\]</span>
with posterior distribution proportional to <span class="math inline">\(p(\mathbf{x}, \boldsymbol{\mathbf{\theta}} \, | \, \mathbf{y}) \propto p(\mathbf{y} \, | \, \mathbf{x}, \boldsymbol{\mathbf{\theta}}) p(\mathbf{x} \, | \, \boldsymbol{\mathbf{\theta}}) p(\boldsymbol{\mathbf{\theta}})\)</span>.</p>
<p>For example, Figure <a href="bayes-st.html#fig:hierarchical-structure">3.4</a> illustrates a case where each individual <span class="math inline">\(i = 1, \ldots, n\)</span> in a study is observed <span class="math inline">\(m_i\)</span> times.
Observations <span class="math inline">\(y_{i1}, \ldots y_{im_i}\)</span> of the same individual are grouped together, and are more likely to have more similar properties than observations of different individuals.
Hierarchical models often control over if and how information is shared between groups.</p>
<ol style="list-style-type: decimal">
<li><strong>Complete pooling</strong> In this model, the group structure is ignored and all <span class="math inline">\(\sum_{i = 1}^n m_i\)</span> observations are treated as independent and identically distributed
<span class="math display">\[\begin{align}
y_{ij} \sim \mathcal{N}(\mu, \sigma), \\
(\mu, \sigma) \sim p(\mu, \sigma).
\end{align}\]</span></li>
<li><strong>No pooling</strong> Alternatively, the groups can be modelled entirely separately with group specific mean <span class="math inline">\(\mu_i\)</span> and standard deviation <span class="math inline">\(\sigma_i\)</span> parameters
<span class="math display">\[\begin{align}
y_{ij} \sim \mathcal{N}(\mu_i, \sigma_i), \\
(\mu_i, \sigma_i) \sim p(\mu_i, \sigma_i).
\end{align}\]</span></li>
<li><strong>Partial pooling</strong> In this model, some amount of information is shared between the groups
<span class="math display">\[\begin{align}
y_{ij} &amp;\sim \mathcal{N}(\mu_i, \sigma), \\
\mu_i &amp;= \beta + u_i, \\
\beta &amp;\sim p(\beta), \\
\mathbf{u} &amp;\sim p(\mathbf{u}), \\
\sigma &amp;\sim p(\sigma),
\end{align}\]</span>
where the vector <span class="math inline">\(\mathbf{u} = (u_1, \ldots, u_n)\)</span>.</li>
</ol>
</div>
<div id="mixed-effects-models" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Mixed effects models<a href="bayes-st.html#mixed-effects-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fixed effects refer to those elements of the latent field which are constant across groups.
Random effects refer to those elements of the latent field which vary across groups.
These terms have notoriously many different, and incompatible, definitions which can cause confusion <span class="citation">(<a href="#ref-gelman2005analysis">Gelman 2005</a>)</span>.
I nonetheless find them useful to introduce here.</p>
<p>For concreteness, in the partial pooling model above, the latent field is <span class="math inline">\(\mathbf{x} = (\beta, u_1, \ldots, u_n)\)</span>.
The scalar <span class="math inline">\(\beta\)</span> is a fixed effect which applies to all <span class="math inline">\(n\)</span> groups.
The vector <span class="math inline">\(\mathbf{u}\)</span> are random effects which alter the mean differently for each group.
The only hyperparameter is the standard deviation <span class="math inline">\(\theta = \sigma\)</span>.</p>
<p>Random effects can also be structured to share information between some groups more than others.
In spatio-temporal statistics, structured spatial and temporal random effects are often used to impose smoothness.
Spatial random effects are the subject of Chapter <a href="beyond-borders.html#beyond-borders">4</a>.</p>
</div>
<div id="latent-gaussian-models" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Latent Gaussian models<a href="bayes-st.html#latent-gaussian-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Latent Gaussian models [LGMs; <span class="citation">Håvard Rue, Martino, and Chopin (<a href="#ref-rue2009approximate">2009</a>)</span>] are a class of three-stage Bayesian hierarchical models in which the middle layer is Gaussian.
To be more precise, in an LGM, the likelihood is given by
<span class="math display">\[\begin{align*}
y_i &amp;\sim p(y_i \, | \, \eta_i, \boldsymbol{\mathbf{\theta}}_1), \quad i = 1, \ldots, n, \\
\mu_i &amp;= \mathbb{E}(y_i \, | \, \eta_i) = g(\eta_i), \\
\eta_i &amp;= \beta_0 + \sum_{l = 1}^{p} \beta_j z_{ji} + \sum_{k = 1}^{r} f_k(u_{ki}).
\end{align*}\]</span>
The likelihood is given by a product <span class="math inline">\(p(\mathbf{y} \, | \, \boldsymbol{\mathbf{\eta}}, \boldsymbol{\mathbf{\theta}}_1) = \prod_{i = 1}^n p(y_i \, | \, \eta_i, \boldsymbol{\mathbf{\theta}}_1)\)</span>, where <span class="math inline">\(\boldsymbol{\mathbf{\eta}} = (\eta_1, \ldots, \eta_n)\)</span>.
Each response has conditional mean <span class="math inline">\(\mu_i\)</span> with inverse link function <span class="math inline">\(g: \mathbb{R} \to \mathbb{R}\)</span> such that <span class="math inline">\(\mu_i = g(\eta_i)\)</span>.
The vector <span class="math inline">\(\boldsymbol{\mathbf{\theta}}_1 \in \mathbb{R}^{s_1}\)</span>, with <span class="math inline">\(s_1\)</span> assumed small, are additional parameters of the likelihood.
The structured additive predictor <span class="math inline">\(\eta_i\)</span> may include an intercept <span class="math inline">\(\beta_0\)</span>, fixed effects <span class="math inline">\(\beta_j\)</span> of the covariates <span class="math inline">\(z_{ji}\)</span>, and random effects <span class="math inline">\(f_k(\cdot)\)</span> of the covariates <span class="math inline">\(u_{ki}\)</span>.
The parameters <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\{\beta_j\}\)</span>, <span class="math inline">\(\{f_k(\cdot)\}\)</span> are each assigned Gaussian prior distributions, and can be collected into a vector <span class="math inline">\(\mathbf{x} \in \mathbb{R}^N\)</span> such that <span class="math inline">\(\mathbf{x} \sim \mathcal{N}(\mathbf{0}, \mathbf{Q}(\boldsymbol{\mathbf{\theta}}_2)^{-1})\)</span> where <span class="math inline">\(\boldsymbol{\mathbf{\theta}}_2 \in \mathbb{R}^{s_2}\)</span> are further hyperparameters, again with <span class="math inline">\(s_2\)</span> assumed small.
Let <span class="math inline">\(\boldsymbol{\mathbf{\theta}} = (\boldsymbol{\mathbf{\theta}}_1, \boldsymbol{\mathbf{\theta}}_2) \in \mathbb{R}^m\)</span> with <span class="math inline">\(m = s_1 + s_2\)</span> be all hyperparameters, with prior distribution <span class="math inline">\(p(\boldsymbol{\mathbf{\theta}})\)</span>.</p>
</div>
<div id="extended-latent-gaussian-models" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Extended latent Gaussian models<a href="bayes-st.html#extended-latent-gaussian-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- Strictly speaking, many-to-one is not an issue for `R-INLA`, the latent field is implemented as a concatenation of many vectors already e.g. for $\eta_i = \beta_0 + \phi_i$ with $i = 1, \ldots, n$ the latent field is $(\eta_1, \ldots, \eta_n, \beta_0, \phi_1, \ldots, \phi_n)^\top$ of dimension $2n + 1$ -->
<!-- Finn Lindgren is working on a method for non-linear predictors, called the [iterative INLA method](https://github.com/inlabru-org/inlabru/blob/55896f10d563c14e34cab577b29b733aac051f86/vignettes/method.Rmd). More [slides](https://informatique-mia.inrae.fr/reseau-resste/sites/default/files/2020-09/slides-Lindgren_Avignon2018.pdf) here -->
<!-- Thesis work of [Follestad](https://cds.cern.ch/record/639625/files/sis-2003-305.pdf) that stayed as a preprint -->
<p>Extended latent Gaussian models [ELGMs; <span class="citation">Stringer, Brown, and Stafford (<a href="#ref-stringer2021fast">2021</a>)</span>] facilitate modelling of LGMs with greater non-linearities.
In particular, the structured additive predictor is redefined as <span class="math inline">\(\boldsymbol{\mathbf{\eta}} = (\eta_1, \ldots \eta_{N_n})\)</span>, where <span class="math inline">\(N_n \in \mathbb{N}\)</span> is a function of <span class="math inline">\(n\)</span>, and it is possible that <span class="math inline">\(N_n \neq n\)</span>.
Each mean response <span class="math inline">\(\mu_i\)</span> now depends on some subset <span class="math inline">\(\mathcal{J}_i \subseteq [N_n]\)</span> of indices of <span class="math inline">\(\boldsymbol{\mathbf{\eta}}\)</span>, with <span class="math inline">\(\cup_{i = 1}^n \mathcal{J}_i = [N_n]\)</span> and <span class="math inline">\(1 \leq |\mathcal{J}_i| \leq N_n\)</span>, where <span class="math inline">\([N_n] = \{1, \ldots, N_n\}\)</span>.
The inverse link function <span class="math inline">\(g(\cdot)\)</span> is redefined for each observation to be a possibly many-to-one mapping <span class="math inline">\(g_i: \mathbb{R}^{|\mathcal{J}_i|} \to \mathbb{R}\)</span>, such that <span class="math inline">\(\mu_i = g_i(\boldsymbol{\mathbf{\eta}}_{\mathcal{J}_i})\)</span>.
Put together, ELGMs are of the form
<span class="math display">\[\begin{align*}
y_i &amp;\sim p(y_i \, | \, \boldsymbol{\mathbf{\eta}}_{\mathcal{J}_i}, \boldsymbol{\mathbf{\theta}}_1), \quad i = 1, \ldots, n, \\
\mu_i &amp;= \mathbb{E}(y_i \, | \, \boldsymbol{\mathbf{\eta}}_{\mathcal{J}_i}) = g_i(\boldsymbol{\mathbf{\eta}}_{\mathcal{J}_i}), \\
\eta_j &amp;= \beta_0 + \sum_{l = 1}^{p} \beta_j z_{ji} + \sum_{k = 1}^{r} f_k(u_{ki}), \quad j = 1, \ldots, N_n,
\end{align*}\]</span>
with latent field and hyperparameter prior distributions as in the LGM case.</p>
<p>The ELGM class is well suited to small-area estimation of HIV indicators.
Indeed, this class of models is used throughout the thesis.
While it can be transformed to an LGM using the Poisson-multinomial transformation <span class="citation">(<a href="#ref-baker1994multinomial">Baker 1994</a>)</span> the multinomial logistic regression model used in Chapter <a href="multi-agyw.html#multi-agyw">5</a> is naturally written as an ELGM where each observation depends on the set of structured additive predictors corresponding to the set of multinomial observations.
In Chapter <a href="naomi-aghq.html#naomi-aghq">6</a>, the Naomi small-area estimation model used to produce estimates of HIV indicators is shown to have the features of an ELGM.</p>
</div>
</div>
<div id="survey" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Survey methods<a href="bayes-st.html#survey" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Large national household surveys provide the highest quality population-level information about HIV indicators in SSA.
Demographic and Health Surveys (DHS) are funded by the United States Agency for International Development (USAID) and run every three to five years in most countries.
Population-based HIV Impact Assessment (PHIA) surveys are funded by PEPFAR and run every two to three years in high HIV burden countries.</p>
<div id="survey-notation-and-key-terms" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Survey notation and key terms<a href="bayes-st.html#survey-notation-and-key-terms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a population of individuals <span class="math inline">\(i = 1, \ldots, N\)</span> with outcomes of interest <span class="math inline">\(y_i\)</span>.
A census is a type of survey where all individuals are sampled.
Supposing responses from all individuals were recorded, then any population means can be calculated directly.
For example, if <span class="math inline">\(G_i = G(y_i)\)</span> then the population mean of <span class="math inline">\(G\)</span> is
<span class="math display">\[\begin{equation}
\bar G = \frac{1}{N} \sum_{i = 1}^N G(y_i).
\end{equation}\]</span></p>
<p>In practice, it is usually too expensive to run a census.
Instead, only a subset of the individuals are sampled.
Furthermore, only a subset of those sampled have their outcome recorded, due to nonresponse or otherwise.
Let <span class="math inline">\(S_i\)</span> be an indicator for whether or not individual <span class="math inline">\(i\)</span> is sampled, and <span class="math inline">\(R_i\)</span> be an indicator for whether or not <span class="math inline">\(y_i\)</span> is recorded.
If <span class="math inline">\(S_i = 0\)</span> then <span class="math inline">\(R_i = 0\)</span>.
If <span class="math inline">\(S_i = 1\)</span> then individual <span class="math inline">\(i\)</span> may not respond such that <span class="math inline">\(R_i = 0\)</span>.
The population mean may be estimated directly based on the recorded subset of the population by
<span class="math display">\[\begin{equation}
\bar G_R = \frac{\sum_{i = 1}^N R_i G(y_i)}{\sum_{i = 1}^N R_i}, \label{eq:direct}
\end{equation}\]</span>
where <span class="math inline">\(m_R = \sum_{i = 1}^N R_i\)</span> is the recorded sample size.</p>
<p>A probability sample refers to the case when individuals are selected to be included in the survey at random.
In a non-probability sample, inclusion or exclusion from the survey is deterministic.
A simple random sample (SRS) is a probability sample where the sampling probability for each individual is equal, so that <span class="math inline">\(P(S_i = 1) = 1 / N\)</span>.
The survey design is called complex when the sampling probabilities for each individual vary, such that <span class="math inline">\(P(S_i = 1) = \pi_i\)</span> with <span class="math inline">\(\sum_{i = 1}^N \pi_i = 1\)</span> and <span class="math inline">\(\pi_i &gt; 0\)</span>.</p>
<p>Complex survey designs can offer both greater practicality and statistical efficiency than a SRS.
However, particular care is required in analysing data collected using complex survey designs.
Under a complex design, failing to take into account the unequal sampling probabilities will result in bias.
That said, even for a SRS, nonresponse can cause analogous bias.</p>
</div>
<div id="survey-design" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Survey design<a href="bayes-st.html#survey-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- Add figure here to demonstrate sampling of DHS data -->
<p>The DHS <span class="citation">(<a href="#ref-measure2012sampling">DHS 2012</a>)</span> employs a two-stage sampling procedure.
In the first stage, ennumeration areas (EAs) from a recently conducted census are typically used as the primary sampling unit (PSU).
The EAs are then stratified by region, as well as urban-rural.
After appropriate sample sizes are determined, EAs sampled with probability proportional to size (PPS) measured
In the second stage, the secondary sampling units (SSUs) are households.
All households in the selected EAs are listed, before being sampled systematically.
Finally, each selected household is visited, and all adults are interviewed.</p>
<p>The probability an individual is sampled is equal to the probability their household is sampled.
The first-stage sampling probability of the <span class="math inline">\(j\)</span>th cluster in stratum <span class="math inline">\(h\)</span> given by
<span class="math display">\[\begin{equation}
\pi_{1hj} = n_h \times \frac{N_{hj}}{\sum_j N_{hj}},
\end{equation}\]</span>
where <span class="math inline">\(N_{hj}\)</span> is the number of households and <span class="math inline">\(n_h\)</span> be the number of clusters selected in stratum <span class="math inline">\(h\)</span>.
The second-stage sampling probability each household within the <span class="math inline">\(i\)</span>th cluster in stratum <span class="math inline">\(h\)</span> is
<span class="math display">\[\begin{equation}
\pi_{1hj} = \frac{n_{hj}}{N_{hj}},
\end{equation}\]</span>
where <span class="math inline">\(n_{hj}\)</span> is the numer of households selected in cluster <span class="math inline">\(j\)</span> and stratum <span class="math inline">\(h\)</span>.
That is, each household in the cluster has equal selection probability.
The overall selection probability of each household in cluster <span class="math inline">\(j\)</span> of stratum <span class="math inline">\(h\)</span> is <span class="math inline">\(\pi_{hi} = \pi_{1hj} \times \pi_{2hj}\)</span>.</p>
</div>
<div id="survey-analysis" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Survey analysis<a href="bayes-st.html#survey-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose a complex survey is run with sampling probabilities <span class="math inline">\(\pi_i\)</span>.
The most popular method for taking into account that some individuals are more likely to be included in the survey than others is to overweight the responses of those unlikely to be included, and underweight the responses of those likely to be included.
This can be achieved using design weights <span class="math inline">\(\delta_i = 1 / \pi_i\)</span>, which can be thought of as the number of individuals in the population represented by the <span class="math inline">\(i\)</span>th sampled individual.
Let <span class="math inline">\(P(R_i = 1 \, | \, S_i = 1) = \upsilon_i\)</span> be the probability of response for sampled individual <span class="math inline">\(i\)</span>.
The problem of nonresponse can be treated in the same way using nonresponse weights <span class="math inline">\(\gamma_i = 1 / \upsilon_i\)</span>, which analogously can be thought of as the number of sampled individuals represented by the <span class="math inline">\(i\)</span>th recorded individual.
Multiplying the design and nonresponse weights gives survey weights <span class="math inline">\(\omega_i = \delta_i \times \gamma_i\)</span>.</p>
<p>A weighted estimate <span class="citation">(<a href="#ref-hajek1971discussion">Hájek 1971</a>)</span> of the population mean using the survey weights <span class="math inline">\(\omega_i\)</span> is given by
<span class="math display">\[\begin{equation}
\bar G_\omega = \frac{\sum_{i = 1}^N \omega_j R_i G(y_i)}{\sum_{i = 1}^N \omega_i R_i}. \label{eq:hajek}
\end{equation}\]</span>
Decomposing the additive error of this estimate provides useful intuition as to the potential benefits of survey weighting.
Following <span class="citation">Meng (<a href="#ref-meng2018statistical">2018</a>)</span> then under SRS
<span class="math display">\[\begin{align}
\bar G_\omega - \bar G &amp;= \frac{\mathbb{E}(\omega_i R_i G_i)}{\mathbb{E}(\omega_i R_i)} - \mathbb{E}(G_i) = \frac{\mathbb{C}(\omega_i R_i G_i)}{\mathbb{E}(\omega_i R_i)} \\
&amp;= \rho_{R_\omega, G} \times \sqrt{\frac{N - m_{R_\omega}}{m_{R_\omega}}} \times \sigma_G,
\end{align}\]</span>
where <span class="math inline">\(R_\omega = \omega R\)</span>.
The data defect correlation (DDC) <span class="math inline">\(\rho_{R_\omega, G}\)</span> measures the correlation between the weighted recording mechanism and given function of the outcome of interest.
To minimise the DDC then <span class="math inline">\(G \perp \!\!\! \perp R_\omega\)</span>.
The data scarcity <span class="math inline">\(\sigma_{R_\omega} = \sqrt{(N - m_{R_\omega})/m_{R_\omega}}\)</span> measures the effective proportion of the population who have been recorded.
The problem difficultly <span class="math inline">\(\sigma_G\)</span> measures the intrinsic difficulty of the estimation problem, and is independent of the sampling or analysis method.</p>
<p>For simplicity, let <span class="math inline">\(G(y_i) = y_i\)</span> and each <span class="math inline">\(y_i \in \{0, 1\}\)</span>.
We weight then model following <span class="citation">Chen, Wakefield, and Lumely (<a href="#ref-chen2014use">2014</a>)</span>.
While this approach acknowledges the survey design, it has some important limitations.
We ignore clustering structure.
All of this isn’t great and that someone should figure this out <span class="citation">(<a href="#ref-gelman2007struggles">Gelman 2007</a>)</span>.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-baker1994multinomial" class="csl-entry">
Baker, Stuart G. 1994. <span>“<span class="nocase">The multinomial-Poisson transformation</span>.”</span> <em>Journal of the Royal Statistical Society: Series D (The Statistician)</em> 43 (4): 495–504.
</div>
<div id="ref-carpenter2017stan" class="csl-entry">
Carpenter, Bob, Andrew Gelman, Matthew D Hoffman, Daniel Lee, Ben Goodrich, Michael Betancourt, Marcus Brubaker, Jiqiang Guo, Peter Li, and Allen Riddell. 2017. <span>“<span class="nocase">Stan: A probabilistic programming language</span>.”</span> <em>Journal of Statistical Software</em> 76 (1).
</div>
<div id="ref-chen2014use" class="csl-entry">
Chen, Cici, Jon Wakefield, and Thomas Lumely. 2014. <span>“The Use of Sampling Weights in Bayesian Hierarchical Models for Small Area Estimation.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 11: 33–43.
</div>
<div id="ref-cressie2015statistics" class="csl-entry">
Cressie, Noel, and Christopher K Wikle. 2015. <em>Statistics for Spatio-Temporal Data</em>. John Wiley &amp; Sons.
</div>
<div id="ref-measure2012sampling" class="csl-entry">
DHS. 2012. <span>“<span class="nocase">Sampling and Household Listing Manual: Demographic and Health Surveys Methodology</span>.”</span>
</div>
<div id="ref-duane1987hybrid" class="csl-entry">
Duane, Simon, Anthony D Kennedy, Brian J Pendleton, and Duncan Roweth. 1987. <span>“<span>Hybrid Monte Carlo</span>.”</span> <em>Physics Letters B</em> 195 (2): 216–22.
</div>
<div id="ref-fisher1936design" class="csl-entry">
Fisher, Ronald Aylmer. 1936. <span>“Design of Experiments.”</span> <em>British Medical Journal</em> 1 (3923): 554.
</div>
<div id="ref-gelman2005analysis" class="csl-entry">
Gelman, Andrew. 2005. <span>“Analysis of Variance—Why It Is More Important Than Ever.”</span>
</div>
<div id="ref-gelman2007struggles" class="csl-entry">
———. 2007. <span>“Struggles with Survey Weighting and Regression Modeling.”</span>
</div>
<div id="ref-gelman2013bayesian" class="csl-entry">
Gelman, Andrew, John B Carlin, Hal S Stern, David B Dunson, Aki Vehtari, and Donald B Rubin. 2013. <em>Bayesian Data Analysis</em>. CRC press.
</div>
<div id="ref-gelman2017prior" class="csl-entry">
Gelman, Andrew, Daniel Simpson, and Michael Betancourt. 2017. <span>“The Prior Can Often Only Be Understood in the Context of the Likelihood.”</span> <em>Entropy</em> 19 (10): 555.
</div>
<div id="ref-hajek1971discussion" class="csl-entry">
Hájek, Jaroslav. 1971. <span>“Discussion of <span>‘an Essay on the Logical Foundations of Survey Sampling, Part i’</span>.”</span> <em>Foundations of Statistical Inference (Proc. Sympos., Univ. Waterloo, Ontario, 1970)</em>, 236.
</div>
<div id="ref-hoffman2014no" class="csl-entry">
Hoffman, Matthew D, Andrew Gelman, et al. 2014. <span>“The No-u-Turn Sampler: Adaptively Setting Path Lengths in Hamiltonian Monte Carlo.”</span> <em>J. Mach. Learn. Res.</em> 15 (1): 1593–623.
</div>
<div id="ref-mcelreath2020statistical" class="csl-entry">
McElreath, Richard. 2020. <em>Statistical Rethinking: A Bayesian Course with Examples in r and Stan</em>. CRC press.
</div>
<div id="ref-meng2018statistical" class="csl-entry">
Meng, Xiao-Li. 2018. <span>“Statistical Paradises and Paradoxes in Big Data (i) Law of Large Populations, Big Data Paradox, and the 2016 Us Presidential Election.”</span> <em>The Annals of Applied Statistics</em> 12 (2): 685–726.
</div>
<div id="ref-neal2011mcmc" class="csl-entry">
Neal, Radford M et al. 2011. <span>“<span class="nocase">MCMC using Hamiltonian dynamics</span>.”</span> <em>Handbook of Markov Chain Monte Carlo</em> 2 (11): 2.
</div>
<div id="ref-robert2005monte" class="csl-entry">
Robert, Christian P, and George Casella. 2005. <span>“Monte Carlo Statistical Methods (Springer Texts in Statistics).”</span> Springer.
</div>
<div id="ref-rue2009approximate" class="csl-entry">
Rue, Håvard, Sara Martino, and Nicolas Chopin. 2009. <span>“<span class="nocase">Approximate Bayesian inference for latent Gaussian models by using integrated nested Laplace approximations</span>.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 71 (2): 319–92.
</div>
<div id="ref-stringer2021fast" class="csl-entry">
Stringer, Alex, Patrick Brown, and Jamie Stafford. 2021. <span>“Fast, Scalable Approximations to Posterior Distributions in Extended Latent Gaussian Models.”</span> <em>arXiv Preprint arXiv:2103.07425</em>.
</div>
<div id="ref-tobler1970computer" class="csl-entry">
Tobler, Waldo R. 1970. <span>“A Computer Movie Simulating Urban Growth in the Detroit Region.”</span> <em>Economic Geography</em> 46 (sup1): 234–40.
</div>
<div id="ref-yao2018yes" class="csl-entry">
Yao, Yuling, Aki Vehtari, Daniel Simpson, and Andrew Gelman. 2018. <span>“Yes, but Did It Work?: Evaluating Variational Inference.”</span> In <em>International Conference on Machine Learning</em>, 5581–90. PMLR.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hiv-aids.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="beyond-borders.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ulyngs/oxforddown/tree/master/03-bayesian.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
